<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>机器学习笔记中文翻译</title>
</head>
<body>
<div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_SVG_Hidden"></div><svg><defs id="MathJax_SVG_glyphs"><path id="MJMATHI-79" stroke-width="1" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJMAIN-3D" stroke-width="1" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJMATHI-68" stroke-width="1" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJMATHI-3B8" stroke-width="1" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"></path><path id="MJMAIN-28" stroke-width="1" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJMATHI-78" stroke-width="1" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJMAIN-29" stroke-width="1" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJMAIN-30" stroke-width="1" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJMAIN-2B" stroke-width="1" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJMAIN-31" stroke-width="1" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJMATHI-4A" stroke-width="1" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z"></path><path id="MJMAIN-2C" stroke-width="1" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJMAIN-32" stroke-width="1" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJMATHI-6D" stroke-width="1" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJSZ2-2211" stroke-width="1" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path id="MJMATHI-69" stroke-width="1" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJMAIN-2212" stroke-width="1" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJMATHI-3B1" stroke-width="1" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z"></path><path id="MJMATHI-6A" stroke-width="1" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path id="MJMAIN-3A" stroke-width="1" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJMAIN-5B" stroke-width="1" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJMAIN-5D" stroke-width="1" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path><path id="MJMATHI-41" stroke-width="1" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJMATHI-76" stroke-width="1" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path><path id="MJMATHI-52" stroke-width="1" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path id="MJMATHI-6E" stroke-width="1" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJMATHI-54" stroke-width="1" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path><path id="MJMATHI-58" stroke-width="1" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path><path id="MJMATHI-66" stroke-width="1" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJMATHI-6F" stroke-width="1" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJMATHI-72" stroke-width="1" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJMAIN-2E" stroke-width="1" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJMAIN-2207" stroke-width="1" d="M46 676Q46 679 51 683H781Q786 679 786 676Q786 674 617 326T444 -26Q439 -33 416 -33T388 -26Q385 -22 216 326T46 676ZM697 596Q697 597 445 597T193 596Q195 591 319 336T445 80L697 596Z"></path><path id="MJMAIN-2264" stroke-width="1" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path><path id="MJMATHI-67" stroke-width="1" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path><path id="MJMATHI-65" stroke-width="1" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJMATHI-7A" stroke-width="1" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z"></path><path id="MJMATHI-6C" stroke-width="1" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path id="MJMATHI-74" stroke-width="1" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJMAIN-2032" stroke-width="1" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path><path id="MJMAIN-2202" stroke-width="1" d="M202 508Q179 508 169 520T158 547Q158 557 164 577T185 624T230 675T301 710L333 715H345Q378 715 384 714Q447 703 489 661T549 568T566 457Q566 362 519 240T402 53Q321 -22 223 -22Q123 -22 73 56Q42 102 42 148V159Q42 276 129 370T322 465Q383 465 414 434T455 367L458 378Q478 461 478 515Q478 603 437 639T344 676Q266 676 223 612Q264 606 264 572Q264 547 246 528T202 508ZM430 306Q430 372 401 400T333 428Q270 428 222 382Q197 354 183 323T150 221Q132 149 132 116Q132 21 232 21Q244 21 250 22Q327 35 374 112Q389 137 409 196T430 306Z"></path><path id="MJMATHI-50" stroke-width="1" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path id="MJMATHI-6B" stroke-width="1" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJMAIN-7C" stroke-width="1" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path id="MJMAIN-3B" stroke-width="1" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 85 94 103T137 121Q202 121 202 8Q202 -44 183 -94T144 -169T118 -194Q115 -194 106 -186T95 -174Q94 -171 107 -155T137 -107T160 -38Q161 -32 162 -22T165 -4T165 4Q165 5 161 4T142 0Q110 0 94 18T78 60Z"></path><path id="MJMATHI-3BB" stroke-width="1" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path><path id="MJMATHI-4C" stroke-width="1" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJMAIN-22F1" stroke-width="1" d="M133 760Q133 784 150 802T193 820Q217 820 235 804T254 761Q254 736 237 718T194 700T151 717T133 760ZM580 460Q580 484 597 502T640 520Q664 520 682 504T701 461Q701 436 684 418T641 400T598 417T580 460ZM1027 160Q1027 184 1044 202T1087 220Q1111 220 1129 204T1148 161Q1148 136 1131 118T1088 100T1045 117T1027 160Z"></path><path id="MJSZ4-23A1" stroke-width="1" d="M319 -645V1154H666V1070H403V-645H319Z"></path><path id="MJSZ4-23A3" stroke-width="1" d="M319 -644V1155H403V-560H666V-644H319Z"></path><path id="MJSZ4-23A2" stroke-width="1" d="M319 0V602H403V0H319Z"></path><path id="MJSZ4-23A4" stroke-width="1" d="M0 1070V1154H347V-645H263V1070H0Z"></path><path id="MJSZ4-23A6" stroke-width="1" d="M263 -560V1155H347V-644H0V-560H263Z"></path><path id="MJSZ4-23A5" stroke-width="1" d="M263 0V602H347V0H263Z"></path><path id="MJMAIN-D7" stroke-width="1" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJMATHI-61" stroke-width="1" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJMATHI-63" stroke-width="1" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJMATHI-64" stroke-width="1" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJMATHI-73" stroke-width="1" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJMATHI-4B" stroke-width="1" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJMAIN-394" stroke-width="1" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path><path id="MJMATHI-3B4" stroke-width="1" d="M195 609Q195 656 227 686T302 717Q319 716 351 709T407 697T433 690Q451 682 451 662Q451 644 438 628T403 612Q382 612 348 641T288 671T249 657T235 628Q235 584 334 463Q401 379 401 292Q401 169 340 80T205 -10H198Q127 -10 83 36T36 153Q36 286 151 382Q191 413 252 434Q252 435 245 449T230 481T214 521T201 566T195 609ZM112 130Q112 83 136 55T204 27Q233 27 256 51T291 111T309 178T316 232Q316 267 309 298T295 344T269 400L259 396Q215 381 183 342T137 256T118 179T112 130Z"></path><path id="MJMAIN-2217" stroke-width="1" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path><path id="MJMATHI-44" stroke-width="1" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJMAIN-2248" stroke-width="1" d="M55 319Q55 360 72 393T114 444T163 472T205 482Q207 482 213 482T223 483Q262 483 296 468T393 413L443 381Q502 346 553 346Q609 346 649 375T694 454Q694 465 698 474T708 483Q722 483 722 452Q722 386 675 338T555 289Q514 289 468 310T388 357T308 404T224 426Q164 426 125 393T83 318Q81 289 69 289Q55 289 55 319ZM55 85Q55 126 72 159T114 210T163 238T205 248Q207 248 213 248T223 249Q262 249 296 234T393 179L443 147Q502 112 553 112Q609 112 649 141T694 220Q694 249 708 249T722 217Q722 153 675 104T555 55Q514 55 468 76T388 123T308 170T224 192Q164 192 125 159T83 84Q80 55 69 55Q55 55 55 85Z"></path><path id="MJMATHI-3F5" stroke-width="1" d="M227 -11Q149 -11 95 41T40 174Q40 262 87 322Q121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411Q382 385 341 385H325H312Q191 385 154 277L150 265H327Q340 256 340 246Q340 228 320 219H138V217Q128 187 128 143Q128 77 160 52T231 26Q258 26 284 36T326 57T343 68Q350 68 354 58T358 39Q358 36 357 35Q354 31 337 21T289 0T227 -11Z"></path><path id="MJMAIN-36" stroke-width="1" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path id="MJMAIN-221A" stroke-width="1" d="M95 178Q89 178 81 186T72 200T103 230T169 280T207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397 -77Q398 -77 501 136T707 565T814 786Q820 800 834 800Q841 800 846 794T853 782V776L620 293L385 -193Q381 -200 366 -200Q357 -200 354 -197Q352 -195 256 15L160 225L144 214Q129 202 113 190T95 178Z"></path><path id="MJSZ1-221A" stroke-width="1" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z"></path><path id="MJMATHI-75" stroke-width="1" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJMATHI-70" stroke-width="1" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJMATHI-46" stroke-width="1" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path><path id="MJMATHI-43" stroke-width="1" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path id="MJMAIN-7B" stroke-width="1" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path id="MJMAIN-7D" stroke-width="1" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path><path id="MJMAIN-2265" stroke-width="1" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path><path id="MJMAIN-33" stroke-width="1" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path id="MJMATHI-3C3" stroke-width="1" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path><path id="MJMAIN-3E" stroke-width="1" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path><path id="MJMAIN-22EE" stroke-width="1" d="M78 30Q78 54 95 72T138 90Q162 90 180 74T199 31Q199 6 182 -12T139 -30T96 -13T78 30ZM78 440Q78 464 95 482T138 500Q162 500 180 484T199 441Q199 416 182 398T139 380T96 397T78 440ZM78 840Q78 864 95 882T138 900Q162 900 180 884T199 841Q199 816 182 798T139 780T96 797T78 840Z"></path><path id="MJMAIN-2208" stroke-width="1" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path id="MJMATHI-3BC" stroke-width="1" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z"></path><path id="MJMATHI-55" stroke-width="1" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path><path id="MJSZ1-2211" stroke-width="1" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path><path id="MJMATHI-53" stroke-width="1" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path id="MJMAIN-39" stroke-width="1" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z"></path><path id="MJMATHI-4E" stroke-width="1" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJMATHI-3C0" stroke-width="1" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path><path id="MJSZ2-220F" stroke-width="1" d="M220 812Q220 813 218 819T214 829T208 840T199 853T185 866T166 878T140 887T107 893T66 896H56V950H1221V896H1211Q1080 896 1058 812V-311Q1076 -396 1211 -396H1221V-450H725V-396H735Q864 -396 888 -314Q889 -312 889 -311V896H388V292L389 -311Q405 -396 542 -396H552V-450H56V-396H66Q195 -396 219 -314Q220 -312 220 -311V812Z"></path><path id="MJMAIN-2026" stroke-width="1" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path><path id="MJMATHI-59" stroke-width="1" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path><path id="MJMATHI-62" stroke-width="1" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs></svg></div><div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="ffyy" id="机器学习笔记中文翻译">机器学习笔记中文翻译</h1><p data-anchor-id="hc6t"><code>machine_learning</code></p><hr><p data-anchor-id="hgge">课程地址 <br>
<a href="https://www.coursera.org/learn/machine-learning" target="_blank">https://www.coursera.org/learn/machine-learning</a></p><div class="md-section-divider"></div><h2 data-anchor-id="do0b" id="第一周">第一周</h2><div class="md-section-divider"></div><h3 data-anchor-id="iyyi" id="何为机器学习">何为机器学习</h3><p data-anchor-id="6apq">两种定义：  <br>
“关于赋予计算机一种不需要显式编码的学习能力的研究领域”——来自Arthur Samuel的旧定义 <br>
“一个计算机程序可以从一些类别任务T和表现衡量P相关的经验E中进行学习，如果它在任务中的表现T，由P来衡量，随着经验E而完善。”——来自Tom Mitchell的更现代的定义 <br>
例子：玩西洋棋 <br>
E = 玩很多西洋棋的经验 <br>
T = 玩西洋棋的任务 <br>
P = 程序赢得下一盘游戏的概率</p><p data-anchor-id="6ihe">通常来说，任何机器学习问题都可以分为两大类：监督学习和无监督学习</p><div class="md-section-divider"></div><h4 data-anchor-id="mfla" id="监督学习">监督学习</h4><p data-anchor-id="hwxg">在监督学习中我们拥有一个数据集并已经知道正确的输出是怎样的，知道输入和输出之间有关系。 <br>
监督学习可以分为“回归”和“分类”问题。在回归问题中，我们尝试在连续输出中预测结果，意味着我们把输入变量映射到一些连续函数。在分类问题中，我们尝试以离散输出形式预测结果，把输入变量映射到离散类别中。</p><div class="md-section-divider"></div><h4 data-anchor-id="fakx" id="无监督学习">无监督学习</h4><p data-anchor-id="iyds">无监督学习允许我们解决不知道或者很少知道结果是怎样的问题。我们可以从数据中获得结构，在这些数据中我们不必知道变量的效果。 <br>
我们可以根据数据中变量的关系对数据进行聚集，来获得这个结构。 <br>
无监督学习没有根据预测结果的反馈，即没有老师来更正你。 <br>
分为聚类问题和非聚类问题（鸡尾酒派对问题）</p><div class="md-section-divider"></div><h3 data-anchor-id="7u8p" id="单变量线性回归">单变量线性回归</h3><div class="md-section-divider"></div><h4 data-anchor-id="g2zy" id="模型表现">模型表现</h4><p data-anchor-id="joe2">在回归问题中，我们用输入变量把输出值拟合到一个连续函数上。 <br>
单变量线性回归也叫“通用线性回归”。 <br>
当你想从一个单输入变量X预测一个单输出变量y的时候，通用线性回归就得到使用。 <br>
我们这时在做监督学习，所以这意味着我们已经知道输入输出的原因和效果应该是怎样。</p><div class="md-section-divider"></div><h4 data-anchor-id="pohf" id="假设函数">假设函数</h4><p data-anchor-id="8xxs">我们的假设函数有以下一般形式：<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 9167.856077290373 1042.103370696049" style="width: 21.313ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-79"></use><use xlink:href="#MJMAIN-3D" x="775" y="0"></use><g transform="translate(1831,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="2840" y="0"></use><use xlink:href="#MJMATHI-78" x="3229" y="0"></use><use xlink:href="#MJMAIN-29" x="3802" y="0"></use><use xlink:href="#MJMAIN-3D" x="4469" y="0"></use><g transform="translate(5525,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2B" x="6671" y="0"></use><g transform="translate(7671,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="#MJMATHI-78" x="8595" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">y = h_{\theta}(x) = \theta_0 + \theta_1 x</script> <br>
注意到这跟直线方程很相似。我们给<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 2359.986633767084 1042.103370696049" style="width: 5.444ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use><use xlink:href="#MJMAIN-28" x="1008" y="0"></use><use xlink:href="#MJMATHI-78" x="1397" y="0"></use><use xlink:href="#MJMAIN-29" x="1970" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2">h_\theta(x)</script>以<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 912.3668266633396" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3">\theta_0</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 896.8104774772355" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4">\theta_1</script>值来得到我们的估计 输出<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.0516853480245 497.5 690.103370696049" style="width: 1.158ex; height: 1.622ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-79"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5">y</script>。换句话说，我们尝试创造一个叫<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 1008.4866337670841 897.6557328068036" style="width: 2.317ex; height: 2.085ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6">h_\theta</script>的函数来把输入数据（X）映射到输出数据（y）。</p><div class="md-section-divider"></div><h4 data-anchor-id="fc0j" id="损失函数">损失函数</h4><p data-anchor-id="mjkd">我们可以用一个损失函数来衡量假设函数的精准性。 <br>
这采用所有从X的输入得到的假设结果与实际的输出y之间比较的平均值（实际上是一种更新奇的平均数版本）。 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 14383.651584851925 2802.850285968542" style="width: 33.359ex; height: 6.486ex; vertical-align: -2.896ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><g transform="translate(1023,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2C" x="1946" y="0"></use><g transform="translate(2391,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="3314" y="0"></use><use xlink:href="#MJMAIN-3D" x="3982" y="0"></use><g transform="translate(5158,0)"><rect stroke="none" width="1499" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="499" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g><g transform="translate(6944,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="8388" y="0"></use><g transform="translate(8778,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="9786" y="0"></use><g transform="translate(10176,0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="11092" y="0"></use><use xlink:href="#MJMAIN-2212" x="11704" y="0"></use><g transform="translate(12705,0)"><use xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><g transform="translate(13540,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-7">J(\theta_0,\theta_1)=\frac{1}{2m}\sum_{i=1}^m(h_\theta(x_i)-y_i)^2</script> <br>
分开来讲，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -895.9073646014878 1453.0736106505337 1291.8147292029755" style="width: 3.359ex; height: 3.012ex; vertical-align: -1.042ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="473" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="84" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="84" y="-531"></use></g><use xlink:href="#MJMATHI-78" x="880" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8">\frac{1}{2}x</script>，当<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 572.5 495.10337069604896" style="width: 1.274ex; height: 1.158ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9">x</script>是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 4424.736471111481 1042.103370696049" style="width: 10.309ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use><use xlink:href="#MJMAIN-28" x="1008" y="0"></use><g transform="translate(1397,0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="2314" y="0"></use><use xlink:href="#MJMAIN-2212" x="2926" y="0"></use><use xlink:href="#MJMATHI-79" x="3927" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10">h_\theta(x_i)-y</script>的平方的均值，或者说预测值与实际值的差异。 <br>
这个函数也叫做“平方误差函数”(square error function)，或者“均值平方误差”(mean squared error)。该均值被对半分（<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -895.9073646014878 1335.100251256249 1299.5929037960275" style="width: 3.127ex; height: 3.012ex; vertical-align: -1.042ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="1095" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="524" y="571"></use><g transform="translate(60,-376)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-11">\frac{1}{2m}</script>），为了方便计算梯度下降，因为平方函数的导数项会把<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -895.9073646014878 713.906943983867 1291.8147292029755" style="width: 1.622ex; height: 3.012ex; vertical-align: -1.042ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="473" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="84" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="84" y="-531"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-12">\frac{1}{2}</script>消掉。 <br>
现在我们能够精确地衡量预测函数关于我们拥有的正确值的精确度，于是我们可以预测我们没有的新结果。</p><p data-anchor-id="6f2q">如果我们尝试从视觉角度来看，我们的训练数据集分散在x-y平面上。我们正尝试画一条直线（由<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 2359.986633767084 1042.103370696049" style="width: 5.444ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use><use xlink:href="#MJMAIN-28" x="1008" y="0"></use><use xlink:href="#MJMATHI-78" x="1397" y="0"></use><use xlink:href="#MJMAIN-29" x="1970" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13">h_\theta(x)</script>定义），它穿过这个分散的数据集。我们的目标是得到最合适的直线。最合适的直线将会使得分散的点到直线的垂直距离的平方的的均值最小。在最好的情况下，这条线会穿过所有训练集中的点。在这中情况下<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 3704.4805546344005 1042.103370696049" style="width: 8.571ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><g transform="translate(1023,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2C" x="1946" y="0"></use><g transform="translate(2391,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="3314" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14">J(\theta_0,\theta_1)</script>的值是0。</p><div class="md-section-divider"></div><h3 data-anchor-id="0lqf" id="梯度下降">梯度下降</h3><p data-anchor-id="x4j5">现在我们有了假设函数和衡量它能多好地拟合数据的方法。现在我们需要估计假设函数中的参数。 <br>
这就是梯度下降的用武之处。 <br>
假想我们根据<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -867.8607200970592 5711.034434331357 1087.3968842095626" style="width: 13.32ex; height: 2.548ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">假</text><g transform="translate(797,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">设</text></g><g transform="translate(1595,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">函</text></g><g transform="translate(2393,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g><g transform="translate(3191,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(3989,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">域</text></g><g transform="translate(4787,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-15">假设函数的域\theta_0</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 896.8104774772355" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16">\theta_1</script>画出来假设函数（实际上我们画出损失函数作为参数估计的函数）。这有点令人疑惑；我们开始更高层的抽象。我们不是在画x和y自身，而是假设函数的参数范围和选择特定参数集带来的损失。</p><p data-anchor-id="wr62">我们把<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 912.3668266633396" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17">\theta_0</script>放在x轴上，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 896.8104774772355" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18">\theta_1</script>放在y轴上，损失函数放在垂直的z轴上。图像上的点将会是随着那些特定的theta参数使用我们的假设得到的损失函数的结果。</p><p data-anchor-id="42wr">我们都知道当我们的损失函数在图像的凹点的底部时我们就成功了，即当它的值最小时。</p><p data-anchor-id="g0mf">做到这个的方法是通过计算损失函数的导数（函数的切线）。切线的斜率就是那个点的导数，并给予我们移动的方向。我们沿着梯度最陡峭的方向一步步走下损失函数，每步 的大小由一个参数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 640.5 495.10337069604896" style="width: 1.506ex; height: 1.158ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B1"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19">\alpha</script>决定，叫做学习率。</p><p data-anchor-id="5u7a">梯度下降算法是： <br>
重复直到收敛： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-20-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1139.5596853480245 11097.85852968609 2140.5192608392913" style="width: 25.83ex; height: 4.981ex; vertical-align: -2.432ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use><g transform="translate(1138,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(2473,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="3557" y="0"></use><use xlink:href="#MJMATHI-3B1" x="4557" y="0"></use><g transform="translate(5485,0)"><rect stroke="none" width="1621" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3B1" x="490" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMATHI-3B1"></use><g transform="translate(640,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g></g></g><use xlink:href="#MJMATHI-4A" x="7393" y="0"></use><use xlink:href="#MJMAIN-28" x="8026" y="0"></use><g transform="translate(8416,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2C" x="9339" y="0"></use><g transform="translate(9784,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="10708" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">\theta_j:=\theta_j-\alpha\frac{\alpha}{\alpha\theta_j}J(\theta_0,\theta_1)</script> <br>
这里 <br>
j=0,1表示特征索引数字 <br>
直观地，这可以认为是 <br>
重复直到收敛： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-21-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -867.8607200970592 15049.742245058054 1182.869295588326" style="width: 34.981ex; height: 2.78ex; vertical-align: -0.811ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use><g transform="translate(1138,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(2473,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="3557" y="0"></use><use xlink:href="#MJMATHI-3B1" x="4557" y="0"></use><use xlink:href="#MJMAIN-5B" x="5198" y="0"></use><use xlink:href="#MJMATHI-6A" x="5476" y="0"></use><g transform="translate(5889,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">维</text></g><g transform="translate(6687,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">度</text></g><g transform="translate(7485,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(8283,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">导</text></g><g transform="translate(9081,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g><use xlink:href="#MJMAIN-5D" x="9879" y="0"></use><use xlink:href="#MJMAIN-5B" x="10157" y="0"></use><use xlink:href="#MJMATHI-69" x="10436" y="0"></use><g transform="translate(10781,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">维</text></g><g transform="translate(11579,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">度</text></g><g transform="translate(12377,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(13175,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">导</text></g><g transform="translate(13973,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g><use xlink:href="#MJMAIN-5D" x="14771" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">\theta_j:=\theta_j-\alpha[j维度的导数][i维度的导数]</script></p><div class="md-section-divider"></div><h4 data-anchor-id="bfu3" id="线性回归中的梯度下降">线性回归中的梯度下降</h4><p data-anchor-id="liwp">当应用到线性回归的情况时，一种新的梯度下降等式就衍生出来了。我们代替实际的损失函数和实际的假设函数，并把等式修改为 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -867.8607200970592 30371.51189189189 7904.552714754548" style="width: 70.541ex; height: 18.301ex; vertical-align: -16.448ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(12513,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">重</text><g transform="translate(797,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">复</text></g><g transform="translate(1595,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">直</text></g><g transform="translate(2393,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">到</text></g><g transform="translate(3191,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">收</text></g><g transform="translate(3989,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">敛</text></g><use xlink:href="#MJMAIN-3A" x="5065" y="0"></use></g><g transform="translate(8245,-2195)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use><g transform="translate(1201,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(2535,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="3681" y="0"></use><use xlink:href="#MJMATHI-3B1" x="4682" y="0"></use><g transform="translate(5609,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g><g transform="translate(6894,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="8339" y="0"></use><g transform="translate(8728,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="9737" y="0"></use><g transform="translate(10126,0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="11043" y="0"></use><use xlink:href="#MJMAIN-2212" x="11655" y="0"></use><g transform="translate(12655,0)"><use xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="13490" y="0"></use></g><g transform="translate(7397,-5389)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use><g transform="translate(1201,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(2535,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="3681" y="0"></use><use xlink:href="#MJMATHI-3B1" x="4682" y="0"></use><g transform="translate(5609,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g><g transform="translate(6894,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="8339" y="0"></use><use xlink:href="#MJMAIN-28" x="8728" y="0"></use><g transform="translate(9118,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="10126" y="0"></use><g transform="translate(10516,0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="11432" y="0"></use><use xlink:href="#MJMAIN-2212" x="12044" y="0"></use><g transform="translate(13045,0)"><use xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="13880" y="0"></use><g transform="translate(14269,0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="15186" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-22">重复直到收敛:{\\
\theta_0:=\theta_0-\alpha\frac{1}{m}\sum_{i=1}^m(h_\theta(x_i)-y_i)\\
\theta_1:=\theta_1-\alpha\frac{1}{m}\sum_{i=1}^m((h_\theta(x_i)-y_i)x_i)\\
}</script></p><p data-anchor-id="5l8t">这里m是训练集的大小，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 912.3668266633396" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23">\theta_0</script>是随着<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 896.8104774772355" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24">\theta_1</script>同步改变的常量，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.0516853480245 2196.777452466571 690.103370696049" style="width: 5.097ex; height: 1.622ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="809" y="-213"></use><use xlink:href="#MJMAIN-2C" x="916" y="0"></use><g transform="translate(1361,0)"><use xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-25">x_i,y_i</script>是给定训练集的值。 <br>
注意到我们把两个关于<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 861.1815472394509 1041.0602608392912" style="width: 1.969ex; height: 2.432ex; vertical-align: -0.811ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-26">\theta_j</script>的情况分开成单独的关于<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 912.3668266633396" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-27">\theta_0</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 896.8104774772355" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-28">\theta_1</script>的等式；针对<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 896.8104774772355" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-29">\theta_1</script>由于导数我们在末尾乘了个<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 916.8053928999522 641.5886520702876" style="width: 2.085ex; height: 1.506ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-30">x_i</script>。</p><p data-anchor-id="9cbm">这里的要点是如果我们用一个假设而且随后不断重复应用这些梯度下降算法，我们的假设会变得越来越精确。</p><div class="md-section-divider"></div><h3 data-anchor-id="ux2m" id="线性代数要点">线性代数要点</h3><div class="md-section-divider"></div><h4 data-anchor-id="hroi" id="记号和术语">记号和术语</h4><ul data-anchor-id="hpj3">
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -737.0516853480245 1386.486940139403 1052.0602608392912" style="width: 3.243ex; height: 2.432ex; vertical-align: -0.811ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41"></use><g transform="translate(750,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="345" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-31">A_{ij}</script>指的是矩阵A的i行j列的元素</li>
<li>一个有n行的向量称为n维向量</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.0516853480245 829.8053928999522 642.5886520702876" style="width: 1.969ex; height: 1.506ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-76"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="686" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-32">v_i</script>指的是向量第i行的元素</li>
<li>一般地，我们所有的矩阵和向量都是从1开始编号的。注意到有些编程语言的数组是从0开始编号的。</li>
<li>矩阵用大写字母表示，向量用小写字母表示</li>
<li>标量(scale)意味着一个对象是一个单独的值，不是向量或矩阵</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.0516853480245 759.5 746.103370696049" style="width: 1.737ex; height: 1.737ex; vertical-align: -0.232ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-52"></use></g></svg></span><script type="math/tex" id="MathJax-Element-33">R</script>指实数集</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.0516853480245 1284.1176221025219 746.103370696049" style="width: 3.012ex; height: 1.737ex; vertical-align: -0.232ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-52"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="1074" y="513"></use></g></svg></span><script type="math/tex" id="MathJax-Element-34">R^n</script>指n维实数向量的集合（编者按：准确来讲是向量空间）</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="vhgw" id="加法和标量乘法">加法和标量乘法</h4><p data-anchor-id="d1yg">加法和标量乘法都是针对元素的,所以你可以简单地加或减每个对应元素。 <br>
加或减的两个矩阵的维度一定相等。 <br>
在标量乘法中，我们简单地把每个元素乘以标量值。</p><div class="md-section-divider"></div><h4 data-anchor-id="udjb" id="矩阵-向量-乘法">矩阵-向量 乘法</h4><p data-anchor-id="s4g6">我们把向量的每一列映射到矩阵的每一行上，乘以每一个元素并把结果求和。 <br>
一个m*n矩阵乘一个n*1向量的结果是m*1向量。</p><div class="md-section-divider"></div><h4 data-anchor-id="a8gi" id="矩阵-矩阵-乘法">矩阵-矩阵 乘法</h4><p data-anchor-id="waji">两个矩阵相乘是通过把它分成几个向量乘法并把结果连在一起。 <br>
一个m*n矩阵乘一个n*o矩阵的结果是m*o矩阵。 <br>
两个矩阵相乘，第一个矩阵的列数等于第二个矩阵的行数。</p><div class="md-section-divider"></div><h4 data-anchor-id="psj4" id="矩阵乘法的性质">矩阵乘法的性质</h4><ul data-anchor-id="5l6z">
<li>不满足交换律</li>
<li>满足结合律</li>
<li>单位阵是什么（省略）</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="5qzq" id="逆阵和转置">逆阵和转置</h4><p data-anchor-id="zkei">一个方阵和逆阵相乘等于单位阵。 <br>
非方阵没有逆阵。 <br>
没有逆阵的矩阵叫奇异或退化(singular or degenerate)。 <br>
矩阵的转置就像把矩阵顺时针转九十度然后翻转。</p><div class="md-section-divider"></div><h2 data-anchor-id="dgpw" id="第二周">第二周</h2><div class="md-section-divider"></div><h3 data-anchor-id="kh9q" id="多元线性回归">多元线性回归</h3><p data-anchor-id="k5ag">定义以下记号： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 38026.58680281877 1541.6859447337067" style="width: 88.263ex; height: 3.591ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="809" y="738"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="809" y="-430"></use><use xlink:href="#MJMATHI-69" x="964" y="0"></use><use xlink:href="#MJMAIN-29" x="1309" y="0"></use><use xlink:href="#MJMAIN-3A" x="1976" y="0"></use><g transform="translate(2533,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-69" x="3331" y="0"></use><g transform="translate(3676,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">个</text></g><g transform="translate(4474,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">训</text></g><g transform="translate(5272,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">练</text></g><g transform="translate(6070,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">例</text></g><g transform="translate(6868,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">子</text></g><g transform="translate(7666,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(8464,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-6A" x="9262" y="0"></use><g transform="translate(9674,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">个</text></g><g transform="translate(10472,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">特</text></g><g transform="translate(11270,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">征</text></g><g transform="translate(12068,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(12866,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">值</text></g><g transform="translate(13664,0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="809" y="583"></use></g><use xlink:href="#MJMATHI-69" x="14612" y="0"></use><use xlink:href="#MJMAIN-29" x="14957" y="0"></use><use xlink:href="#MJMAIN-3A" x="15625" y="0"></use><g transform="translate(16181,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-69" x="16979" y="0"></use><g transform="translate(17324,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">个</text></g><g transform="translate(18122,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">训</text></g><g transform="translate(18920,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">练</text></g><g transform="translate(19718,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">例</text></g><g transform="translate(20516,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">子</text></g><g transform="translate(21314,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(22112,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">所</text></g><g transform="translate(22910,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">有</text></g><g transform="translate(23708,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">特</text></g><g transform="translate(24506,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">征</text></g><g transform="translate(25304,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">列</text></g><g transform="translate(26102,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">向</text></g><g transform="translate(26900,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">量</text></g><use xlink:href="#MJMATHI-6D" x="27698" y="0"></use><use xlink:href="#MJMAIN-3A" x="28854" y="0"></use><g transform="translate(29410,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">训</text></g><g transform="translate(30208,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">练</text></g><g transform="translate(31006,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">例</text></g><g transform="translate(31804,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">子</text></g><g transform="translate(32602,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">个</text></g><g transform="translate(33400,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g><use xlink:href="#MJMATHI-6E" x="34198" y="0"></use><use xlink:href="#MJMAIN-3A" x="35076" y="0"></use><g transform="translate(35632,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">特</text></g><g transform="translate(36430,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">征</text></g><g transform="translate(37228,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">x_j^(i): 第i个训练例子的第j个特征的值
x^(i): 第i个训练例子的所有特征列向量
m: 训练例子个数
n: 特征数</script> <br>
向量形式<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -862.3620829925038 5334.198916668563 1133.4137683405283" style="width: 12.394ex; height: 2.664ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use><use xlink:href="#MJMAIN-28" x="1008" y="0"></use><use xlink:href="#MJMATHI-78" x="1397" y="0"></use><use xlink:href="#MJMAIN-29" x="1970" y="0"></use><use xlink:href="#MJMAIN-3D" x="2637" y="0"></use><g transform="translate(3694,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="513"></use></g><use xlink:href="#MJMATHI-78" x="4761" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-36">h_{\theta}(x) = \theta^{T}x</script> <br>
一般来说，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.0516853480245 852.5 725.103370696049" style="width: 1.969ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-58"></use></g></svg></span><script type="math/tex" id="MathJax-Element-37">X</script>以行向量形式储存每个训练例子，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-38">\theta</script>是列向量，那么 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 5296.042189322639 1042.103370696049" style="width: 12.278ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use><use xlink:href="#MJMAIN-28" x="1008" y="0"></use><use xlink:href="#MJMATHI-58" x="1397" y="0"></use><use xlink:href="#MJMAIN-29" x="2250" y="0"></use><use xlink:href="#MJMAIN-3D" x="2917" y="0"></use><use xlink:href="#MJMATHI-58" x="3974" y="0"></use><use xlink:href="#MJMATHI-3B8" x="4826" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">h_{\theta}(X) = X\theta</script></p><div class="md-section-divider"></div><h3 data-anchor-id="rpfj" id="损失函数-1">损失函数</h3><p data-anchor-id="he56"><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-40-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-40">\theta</script>是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -854.5839083994518 2188.507195240116 896.6355937474763" style="width: 5.097ex; height: 2.085ex; vertical-align: -0.232ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-52"></use><g transform="translate(759,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="600" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-41">R^{n+1}</script>的向量 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 13282.493395306165 2802.850285968542" style="width: 30.811ex; height: 6.486ex; vertical-align: -2.896ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><g transform="translate(3216,0)"><g transform="translate(120,0)"><rect stroke="none" width="1499" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="499" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g></g><g transform="translate(5121,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="6566" y="0"></use><g transform="translate(6955,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="7964" y="0"></use><g transform="translate(8353,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="10043" y="0"></use><g transform="translate(11044,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><g transform="translate(12439,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-42">J(\theta) = {1 \over 2m} \sum_{i=1}^m(h_{\theta}(x^{(i)}-y^{(i)})^{2}</script> <br>
向量版本是 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-43-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1363.5596853480245 13196.101171790368 2081.562370696049" style="width: 30.695ex; height: 4.865ex; vertical-align: -1.737ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><g transform="translate(3216,0)"><g transform="translate(120,0)"><rect stroke="none" width="1499" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="499" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g></g><use xlink:href="#MJMAIN-28" x="4955" y="0"></use><use xlink:href="#MJMATHI-58" x="5344" y="0"></use><use xlink:href="#MJMATHI-3B8" x="6197" y="0"></use><use xlink:href="#MJMAIN-2212" x="6888" y="0"></use><use xlink:href="#MJMATHI-79" x="7889" y="0"></use><g transform="translate(8387,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="583"></use></g><use xlink:href="#MJMAIN-28" x="9374" y="0"></use><use xlink:href="#MJMATHI-58" x="9764" y="0"></use><use xlink:href="#MJMATHI-3B8" x="10616" y="0"></use><use xlink:href="#MJMAIN-2212" x="11308" y="0"></use><use xlink:href="#MJMATHI-79" x="12309" y="0"></use><use xlink:href="#MJMAIN-29" x="12806" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-43">J(\theta) = {1 \over 2m} (X\theta - y)^T(X\theta - y)</script></p><div class="md-section-divider"></div><h3 data-anchor-id="827l" id="多元梯度下降">多元梯度下降</h3><p data-anchor-id="amx2"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-44-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -867.8607200970592 30371.51189189189 5623.251799482055" style="width: 70.541ex; height: 13.089ex; vertical-align: -11.12ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(12513,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">重</text><g transform="translate(797,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">复</text></g><g transform="translate(1595,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">直</text></g><g transform="translate(2393,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">到</text></g><g transform="translate(3191,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">收</text></g><g transform="translate(3989,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">敛</text></g><use xlink:href="#MJMAIN-3A" x="5065" y="0"></use></g><g transform="translate(12461,-1337)"><use xlink:href="#MJMATHI-66"></use><use xlink:href="#MJMATHI-6F" x="550" y="0"></use><use xlink:href="#MJMATHI-72" x="1036" y="0"></use><use xlink:href="#MJMATHI-6A" x="1487" y="0"></use><g transform="translate(2177,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(3512,0)"><use xlink:href="#MJMAIN-30"></use><use xlink:href="#MJMAIN-2E" x="500" y="0"></use><use xlink:href="#MJMAIN-2E" x="779" y="0"></use><use xlink:href="#MJMAIN-2E" x="1057" y="0"></use></g><use xlink:href="#MJMATHI-6E" x="4848" y="0"></use></g><g transform="translate(7296,-3538)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use><g transform="translate(1138,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(2473,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="3557" y="0"></use><use xlink:href="#MJMATHI-3B1" x="4557" y="0"></use><g transform="translate(5198,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(6603,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="8048" y="0"></use><g transform="translate(8437,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="9446" y="0"></use><g transform="translate(9835,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="11525" y="0"></use><g transform="translate(12526,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="13920" y="0"></use><g transform="translate(14310,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="809" y="-430"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-44"> 
重复直到收敛:{ \\
    for j:= 0...n \\ 
    \theta_{j} := \theta_{j} - \alpha{1 \over m}\sum_{i=1}^{m}(h_{\theta}(x^{(i)}-y^{(i)})x_{j}^{(i)}
}</script></p><p data-anchor-id="1i2h">向量形式： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-45-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 30371.51189189189 3290.1163706960488" style="width: 70.541ex; height: 7.645ex; vertical-align: -5.907ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(11620,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(747,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><use xlink:href="#MJMATHI-3B8" x="2082" y="0"></use><use xlink:href="#MJMAIN-2212" x="2773" y="0"></use><use xlink:href="#MJMATHI-3B1" x="3774" y="0"></use><use xlink:href="#MJMAIN-2207" x="4415" y="0"></use><use xlink:href="#MJMATHI-4A" x="5248" y="0"></use><use xlink:href="#MJMAIN-28" x="5882" y="0"></use><use xlink:href="#MJMATHI-3B8" x="6271" y="0"></use><use xlink:href="#MJMAIN-29" x="6741" y="0"></use></g><g transform="translate(10413,-1802)"><use xlink:href="#MJMAIN-3D" x="277" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1334" y="0"></use><use xlink:href="#MJMAIN-2212" x="2025" y="0"></use><g transform="translate(3026,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3B1" x="179" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(4265,0)"><use xlink:href="#MJMATHI-58"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="1215" y="583"></use></g><use xlink:href="#MJMAIN-28" x="5722" y="0"></use><use xlink:href="#MJMATHI-58" x="6112" y="0"></use><use xlink:href="#MJMATHI-3B8" x="6964" y="0"></use><use xlink:href="#MJMAIN-2212" x="7656" y="0"></use><use xlink:href="#MJMATHI-79" x="8657" y="0"></use><use xlink:href="#MJMAIN-29" x="9154" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">\theta := \theta - \alpha \nabla J(\theta) \\
= \theta - {\alpha \over m} X^T(X\theta - y)</script></p><div class="md-section-divider"></div><h3 data-anchor-id="dzv4" id="特征正则化">特征正则化</h3><ul data-anchor-id="gnxu">
<li>特征放缩：输入值除以范围（最大值与最小值的差）</li>
<li>均值归一：输入值减去均值 <br>
两个方法一起用</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="rv79" id="梯度下降tips">梯度下降tips</h3><ul data-anchor-id="a79a">
<li>画图看损失函数，如果有上升说明学习率太大</li>
<li>设一个足够小的判定收敛的阀值</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="nk04" id="特征与多项式回归">特征与多项式回归</h3><p data-anchor-id="3zhr">改善模型，考虑把多个特征合成一个</p><div class="md-section-divider"></div><h4 data-anchor-id="cndu" id="多项式回归">多项式回归</h4><p data-anchor-id="jq0i">通过对特征取幂形成新的特征，得到多项式假设函数 <br>
或者取个平方根 <br>
使用这些方法时，特征放缩非常重要</p><div class="md-section-divider"></div><h3 data-anchor-id="bdi2" id="标准方程">标准方程</h3><p data-anchor-id="8rbt">是一种不用迭代寻找最优值的方法 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-46-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -912.3620829925038 7852.758583384995 1183.4137683405283" style="width: 18.185ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use xlink:href="#MJMAIN-3D" x="747" y="0"></use><use xlink:href="#MJMAIN-28" x="1803" y="0"></use><g transform="translate(2193,0)"><use xlink:href="#MJMATHI-58"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="1215" y="583"></use></g><use xlink:href="#MJMATHI-58" x="3650" y="0"></use><g transform="translate(4503,0)"><use xlink:href="#MJMAIN-29"></use><g transform="translate(389,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="778" y="0"></use></g></g><g transform="translate(5897,0)"><use xlink:href="#MJMATHI-58"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="1215" y="583"></use></g><use xlink:href="#MJMATHI-79" x="7355" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-46">\theta = (X^TX)^{-1}X^Ty</script> <br>
推导：令误差的平方的一次导数为零</p><p data-anchor-id="xyty">注意：</p><ul data-anchor-id="ob32">
<li>不用特征放缩</li>
<li>复杂度是立方，比梯度下降的平方慢</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-47-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -862.3620829925038 2310.4067273459227 883.4137683405282" style="width: 5.328ex; height: 2.085ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-58"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="1215" y="513"></use><use xlink:href="#MJMATHI-58" x="1457" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-47">X^TX</script>有可能不可逆，原因是特征之间线性相关或者特征太多了</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="5nen" id="第三周">第三周</h2><p data-anchor-id="a8at">逻辑斯特回归 <br>
虽有回归之名，其实解决的是分类问题</p><div class="md-section-divider"></div><h3 data-anchor-id="ci49" id="二元分类">二元分类</h3><p data-anchor-id="nobq">0为负类，1为正类 <br>
当假设满足<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-48-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 6029.097744878194 1042.103370696049" style="width: 14.015ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-30"></use><use xlink:href="#MJMAIN-2264" x="778" y="0"></use><g transform="translate(1834,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="2843" y="0"></use><use xlink:href="#MJMATHI-78" x="3232" y="0"></use><use xlink:href="#MJMAIN-29" x="3805" y="0"></use><use xlink:href="#MJMAIN-2264" x="4472" y="0"></use><use xlink:href="#MJMAIN-31" x="5528" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">0 \leq h_\theta(x) \leq 1</script> <br>
使用Sigmoid函数，也叫逻辑斯特函数： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-49-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1363.5596853480245 30371.51189189189 5062.291165985007" style="width: 70.541ex; height: 11.815ex; vertical-align: -8.687ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(11836,0)"><use xlink:href="#MJMATHI-67"></use><use xlink:href="#MJMAIN-28" x="480" y="0"></use><use xlink:href="#MJMATHI-78" x="870" y="0"></use><use xlink:href="#MJMAIN-29" x="1442" y="0"></use><use xlink:href="#MJMAIN-3D" x="2109" y="0"></use><g transform="translate(3166,0)"><g transform="translate(120,0)"><rect stroke="none" width="3291" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="1395" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-2B" x="722" y="0"></use><g transform="translate(1723,0)"><use xlink:href="#MJMATHI-65"></use><g transform="translate(466,288)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-7A" x="778" y="0"></use></g></g></g></g></g></g><g transform="translate(12901,-2092)"><use xlink:href="#MJMATHI-6C"></use><use xlink:href="#MJMATHI-65" x="298" y="0"></use><use xlink:href="#MJMATHI-74" x="765" y="0"></use><use xlink:href="#MJMATHI-7A" x="1126" y="0"></use><use xlink:href="#MJMAIN-3D" x="1872" y="0"></use><g transform="translate(2929,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="583"></use></g><use xlink:href="#MJMATHI-78" x="3996" y="0"></use></g><g transform="translate(10357,-3428)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use><use xlink:href="#MJMAIN-28" x="1008" y="0"></use><use xlink:href="#MJMATHI-78" x="1397" y="0"></use><use xlink:href="#MJMAIN-29" x="1970" y="0"></use><use xlink:href="#MJMAIN-3D" x="2637" y="0"></use><use xlink:href="#MJMATHI-67" x="3694" y="0"></use><use xlink:href="#MJMAIN-28" x="4174" y="0"></use><use xlink:href="#MJMATHI-7A" x="4564" y="0"></use><use xlink:href="#MJMAIN-29" x="5032" y="0"></use><use xlink:href="#MJMAIN-3D" x="5699" y="0"></use><use xlink:href="#MJMATHI-67" x="6756" y="0"></use><use xlink:href="#MJMAIN-28" x="7236" y="0"></use><g transform="translate(7626,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="583"></use></g><use xlink:href="#MJMATHI-78" x="8693" y="0"></use><use xlink:href="#MJMAIN-29" x="9266" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-49">g(x) = {1\over 1+e^{-z}}\\
let z = \theta^Tx \\ 
h_\theta(x) = g(z) = g(\theta^Tx) </script> <br>
输出结果为1的概率</p><div class="md-section-divider"></div><h3 data-anchor-id="w90o" id="决策边界">决策边界</h3><p data-anchor-id="xg76">为了得到二元分类，我们约定： <br>
逻辑斯特函数输出大于等于0.5，表示<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-50-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -687.0516853480245 2332.0555555555557 913.103370696049" style="width: 5.444ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-79"></use><use xlink:href="#MJMAIN-3D" x="775" y="0"></use><use xlink:href="#MJMAIN-31" x="1831" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-50">y = 1</script> <br>
逻辑斯特函数输出小于0.5，表示<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-51-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -687.0516853480245 2332.0555555555557 913.103370696049" style="width: 5.444ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-79"></use><use xlink:href="#MJMAIN-3D" x="775" y="0"></use><use xlink:href="#MJMAIN-30" x="1831" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-51">y = 0</script> <br>
记住逻辑斯特的函数图像 <br>
决策边界就是y=0和y=1的分界线</p><div class="md-section-divider"></div><h3 data-anchor-id="2mhq" id="损失函数-2">损失函数</h3><p data-anchor-id="s9j5">原来的用不了了，原来那个已经不是凸函数了 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-52-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 25846.561791533484 2802.850285968542" style="width: 60ex; height: 6.486ex; vertical-align: -2.896ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><use xlink:href="#MJMAIN-2212" x="3216" y="0"></use><g transform="translate(3994,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5399,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><g transform="translate(7010,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMATHI-6C" x="8405" y="0"></use><use xlink:href="#MJMATHI-6F" x="8704" y="0"></use><use xlink:href="#MJMATHI-67" x="9189" y="0"></use><use xlink:href="#MJMAIN-28" x="9670" y="0"></use><g transform="translate(10059,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="11068" y="0"></use><g transform="translate(11457,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="12925" y="0"></use><use xlink:href="#MJMAIN-29" x="13314" y="0"></use><use xlink:href="#MJMAIN-2B" x="13926" y="0"></use><use xlink:href="#MJMAIN-28" x="14927" y="0"></use><use xlink:href="#MJMAIN-31" x="15316" y="0"></use><use xlink:href="#MJMAIN-2212" x="16039" y="0"></use><g transform="translate(17040,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="18434" y="0"></use><use xlink:href="#MJMATHI-6C" x="18824" y="0"></use><use xlink:href="#MJMATHI-6F" x="19122" y="0"></use><use xlink:href="#MJMATHI-67" x="19608" y="0"></use><use xlink:href="#MJMAIN-28" x="20088" y="0"></use><use xlink:href="#MJMAIN-31" x="20478" y="0"></use><use xlink:href="#MJMAIN-2212" x="21201" y="0"></use><g transform="translate(22201,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="23210" y="0"></use><g transform="translate(23599,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="25067" y="0"></use><use xlink:href="#MJMAIN-29" x="25457" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-52">J(\theta) = -{1 \over m}\sum_{i=1}^m y^{(i)}log(h_\theta(x^{(i)})) + (1-y^{(i)})log(1-h_\theta(x^{(i)}))</script></p><p data-anchor-id="f1uy">向量形式： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-53-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 30371.51189189189 3514.1163706960488" style="width: 70.541ex; height: 8.108ex; vertical-align: -6.486ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(12939,0)"><use xlink:href="#MJMATHI-68"></use><use xlink:href="#MJMAIN-3D" x="854" y="0"></use><use xlink:href="#MJMATHI-67" x="1910" y="0"></use><use xlink:href="#MJMAIN-28" x="2391" y="0"></use><use xlink:href="#MJMATHI-58" x="2780" y="0"></use><use xlink:href="#MJMATHI-3B8" x="3633" y="0"></use><use xlink:href="#MJMAIN-29" x="4102" y="0"></use></g><g transform="translate(5738,-2026)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><g transform="translate(3216,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><use xlink:href="#MJMAIN-28" x="4454" y="0"></use><use xlink:href="#MJMAIN-2212" x="4844" y="0"></use><g transform="translate(5622,0)"><use xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="706" y="583"></use></g><use xlink:href="#MJMATHI-6C" x="6720" y="0"></use><use xlink:href="#MJMATHI-6F" x="7018" y="0"></use><use xlink:href="#MJMATHI-67" x="7504" y="0"></use><use xlink:href="#MJMAIN-28" x="7984" y="0"></use><use xlink:href="#MJMATHI-68" x="8374" y="0"></use><use xlink:href="#MJMAIN-29" x="8950" y="0"></use><use xlink:href="#MJMAIN-2212" x="9562" y="0"></use><use xlink:href="#MJMAIN-28" x="10563" y="0"></use><use xlink:href="#MJMAIN-31" x="10952" y="0"></use><use xlink:href="#MJMAIN-2212" x="11675" y="0"></use><use xlink:href="#MJMATHI-79" x="12676" y="0"></use><g transform="translate(13173,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="583"></use></g><use xlink:href="#MJMATHI-6C" x="14161" y="0"></use><use xlink:href="#MJMATHI-6F" x="14459" y="0"></use><use xlink:href="#MJMATHI-67" x="14945" y="0"></use><use xlink:href="#MJMAIN-28" x="15425" y="0"></use><use xlink:href="#MJMAIN-31" x="15815" y="0"></use><use xlink:href="#MJMAIN-2212" x="16538" y="0"></use><use xlink:href="#MJMATHI-68" x="17538" y="0"></use><use xlink:href="#MJMAIN-29" x="18115" y="0"></use><use xlink:href="#MJMAIN-29" x="18504" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-53"> h = g(X\theta) \\
J(\theta) = {1 \over m}(-y^Tlog(h)-(1-y)^Tlog(1-h))</script></p><div class="md-section-divider"></div><h3 data-anchor-id="jijf" id="梯度下降-1">梯度下降</h3><p data-anchor-id="lz6h">与之前的没区别 <br>
向量形式多套一个<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-54-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 2581.5 1042.103370696049" style="width: 6.023ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-67"></use><use xlink:href="#MJMAIN-28" x="480" y="0"></use><use xlink:href="#MJMATHI-3B8" x="870" y="0"></use><use xlink:href="#MJMATHI-58" x="1339" y="0"></use><use xlink:href="#MJMAIN-29" x="2192" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-54">g(\theta X)</script>而已</p><div class="md-section-divider"></div><h3 data-anchor-id="pxoo" id="损失函数jthetajtheta的偏导数推导">损失函数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-55-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -777.3226757464414 1882 1054.6453514928828" style="width: 4.412ex; height: 2.471ex; vertical-align: -0.794ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-55">J(\theta)</script>的偏导数推导</h3><p data-anchor-id="kwii">先算逻辑斯特函数的导数： <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-56-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -920.0470793863732 11442.960678118654 1191.0987647343977" style="width: 26.525ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-67"></use><use xlink:href="#MJMAIN-28" x="480" y="0"></use><use xlink:href="#MJMATHI-7A" x="870" y="0"></use><g transform="translate(1338,0)"><use xlink:href="#MJMAIN-29"></use><g transform="translate(389,362)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-2032" x="0" y="513"></use></g></g><use xlink:href="#MJMAIN-3D" x="2314" y="0"></use><use xlink:href="#MJMAIN-2E" x="3092" y="0"></use><use xlink:href="#MJMAIN-2E" x="3537" y="0"></use><use xlink:href="#MJMAIN-2E" x="3983" y="0"></use><use xlink:href="#MJMAIN-3D" x="4428" y="0"></use><use xlink:href="#MJMATHI-67" x="5484" y="0"></use><use xlink:href="#MJMAIN-28" x="5965" y="0"></use><use xlink:href="#MJMATHI-7A" x="6354" y="0"></use><use xlink:href="#MJMAIN-29" x="6823" y="0"></use><use xlink:href="#MJMAIN-28" x="7212" y="0"></use><use xlink:href="#MJMAIN-31" x="7602" y="0"></use><use xlink:href="#MJMAIN-2212" x="8324" y="0"></use><use xlink:href="#MJMATHI-67" x="9325" y="0"></use><use xlink:href="#MJMAIN-28" x="9805" y="0"></use><use xlink:href="#MJMATHI-7A" x="10195" y="0"></use><use xlink:href="#MJMAIN-29" x="10663" y="0"></use><use xlink:href="#MJMAIN-29" x="11053" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-56">g(z)^{'} = ... = g(z)(1-g(z))</script> <br>
再对损失函数关于<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-57-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 861.1815472394509 1041.0602608392912" style="width: 1.969ex; height: 2.432ex; vertical-align: -0.811ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-57">\theta_j</script>求偏导： <br>
和式的偏导等于偏导的和式，找到变量<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-58-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-58">\theta</script>所在的项，复合函数求导， <br>
注意到<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-59-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 6707.225843999127 1711.4303873733695" style="width: 15.521ex; height: 3.938ex; vertical-align: -1.622ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="1130" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2202" x="515" y="593"></use><g transform="translate(60,-410)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2202"></use><g transform="translate(401,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g></g></g><g transform="translate(1370,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="513"></use></g><g transform="translate(2437,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-3D" x="4183" y="0"></use><g transform="translate(5239,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="809" y="-430"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-59">{\partial \over \partial \theta_j} \theta^T x^{(i)} = x_j^{(i)}</script> <br>
(x的各个分量的线性组合对第j个分量求导的结果) <br>
分子分母约一下，合并一下，得到 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-60-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 15751.909574006022 2802.850285968542" style="width: 36.602ex; height: 6.486ex; vertical-align: -2.896ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="1548" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-2202" x="490" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g></g></g><use xlink:href="#MJMATHI-4A" x="1788" y="0"></use><use xlink:href="#MJMAIN-28" x="2422" y="0"></use><use xlink:href="#MJMATHI-3B8" x="2811" y="0"></use><use xlink:href="#MJMAIN-29" x="3281" y="0"></use><use xlink:href="#MJMAIN-3D" x="3948" y="0"></use><g transform="translate(5004,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(6409,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-5B" x="7854" y="0"></use><g transform="translate(8132,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="9141" y="0"></use><g transform="translate(9530,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="10998" y="0"></use><use xlink:href="#MJMAIN-2212" x="11610" y="0"></use><g transform="translate(12610,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-5D" x="14005" y="0"></use><g transform="translate(14284,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="809" y="-430"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-60">{\partial \over \partial \theta_j} J(\theta) = {1\over m}\sum_{i=1}^m[h_{\theta}(x^{(i)})-y^{(i)}]x_j^{(i)}</script></p><p data-anchor-id="gyy1">向量形式： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-61-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1363.5596853480245 11826.906727345924 2081.562370696049" style="width: 27.452ex; height: 4.865ex; vertical-align: -1.737ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-2207"></use><use xlink:href="#MJMATHI-4A" x="833" y="0"></use><use xlink:href="#MJMAIN-28" x="1467" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1856" y="0"></use><use xlink:href="#MJMAIN-29" x="2326" y="0"></use><use xlink:href="#MJMAIN-3D" x="2993" y="0"></use><g transform="translate(4049,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5288,0)"><use xlink:href="#MJMATHI-58"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="1215" y="583"></use></g><use xlink:href="#MJMAIN-28" x="6745" y="0"></use><use xlink:href="#MJMATHI-67" x="7135" y="0"></use><use xlink:href="#MJMAIN-28" x="7615" y="0"></use><use xlink:href="#MJMATHI-58" x="8005" y="0"></use><use xlink:href="#MJMATHI-3B8" x="8857" y="0"></use><use xlink:href="#MJMAIN-29" x="9327" y="0"></use><use xlink:href="#MJMAIN-2212" x="9939" y="0"></use><use xlink:href="#MJMATHI-79" x="10939" y="0"></use><use xlink:href="#MJMAIN-29" x="11437" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-61">\nabla J(\theta) = {1\over m}X^T(g(X\theta)-y)</script></p><div class="md-section-divider"></div><h3 data-anchor-id="iutx" id="高级优化">高级优化</h3><p data-anchor-id="n02a">更好的优化手段：共轭梯度、BFGS、L-BFGS</p><ul data-anchor-id="uxwe">
<li><p>BFGS算法（以四个人的名字首字母命名）： <br>
对二阶优化方法————牛顿算法的一种改进，因为牛顿算法考虑二阶导数，而计算Hassian矩阵很耗时，BFGS提出一种方法近似求得Hassian矩阵。 <br>
<a href="http://www.cnblogs.com/kemaswill/p/3352898.html" target="_blank">http://www.cnblogs.com/kemaswill/p/3352898.html</a></p></li>
<li><p>L-BFGS算法： <br>
当Hassian矩阵比较大的时候，用Limited-memory BFGS <br>
<a href="https://en.wikipedia.org/wiki/Limited-memory_BFGS" target="_blank">https://en.wikipedia.org/wiki/Limited-memory_BFGS</a></p></li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="yzpk" id="多类别分类一对多">多类别分类：一对多</h3><p data-anchor-id="hkug">目标是把数据分成n+1类(y={0,1...n}) <br>
把问题分割成n+1个二元分类问题 <br>
在每个问题中，计算y属于第k个类的概率<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-62-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 5649.222222222223 1042.103370696049" style="width: 13.089ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-50"></use><use xlink:href="#MJMAIN-28" x="751" y="0"></use><use xlink:href="#MJMATHI-79" x="1141" y="0"></use><use xlink:href="#MJMAIN-3D" x="1916" y="0"></use><use xlink:href="#MJMATHI-6B" x="2972" y="0"></use><use xlink:href="#MJMAIN-7C" x="3494" y="0"></use><use xlink:href="#MJMATHI-78" x="3772" y="0"></use><use xlink:href="#MJMAIN-3B" x="4345" y="0"></use><use xlink:href="#MJMATHI-3B8" x="4790" y="0"></use><use xlink:href="#MJMAIN-29" x="5259" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-62">P(y=k|x;\theta)</script> <br>
然后求概率最大值</p><p data-anchor-id="q75y">选择一个类，然后把其他剩下的类看作一个整体，反复运用二元逻辑斯特回归，然后求概率最大值</p><div class="md-section-divider"></div><h3 data-anchor-id="nibq" id="正则化">正则化</h3><div class="md-section-divider"></div><h4 data-anchor-id="v28s" id="过拟合">过拟合</h4><p data-anchor-id="ec2t">正则化用来解决过拟合问题</p><p data-anchor-id="8y6o">高偏差(high bias)/欠拟合：假设函数不能很好地预测数据的趋势。原因是函数太简单或者特征太少 <br>
高方差(high variance)/过拟合：能够拟合已有数据的假设函数没有很好地泛化来预测新数据。原因是函数太复杂，产生太多与数据无关的曲线和角</p><p data-anchor-id="5auq">解决过拟合的手段：</p><ul data-anchor-id="f0qu">
<li><p>减少特征的数量： </p>

<ol><li>手工选择保留哪个特征</li>
<li>使用模型选择(model selection)算法</li></ol></li>
<li><p>正则化 <br>
保留所有特征，但减小参数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-63-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-63">\theta</script> <br>
当我们有很多稍微有用(slightly useful)的特征时，正则化有效。</p></li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="gigu" id="损失函数-3">损失函数</h4><p data-anchor-id="ziud">通过增加损失来减小假设函数中某些项的权重(<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-64-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-64">\theta</script>值) <br>
例如：如果我想让一个四阶函数更像平方函数，那么就要减小三阶和四阶变量的影响（而不是把它们从假设函数中移除），我们可以在损失函数中加上三阶和四阶变量对应的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-65-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-65">\theta</script>参数，并赋予很大的权值。如果想要损失函数接近零，那么就要使得三阶和四阶变量对应的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-66-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-66">\theta</script>参数接近零，从而达到减小三阶和四阶变量影响的目的。</p><p data-anchor-id="ujow">也可以通过求和来正则化所有的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-67-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-67">\theta</script>参数 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-68-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 16830.609195279336 2939.3218947375453" style="width: 39.035ex; height: 6.834ex; vertical-align: -3.243ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6D"></use><use xlink:href="#MJMATHI-69" x="878" y="0"></use><g transform="translate(1224,0)"><use xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="849" y="-219"></use></g><g transform="translate(2256,0)"><g transform="translate(120,0)"><rect stroke="none" width="1499" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="499" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g></g><g transform="translate(4162,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="5606" y="0"></use><g transform="translate(5996,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="7004" y="0"></use><g transform="translate(7394,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="9084" y="0"></use><g transform="translate(10084,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><g transform="translate(11479,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="#MJMAIN-2B" x="12545" y="0"></use><use xlink:href="#MJMATHI-3BB" x="13545" y="0"></use><g transform="translate(14296,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><g transform="translate(15907,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="663" y="488"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-430"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-68">min_{\theta} {1 \over 2m} \sum_{i=1}^m(h_{\theta}(x^{(i)}-y^{(i)})^{2} + \lambda \sum_{j=1}^n \theta_j^2</script> <br>
其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-69-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 583.5 748.103370696049" style="width: 1.39ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BB"></use></g></svg></span><script type="math/tex" id="MathJax-Element-69">\lambda</script>是正则化参数，决定<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-70-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-70">\theta</script>参数的损失（或惩罚）应该“放大”多少。</p><p data-anchor-id="7leq">使用带有求和项的损失憾事，我们可以把假设函数的输出光滑化(smooth)，从而减小过拟合。但是如果正则化参数太大，会导致过于平滑而欠拟合。</p><div class="md-section-divider"></div><h4 data-anchor-id="t2dd" id="正则化线性回归">正则化线性回归</h4><ul data-anchor-id="2c2d">
<li>梯度下降 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-71-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -867.8607200970592 29124.733899613897 8816.552714754549" style="width: 67.645ex; height: 20.502ex; vertical-align: -18.533ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(11890,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">重</text><g transform="translate(797,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">复</text></g><g transform="translate(1595,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">直</text></g><g transform="translate(2393,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">到</text></g><g transform="translate(3191,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">收</text></g><g transform="translate(3989,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">敛</text></g><use xlink:href="#MJMAIN-3A" x="5065" y="0"></use></g><g transform="translate(6332,-2195)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use><g transform="translate(1201,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(2535,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="3681" y="0"></use><use xlink:href="#MJMATHI-3B1" x="4682" y="0"></use><use xlink:href="#MJMAIN-5B" x="5322" y="0"></use><g transform="translate(5601,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(7006,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="8450" y="0"></use><g transform="translate(8840,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="9848" y="0"></use><g transform="translate(10238,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="11928" y="0"></use><g transform="translate(12929,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="14323" y="0"></use><g transform="translate(14713,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="809" y="-435"></use></g><use xlink:href="#MJMAIN-5D" x="16180" y="0"></use></g><g transform="translate(11837,-4530)"><use xlink:href="#MJMATHI-66"></use><use xlink:href="#MJMATHI-6F" x="550" y="0"></use><use xlink:href="#MJMATHI-72" x="1036" y="0"></use><use xlink:href="#MJMATHI-6A" x="1487" y="0"></use><g transform="translate(2177,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(3512,0)"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-2E" x="500" y="0"></use><use xlink:href="#MJMAIN-2E" x="779" y="0"></use><use xlink:href="#MJMAIN-2E" x="1057" y="0"></use></g><use xlink:href="#MJMATHI-6E" x="4848" y="0"></use></g><g transform="translate(4733,-6731)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use><g transform="translate(1138,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(2473,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="3557" y="0"></use><use xlink:href="#MJMATHI-3B1" x="4557" y="0"></use><use xlink:href="#MJMAIN-5B" x="5198" y="0"></use><g transform="translate(5476,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(6882,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="8326" y="0"></use><g transform="translate(8716,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="9724" y="0"></use><g transform="translate(10114,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="11803" y="0"></use><g transform="translate(12804,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="14199" y="0"></use><g transform="translate(14588,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="809" y="-430"></use></g><use xlink:href="#MJMAIN-2B" x="16278" y="0"></use><g transform="translate(17279,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3BB" x="207" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(18517,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-5D" x="19379" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-71"> 
重复直到收敛:{ \\
    \theta_{0} := \theta_{0} - \alpha[{1 \over m}\sum_{i=1}^{m}(h_{\theta}(x^{(i)}-y^{(i)})x_{0}^{(i)}] \\
for j:= 1...n \\ 
\theta_{j} := \theta_{j} - \alpha[{1 \over m}\sum_{i=1}^{m}(h_{\theta}(x^{(i)}-y^{(i)})x_{j}^{(i)} + {\lambda \over m} \theta_j]
}</script></li>
</ul><p data-anchor-id="1jsp">把<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-72-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 912.3668266633396" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-72">\theta_0</script>跟其他参数分开，因为没必要惩罚它（它不控制x分量）</p><ul data-anchor-id="2m8h">
<li>标准方程 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-73-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -912.3620829925038 10340.70302782944 1183.4137683405283" style="width: 23.977ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use xlink:href="#MJMAIN-3D" x="747" y="0"></use><use xlink:href="#MJMAIN-28" x="1803" y="0"></use><g transform="translate(2193,0)"><use xlink:href="#MJMATHI-58"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="1215" y="583"></use></g><use xlink:href="#MJMATHI-58" x="3650" y="0"></use><use xlink:href="#MJMAIN-2B" x="4725" y="0"></use><use xlink:href="#MJMATHI-3BB" x="5726" y="0"></use><use xlink:href="#MJMATHI-4C" x="6309" y="0"></use><g transform="translate(6991,0)"><use xlink:href="#MJMAIN-29"></use><g transform="translate(389,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="778" y="0"></use></g></g><g transform="translate(8385,0)"><use xlink:href="#MJMATHI-58"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="1215" y="583"></use></g><use xlink:href="#MJMATHI-79" x="9843" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-73">\theta = (X^TX + \lambda L)^{-1}X^T y</script> <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-74-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -3654.6984421047814 15661.624091325051 7022.236025346713" style="width: 36.371ex; height: 16.332ex; vertical-align: -7.876ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4C"></use><use xlink:href="#MJMAIN-3D" x="959" y="0"></use><g transform="translate(2015,0)"><g transform="translate(0,3634)"><use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-5012.884087166637) scale(1,5.409426346876678)"><use xlink:href="#MJSZ4-23A2"></use></g><use xlink:href="#MJSZ4-23A3" x="0" y="-6125"></use></g><g transform="translate(834,0)"><g transform="translate(-16,0)"><use xlink:href="#MJMAIN-30" x="0" y="2834"></use></g><g transform="translate(1485,0)"><use xlink:href="#MJMAIN-31" x="148" y="1634"></use><g transform="translate(0,385)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">　</text></g></g><g transform="translate(3283,0)"><use xlink:href="#MJMAIN-31" x="0" y="385"></use></g><g transform="translate(4783,0)"><use xlink:href="#MJMAIN-22F1" x="0" y="-1735"></use></g><use xlink:href="#MJMAIN-31" x="7066" y="-2935"></use></g><g transform="translate(8568,3634)"><use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-5012.884087166637) scale(1,5.409426346876678)"><use xlink:href="#MJSZ4-23A5"></use></g><use xlink:href="#MJSZ4-23A6" x="0" y="-6125"></use></g><g transform="translate(9235,-3171)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="989" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1768" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="2269" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-D7" x="2658" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="3437" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="3826" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="4427" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="5205" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="5706" y="0"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-74">L = \begin{bmatrix} 0 \\ & 1 \\ &　& 1 \\ & & & \ddots \\ & & & & 1
\end{bmatrix}_{(n+1)\times(n+1)}</script> <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-75-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 583.5 748.103370696049" style="width: 1.39ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BB"></use></g></svg></span><script type="math/tex" id="MathJax-Element-75">\lambda</script>是正则化参数 <br>
保证可逆</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="43pb" id="正则化逻辑回归">正则化逻辑回归</h4><ul data-anchor-id="t9g0">
<li><p>损失函数 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-76-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 31509.746513295133 2939.3218947375453" style="width: 73.205ex; height: 6.834ex; vertical-align: -3.243ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><use xlink:href="#MJMAIN-2212" x="3216" y="0"></use><g transform="translate(3994,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5399,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><g transform="translate(7010,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMATHI-6C" x="8405" y="0"></use><use xlink:href="#MJMATHI-6F" x="8704" y="0"></use><use xlink:href="#MJMATHI-67" x="9189" y="0"></use><use xlink:href="#MJMAIN-28" x="9670" y="0"></use><g transform="translate(10059,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="11068" y="0"></use><g transform="translate(11457,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="12925" y="0"></use><use xlink:href="#MJMAIN-29" x="13314" y="0"></use><use xlink:href="#MJMAIN-2B" x="13926" y="0"></use><use xlink:href="#MJMAIN-28" x="14927" y="0"></use><use xlink:href="#MJMAIN-31" x="15316" y="0"></use><use xlink:href="#MJMAIN-2212" x="16039" y="0"></use><g transform="translate(17040,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="18434" y="0"></use><use xlink:href="#MJMATHI-6C" x="18824" y="0"></use><use xlink:href="#MJMATHI-6F" x="19122" y="0"></use><use xlink:href="#MJMATHI-67" x="19608" y="0"></use><use xlink:href="#MJMAIN-28" x="20088" y="0"></use><use xlink:href="#MJMAIN-31" x="20478" y="0"></use><use xlink:href="#MJMAIN-2212" x="21201" y="0"></use><g transform="translate(22201,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="23210" y="0"></use><g transform="translate(23599,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="25067" y="0"></use><use xlink:href="#MJMAIN-29" x="25457" y="0"></use><use xlink:href="#MJMAIN-2B" x="26068" y="0"></use><g transform="translate(27069,0)"><g transform="translate(120,0)"><rect stroke="none" width="1499" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3BB" x="457" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g></g><g transform="translate(28975,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><g transform="translate(30586,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="663" y="488"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-430"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-76">J(\theta) = -{1 \over m}\sum_{i=1}^m y^{(i)}log(h_\theta(x^{(i)})) + (1-y^{(i)})log(1-h_\theta(x^{(i)})) + {\lambda \over 2m}\sum_{j=1}^n \theta_j^2</script> <br>
明确排除偏项(bias term) <span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-77-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 923.406943983867 912.3668266633396" style="width: 2.201ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-77">\theta_0</script> <br>
平方保证是非负</p></li>
<li><p>梯度下降 <br>
跟上文一样</p></li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="84w7" id="初始全一特征向量">初始全一特征向量</h3><div class="md-section-divider"></div><h4 data-anchor-id="2su8" id="常量特征">常量特征</h4><p data-anchor-id="uoxy">在训练开始之前，加一个常量特征到特征集中是很重要的。这个特征一般是一个全1的集合。 <br>
例如，当特征矩阵是X时，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-78-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.0516853480245 1282.406943983867 890.3668266633396" style="width: 3.012ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-58"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="1171" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-78">X_0</script>就是全一向量。</p><p data-anchor-id="ib45">解释：</p><ol data-anchor-id="gj2e">
<li>电子工程的角度：交流电和直流电 <br>
非常量特征捕捉模型中的动态特征，由于输入改变导致的输出变化，相当于DC交流电。 <br>
常量特征代表不变部分，就像交流电的直流部分。 <br>
而对时序信号做微分就能清除模型中的静态部分。</li>
<li>几何角度 <br>
不是所有直线都会经过原点，因此y=ax+b中的b有存在的必要</li>
<li>实际情况 <br>
有常量特征和没有常量特征的训练结果相差一个常数。 <br>
例如用两套模型（一套有常量特征，一套没有）预测房子A和房子B的价格，两套模型的预测结果可能完全不一样，但是房子A和B的价格差值是一样的。 <br>
偏项是当输入全为零时的稳态，代表模型固有的偏差，其他特征产生张力来移动这个偏差位置。</li>
</ol><div class="md-section-divider"></div><h2 data-anchor-id="s22x" id="第四周">第四周</h2><p data-anchor-id="gmsf">神经网络之表示</p><div class="md-section-divider"></div><h3 data-anchor-id="0v3d" id="非线性假设">非线性假设</h3><p data-anchor-id="s1br">线性回归很少见 <br>
有若干个变量，两两相乘组成一个多项式，配以相关系数，加上常数项，外面套一个函数，形成假设函数。 <br>
如果变量一多，这种方法会产生大量特征，不实际。</p><div class="md-section-divider"></div><h3 data-anchor-id="3kg9" id="神经元和大脑">神经元和大脑</h3><p data-anchor-id="57ml">神经网络是对我们大脑工作原理的有限模拟。它们最近经历了一个很大的复兴，因为计算机硬件的发展。 <br>
大脑只用一种学习算法来完成不同函数。这个准则就是“神经可塑性”。</p><div class="md-section-divider"></div><h3 data-anchor-id="v5b3" id="模型表示">模型表示</h3><ul data-anchor-id="9j8g">
<li>输入层</li>
<li>隐藏层</li>
<li>输出层</li>
<li>偏移单元（bias unit）</li>
<li>激活函数</li>
<li>激活单元：隐藏层节点 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-79-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 29124.733899613897 4803.69701768361" style="width: 67.645ex; height: 11.12ex; vertical-align: -8.803ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(6561,0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="748" y="-430"></use><use xlink:href="#MJMAIN-3D" x="1749" y="0"></use><g transform="translate(2806,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-6A" x="3604" y="0"></use><g transform="translate(4016,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">层</text></g><g transform="translate(4814,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-69" x="5612" y="0"></use><g transform="translate(5957,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">个</text></g><g transform="translate(6755,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">节</text></g><g transform="translate(7553,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">点</text></g><g transform="translate(8351,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(9149,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">激</text></g><g transform="translate(9947,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">活</text></g><use xlink:href="#MJMAIN-28" x="10745" y="0"></use><use xlink:href="#MJMATHI-61" x="11135" y="0"></use><use xlink:href="#MJMATHI-63" x="11664" y="0"></use><use xlink:href="#MJMATHI-74" x="12098" y="0"></use><use xlink:href="#MJMATHI-69" x="12459" y="0"></use><use xlink:href="#MJMATHI-76" x="12805" y="0"></use><use xlink:href="#MJMATHI-61" x="13290" y="0"></use><use xlink:href="#MJMATHI-74" x="13820" y="0"></use><use xlink:href="#MJMATHI-69" x="14181" y="0"></use><use xlink:href="#MJMATHI-6F" x="14527" y="0"></use><use xlink:href="#MJMATHI-6E" x="15012" y="0"></use><use xlink:href="#MJMAIN-29" x="15613" y="0"></use></g><g transform="translate(5132,-1687)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1689" y="0"></use><g transform="translate(2746,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">控</text></g><g transform="translate(3544,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">制</text></g><g transform="translate(4341,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">函</text></g><g transform="translate(5139,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g><g transform="translate(5937,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">从</text></g><g transform="translate(6735,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-6A" x="7533" y="0"></use><g transform="translate(7946,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">层</text></g><g transform="translate(8744,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">映</text></g><g transform="translate(9542,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">射</text></g><g transform="translate(10340,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">到</text></g><g transform="translate(11137,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-6A" x="11935" y="0"></use><use xlink:href="#MJMAIN-2B" x="12570" y="0"></use><use xlink:href="#MJMAIN-31" x="13571" y="0"></use><g transform="translate(14071,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">层</text></g><g transform="translate(14869,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(15667,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">权</text></g><g transform="translate(16465,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">重</text></g><g transform="translate(17263,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">矩</text></g><g transform="translate(18061,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">阵</text></g></g><g transform="translate(3901,-3376)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g><g transform="translate(469,-327)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="345" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1689" y="0"></use><g transform="translate(2746,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-6A" x="3544" y="0"></use><g transform="translate(3956,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">层</text></g><g transform="translate(4754,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-6B" x="5552" y="0"></use><g transform="translate(6073,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">个</text></g><g transform="translate(6871,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">特</text></g><g transform="translate(7669,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">征</text></g><g transform="translate(8467,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">映</text></g><g transform="translate(9265,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">射</text></g><g transform="translate(10063,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">到</text></g><g transform="translate(10861,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-6A" x="11659" y="0"></use><use xlink:href="#MJMAIN-2B" x="12294" y="0"></use><use xlink:href="#MJMAIN-31" x="13294" y="0"></use><g transform="translate(13795,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">层</text></g><g transform="translate(14593,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">第</text></g><use xlink:href="#MJMATHI-69" x="15391" y="0"></use><g transform="translate(15736,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">个</text></g><g transform="translate(16534,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">激</text></g><g transform="translate(17332,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">活</text></g><g transform="translate(18130,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">点</text></g><g transform="translate(18928,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(19726,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">权</text></g><g transform="translate(20524,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">值</text></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-79">a_i^{(j)} = 第j层第i个节点的激活(activation) \\
\theta^{(j)} = 控制函数从第j层映射到第j+1层的权重矩阵\\
\theta_{ik}^{(j)} = 第j层第k个特征映射到第j+1层第i个激活点的权值</script></li>
</ul><p data-anchor-id="72wy">权重矩阵的维度是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-80-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 6454.141556505386 1086.0602608392912" style="width: 14.942ex; height: 2.548ex; vertical-align: -0.811ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-64"></use><g transform="translate(520,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><use xlink:href="#MJMAIN-D7" x="2038" y="0"></use><use xlink:href="#MJMAIN-28" x="3039" y="0"></use><g transform="translate(3429,0)"><use xlink:href="#MJMATHI-64"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="736" y="-213"></use></g><use xlink:href="#MJMAIN-2B" x="4563" y="0"></use><use xlink:href="#MJMAIN-31" x="5564" y="0"></use><use xlink:href="#MJMAIN-29" x="6064" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-80">d_{j+1}\times (d_j+1)</script> <br>
其中+1来自偏移单元<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-81-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -852.3985643667423 923.406943983867 1321.0686290035035" style="width: 2.201ex; height: 3.012ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="663" y="510"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-430"></use></g></svg></span><script type="math/tex" id="MathJax-Element-81">\theta_j^{0}</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-82-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 1026.406943983867 649.3668266633396" style="width: 2.432ex; height: 1.506ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="809" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-82">x_0</script>。 <br>
输入包含偏移单元，而输出不包含。</p><div class="md-section-divider"></div><h3 data-anchor-id="xyb8" id="向量表示">向量表示</h3><p data-anchor-id="wnzy">令输入层n+1维向量<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-83-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 3440.798682083743 946.0325633671463" style="width: 7.992ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><use xlink:href="#MJMAIN-3D" x="850" y="0"></use><g transform="translate(1906,0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-83">x = a^{(1)}</script>，那么 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-84-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -963.9808780191219 7438.837891182058 996.0325633671463" style="width: 17.259ex; height: 2.317ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-7A"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1689" y="0"></use><g transform="translate(2746,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212" x="802" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1580" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="2081" y="0"></use></g></g><g transform="translate(5062,0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212" x="802" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1580" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="2081" y="0"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-84">z^{(j)} = \theta^{(j-1)}a^{(j-1)}</script> <br>
其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-85-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 2316.4073029213655 945.0325633671463" style="width: 5.328ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212" x="802" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1580" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="2081" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-85">\theta^{(j-1)}</script>维度是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-86-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 4926.388888888889 1042.103370696049" style="width: 11.467ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E"></use><use xlink:href="#MJMAIN-D7" x="822" y="0"></use><use xlink:href="#MJMAIN-28" x="1823" y="0"></use><use xlink:href="#MJMATHI-6E" x="2212" y="0"></use><use xlink:href="#MJMAIN-2B" x="3035" y="0"></use><use xlink:href="#MJMAIN-31" x="4036" y="0"></use><use xlink:href="#MJMAIN-29" x="4536" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-86">n\times (n+1)</script>，z^{(j)}是n维向量 <br>
然后<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-87-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -963.9808780191219 5477.541015123098 1235.0325633671464" style="width: 12.741ex; height: 2.896ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1749" y="0"></use><use xlink:href="#MJMATHI-67" x="2806" y="0"></use><use xlink:href="#MJMAIN-28" x="3286" y="0"></use><g transform="translate(3676,0)"><use xlink:href="#MJMATHI-7A"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="5088" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-87">a^{(j)} = g(z^{(j)}) </script> <br>
其中g作用于每个元素 <br>
最后增加一个<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-88-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 3306.573285339327 1416.5280444636876" style="width: 7.645ex; height: 3.243ex; vertical-align: -0.927ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="748" y="-435"></use><use xlink:href="#MJMAIN-3D" x="1749" y="0"></use><use xlink:href="#MJMAIN-31" x="2806" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-88">a_0^{(j)}=1</script>到<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-89-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1472.0177297837713 945.0325633671463" style="width: 3.475ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-89">a^{(j)}</script>当中，继续重复计算 <br>
直到最后一层，输出一个值，情况跟逻辑斯特回归一样。</p><div class="md-section-divider"></div><h3 data-anchor-id="9zcd" id="多元分类">多元分类</h3><p data-anchor-id="axcr">输出层是一个由0和1组成的向量，1表示属于该分类。</p><div class="md-section-divider"></div><h2 data-anchor-id="fakm" id="第五周">第五周</h2><p data-anchor-id="3v7i">神经网络之学习</p><div class="md-section-divider"></div><h3 data-anchor-id="dtq4" id="损失函数-4">损失函数</h3><p data-anchor-id="jr9w">定义： <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-90-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.0516853480245 681.5 727.103370696049" style="width: 1.622ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4C"></use></g></svg></span><script type="math/tex" id="MathJax-Element-90">L</script>是网络总层数 <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-91-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.0516853480245 780.5713741841845 643.295758851474" style="width: 1.853ex; height: 1.506ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="663" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-91">s_l</script>是第l层除去偏移单元之外的节点数 <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-92-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.0516853480245 889.5 725.103370696049" style="width: 2.085ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4B"></use></g></svg></span><script type="math/tex" id="MathJax-Element-92">K</script>是输出节点数，即分类数 <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-93-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 2828.7428201558687 1042.103370696049" style="width: 6.602ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use><use xlink:href="#MJMAIN-28" x="1008" y="0"></use><use xlink:href="#MJMATHI-78" x="1397" y="0"></use><g transform="translate(1970,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="550" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-93">h_{\theta}(x)_k</script>是产生第k个输出的假设</p><p data-anchor-id="55eh">假设函数： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-94-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1766.3689255774339 39157.16999449119 3120.6837241201274" style="width: 90.927ex; height: 7.297ex; vertical-align: -3.243ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><use xlink:href="#MJMAIN-2212" x="3216" y="0"></use><g transform="translate(3994,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5399,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><g transform="translate(7010,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(85,-1110)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1300" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-4B" x="576" y="1627"></use></g><use xlink:href="#MJMAIN-5B" x="8455" y="0"></use><g transform="translate(8733,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="693" y="-463"></use></g><use xlink:href="#MJMATHI-6C" x="10128" y="0"></use><use xlink:href="#MJMATHI-6F" x="10427" y="0"></use><use xlink:href="#MJMATHI-67" x="10912" y="0"></use><use xlink:href="#MJMAIN-28" x="11393" y="0"></use><g transform="translate(11782,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="12791" y="0"></use><g transform="translate(13180,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><g transform="translate(14648,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="550" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="15506" y="0"></use><use xlink:href="#MJMAIN-2B" x="16118" y="0"></use><use xlink:href="#MJMAIN-28" x="17119" y="0"></use><use xlink:href="#MJMAIN-31" x="17508" y="0"></use><use xlink:href="#MJMAIN-2212" x="18231" y="0"></use><g transform="translate(19231,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="693" y="-463"></use></g><use xlink:href="#MJMAIN-29" x="20626" y="0"></use><use xlink:href="#MJMATHI-6C" x="21016" y="0"></use><use xlink:href="#MJMATHI-6F" x="21314" y="0"></use><use xlink:href="#MJMATHI-67" x="21800" y="0"></use><use xlink:href="#MJMAIN-28" x="22280" y="0"></use><use xlink:href="#MJMAIN-31" x="22670" y="0"></use><use xlink:href="#MJMAIN-2212" x="23392" y="0"></use><g transform="translate(24393,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="25402" y="0"></use><g transform="translate(25791,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><g transform="translate(27259,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="550" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="28117" y="0"></use><use xlink:href="#MJMAIN-5D" x="28507" y="0"></use><use xlink:href="#MJMAIN-2B" x="29007" y="0"></use><g transform="translate(30008,0)"><g transform="translate(120,0)"><rect stroke="none" width="1499" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3BB" x="457" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g></g><g transform="translate(31914,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(164,-1110)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="298" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1077" y="0"></use></g><g transform="translate(29,1151)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-4C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212" x="681" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1460" y="0"></use></g></g><g transform="translate(33525,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><g transform="translate(446,1174)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-73"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6C" x="663" y="-213"></use></g></g><g transform="translate(35136,0)"><use xlink:href="#MJSZ2-2211" x="5" y="0"></use><g transform="translate(130,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><g transform="translate(0,1174)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-73"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6C" x="663" y="-213"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="780" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1559" y="0"></use></g></g><use xlink:href="#MJMAIN-28" x="36592" y="0"></use><g transform="translate(36982,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(469,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="691" y="0"></use></g></g><g transform="translate(38313,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-94">J(\theta) = -{1\over m}\sum_{i=1}^m\sum_{k=1}^K[y_k^{(i)}log(h_{\theta}(x^{(i)})_k) + (1-y_k^{(i)})log(1-h_{\theta}(x^{(i)})_k)] + {\lambda \over 2m}\sum_{l=1}^{L-1}\sum_{i=1}^{s_l}\sum_{j=1}^{s_l+1}(\theta_{j,i}^{(l)})^2</script></p><p data-anchor-id="tzws">对所有样本的所有输出节点求和。 <br>
正则化项对把所有参数平方求和。</p><div class="md-section-divider"></div><h3 data-anchor-id="8ysg" id="backpropagation算法">Backpropagation算法</h3><p data-anchor-id="99mk">用来最小化损失函数的算法 <br>
给定训练集<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-95-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 10092.178566023114 1185.0325633671464" style="width: 23.398ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28"></use><g transform="translate(389,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="1966" y="0"></use><g transform="translate(2411,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><use xlink:href="#MJMAIN-2E" x="3916" y="0"></use><use xlink:href="#MJMAIN-2E" x="4361" y="0"></use><use xlink:href="#MJMAIN-2E" x="4806" y="0"></use><use xlink:href="#MJMAIN-28" x="5251" y="0"></use><g transform="translate(5641,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1268" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="7485" y="0"></use><g transform="translate(7930,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1268" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="9702" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-95">{(x^{(1)},y^{(1)}...(x^{(m)},y^{(m)})}</script></p><ul data-anchor-id="b82d">
<li><p>设定<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-96-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 1695.407556728505 1541.6859447337067" style="width: 3.938ex; height: 3.591ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-394"></use><g transform="translate(833,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(833,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-96">\Delta_{i,j}^{(l)}</script>初始值为0 <br>
对于从1到m的第t个训练样本：</p></li>
<li><p>令<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-97-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 4625.753966027001 946.0325633671463" style="width: 10.772ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><g transform="translate(1812,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(3146,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="751" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-97">a^{(1)}:=x^{(t)}</script></p></li>
<li>执行forward propagation计算<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1391.407556728505 945.0325633671463" style="width: 3.243ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-98">a^{(l)}</script>（l=2,3...L）</li>
<li>计算<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-99-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 7454.25181773615 1140.0325633671464" style="width: 17.259ex; height: 2.664ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-4C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1071" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1864" y="0"></use><g transform="translate(2920,0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-4C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1071" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="4804" y="0"></use><g transform="translate(5805,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1094" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-99">\delta^{(L)}=a^{(L)}-y^{(T)}</script></li>
<li>使用<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-100-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 15804.539314653823 1185.0325633671464" style="width: 36.718ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-4C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1071" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1864" y="0"></use><use xlink:href="#MJMAIN-28" x="2920" y="0"></use><use xlink:href="#MJMAIN-28" x="3309" y="0"></use><g transform="translate(3699,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g><g transform="translate(5030,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="513"></use></g><g transform="translate(6018,0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="688" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1466" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1966" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="8238" y="0"></use><use xlink:href="#MJMAIN-2E" x="8627" y="0"></use><use xlink:href="#MJMAIN-2217" x="9073" y="0"></use><g transform="translate(9573,0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g><use xlink:href="#MJMAIN-2E" x="10965" y="0"></use><use xlink:href="#MJMAIN-2217" x="11410" y="0"></use><use xlink:href="#MJMAIN-28" x="11910" y="0"></use><use xlink:href="#MJMAIN-31" x="12300" y="0"></use><use xlink:href="#MJMAIN-2212" x="13022" y="0"></use><g transform="translate(14023,0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="15415" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-100">\delta^{(L)}=((\theta^{(l)})^T\delta^{(l+1)}).*a^{(l)}.*(1-a^{(l)})</script>计算<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-101-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 8220.597847315948 1130.0325633671464" style="width: 19.112ex; height: 2.664ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-4C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212" x="1071" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1849" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="2350" y="0"></use></g><use xlink:href="#MJMAIN-2C" x="2490" y="0"></use><g transform="translate(2935,0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-4C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212" x="1071" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="1849" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="2350" y="0"></use></g></g><use xlink:href="#MJMAIN-2E" x="5426" y="0"></use><use xlink:href="#MJMAIN-2E" x="5871" y="0"></use><use xlink:href="#MJMAIN-2E" x="6317" y="0"></use><g transform="translate(6762,0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-101">\delta^{(L-1)},\delta^{(L-2)}...\delta^{(2)}</script></li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-102-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 9837.669800051615 1541.6859447337067" style="width: 22.819ex; height: 3.591ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-394"></use><g transform="translate(833,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(833,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g><g transform="translate(1973,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(3307,0)"><use xlink:href="#MJMAIN-394"></use><g transform="translate(833,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(833,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="5225" y="0"></use><g transform="translate(6226,0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="748" y="-430"></use></g><g transform="translate(7617,0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="688" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1466" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1966" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="628" y="-430"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-102">\Delta_{i,j}^{(l)}:=\Delta_{i,j}^{(l)}+a_j^{(l)}\delta_i^{(l+1)}</script> 或者向量形式<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-103-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 11214.826527397538 1185.0325633671464" style="width: 26.062ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-394"></use><g transform="translate(833,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(1973,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(3307,0)"><use xlink:href="#MJMAIN-394"></use><g transform="translate(833,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="5225" y="0"></use><g transform="translate(6226,0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="688" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1466" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1966" y="0"></use></g></g><use xlink:href="#MJMAIN-28" x="8446" y="0"></use><g transform="translate(8835,0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g><g transform="translate(10227,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="513"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-103">\Delta^{(l)}:=\Delta^{(l)}+\delta^{(l+1)}(a^{(l)})^T</script></li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-104-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 9516.565977457898 1541.6859447337067" style="width: 22.124ex; height: 3.591ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-44"></use><g transform="translate(828,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(828,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g><g transform="translate(1968,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(3302,0)"><g transform="translate(120,0)"><rect stroke="none" width="741" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="273" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="84" y="-488"></use></g></g><use xlink:href="#MJMAIN-28" x="4284" y="0"></use><g transform="translate(4673,0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="6211" y="0"></use><use xlink:href="#MJMATHI-3BB" x="7212" y="0"></use><g transform="translate(7795,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(469,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="9127" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-104">D_{i,j}^{(l)}:={1\over m}(\delta_{i,j}^{(l)}+\lambda\theta_{i,j}^{(l)})</script> if j!=0</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-105-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 5599.713976284947 1541.6859447337067" style="width: 12.973ex; height: 3.591ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-44"></use><g transform="translate(828,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(828,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g><g transform="translate(1968,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(3302,0)"><g transform="translate(120,0)"><rect stroke="none" width="741" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="273" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="84" y="-488"></use></g></g><g transform="translate(4284,0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-105">D_{i,j}^{(l)}:={1\over m}\delta_{i,j}^{(l)}</script> if j=0</li>
</ul><p data-anchor-id="4st3">说明： <br>
1. <span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-106-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 1315.557556728505 1541.6859447337067" style="width: 3.012ex; height: 3.591ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="628" y="-430"></use></g></svg></span><script type="math/tex" id="MathJax-Element-106">\delta_j^{(l)}</script>代表第l层第j个节点的“误差” <br>
2. <span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-107-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -737.0516853480245 833.5 758.103370696049" style="width: 1.969ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-394"></use></g></svg></span><script type="math/tex" id="MathJax-Element-107">\Delta</script>作为一个“误差累加器”，累计所有层误差以激活为权重的和 <br>
3. <span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-108-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 1690.407556728505 1541.6859447337067" style="width: 3.938ex; height: 3.591ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-44"></use><g transform="translate(828,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(828,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-108">D_{i,j}^{(l)}</script>是把<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-109-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -737.0516853480245 833.5 758.103370696049" style="width: 1.969ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-394"></use></g></svg></span><script type="math/tex" id="MathJax-Element-109">\Delta</script>经过正则化、取平均后的结果，表示损失函数对<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-110-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-110">\theta</script>的偏导数 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-111-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 15408.617255654068 3071.3191548083328" style="width: 35.792ex; height: 7.181ex; vertical-align: -3.591ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-44"></use><g transform="translate(828,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(828,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1968" y="0"></use><g transform="translate(3024,0)"><g transform="translate(120,0)"><rect stroke="none" width="2569" height="60" x="0" y="220"></rect><g transform="translate(60,715)"><use xlink:href="#MJMAIN-2202"></use><use xlink:href="#MJMATHI-4A" x="567" y="0"></use><use xlink:href="#MJMAIN-28" x="1201" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1590" y="0"></use><use xlink:href="#MJMAIN-29" x="2060" y="0"></use></g><g transform="translate(335,-1018)"><use xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(469,-304)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g></g></g></g><use xlink:href="#MJMAIN-3D" x="6111" y="0"></use><g transform="translate(7168,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(8573,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(142,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1140" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><g transform="translate(10184,0)"><use xlink:href="#MJMATHI-61"></use><g transform="translate(529,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="751" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="1140" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="1530" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1828" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="748" y="-430"></use></g><g transform="translate(12382,0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="751" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="1140" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="1530" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="1828" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="2607" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="3107" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="628" y="-430"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-111">D_{i,j}^{(l)} = {\partial J(\theta) \over \partial \theta_{i,j}^{(l)}} = {1\over m}\sum_{t=1}^m a_j^{(t)(l)}\delta_{i}^{(t)(l+1)}</script></p><div class="md-section-divider"></div><h3 data-anchor-id="wuer" id="直觉理解">直觉理解</h3><p data-anchor-id="7ayy">当输出只有一个节点时，第t个样本的损失是 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-112-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -963.9808780191219 30371.51189189189 2860.515756038243" style="width: 70.541ex; height: 6.602ex; vertical-align: -4.517ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(3633,0)"><use xlink:href="#MJMATHI-63"></use><use xlink:href="#MJMATHI-6F" x="433" y="0"></use><use xlink:href="#MJMATHI-73" x="919" y="0"></use><use xlink:href="#MJMATHI-74" x="1388" y="0"></use><use xlink:href="#MJMAIN-28" x="1750" y="0"></use><use xlink:href="#MJMATHI-74" x="2139" y="0"></use><use xlink:href="#MJMAIN-29" x="2501" y="0"></use><use xlink:href="#MJMAIN-3D" x="3168" y="0"></use><g transform="translate(4224,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="751" y="0"></use></g></g><use xlink:href="#MJMATHI-6C" x="5630" y="0"></use><use xlink:href="#MJMATHI-6F" x="5929" y="0"></use><use xlink:href="#MJMATHI-67" x="6414" y="0"></use><use xlink:href="#MJMAIN-28" x="6895" y="0"></use><g transform="translate(7284,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="8293" y="0"></use><g transform="translate(8682,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="751" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="10161" y="0"></use><use xlink:href="#MJMAIN-29" x="10551" y="0"></use><use xlink:href="#MJMAIN-2B" x="11162" y="0"></use><use xlink:href="#MJMAIN-28" x="12163" y="0"></use><use xlink:href="#MJMAIN-31" x="12553" y="0"></use><use xlink:href="#MJMAIN-2212" x="13275" y="0"></use><g transform="translate(14276,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="751" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="15682" y="0"></use><use xlink:href="#MJMATHI-6C" x="16072" y="0"></use><use xlink:href="#MJMATHI-6F" x="16370" y="0"></use><use xlink:href="#MJMATHI-67" x="16856" y="0"></use><use xlink:href="#MJMAIN-28" x="17336" y="0"></use><use xlink:href="#MJMAIN-31" x="17726" y="0"></use><use xlink:href="#MJMAIN-2212" x="18448" y="0"></use><g transform="translate(19449,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="20458" y="0"></use><g transform="translate(20847,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="751" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="22326" y="0"></use><use xlink:href="#MJMAIN-29" x="22715" y="0"></use></g><g transform="translate(10954,-1626)"><use xlink:href="#MJMAIN-2248" x="277" y="0"></use><use xlink:href="#MJMAIN-28" x="1334" y="0"></use><g transform="translate(1723,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="2732" y="0"></use><g transform="translate(3121,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="751" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="4600" y="0"></use><use xlink:href="#MJMAIN-2212" x="5212" y="0"></use><g transform="translate(6212,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="751" y="0"></use></g></g><g transform="translate(7619,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-112">cost(t) = y^{(t)}log(h_{\theta}(x^{(t)}))+(1-y^{(t)})log(1-h_{\theta}(x^{(t)})) \\
\approx (h_{\theta}(x^{(t)})-y^{(t)})^2</script> <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-113-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1412.5596853480245 7798.970669012566 2898.8717439615057" style="width: 18.069ex; height: 6.718ex; vertical-align: -3.591ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="628" y="-430"></use><use xlink:href="#MJMAIN-3D" x="1593" y="0"></use><g transform="translate(2649,0)"><g transform="translate(120,0)"><rect stroke="none" width="2018" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-2202" x="725" y="676"></use><g transform="translate(60,-1018)"><use xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xlink:href="#MJMATHI-7A"></use><g transform="translate(469,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="658" y="-430"></use></g></g></g></g><use xlink:href="#MJMATHI-63" x="4908" y="0"></use><use xlink:href="#MJMATHI-6F" x="5341" y="0"></use><use xlink:href="#MJMATHI-73" x="5827" y="0"></use><use xlink:href="#MJMATHI-74" x="6296" y="0"></use><use xlink:href="#MJMAIN-28" x="6658" y="0"></use><use xlink:href="#MJMATHI-74" x="7047" y="0"></use><use xlink:href="#MJMAIN-29" x="7409" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-113">\delta_j^{(l)} = {\partial\over \partial z_j^{(l)}}cost(t)</script></p><div class="md-section-divider"></div><h3 data-anchor-id="la0s" id="展开参数">展开参数</h3><p data-anchor-id="pdim">把多个矩阵合成一个矩阵，为了方便调用优化函数 <br>
得到结果后展开</p><div class="md-section-divider"></div><h3 data-anchor-id="q1xb" id="检查梯度">检查梯度</h3><p data-anchor-id="tafr">使用数值方法求一个梯度 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-114-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1530.686374719066 27132.31599611336 2531.6459502103326" style="width: 63.012ex; height: 5.907ex; vertical-align: -2.432ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="1548" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-2202" x="490" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g></g></g><use xlink:href="#MJMATHI-4A" x="1788" y="0"></use><use xlink:href="#MJMAIN-28" x="2422" y="0"></use><use xlink:href="#MJMATHI-3B8" x="2811" y="0"></use><use xlink:href="#MJMAIN-29" x="3281" y="0"></use><use xlink:href="#MJMAIN-2248" x="3948" y="0"></use><g transform="translate(5004,0)"><g transform="translate(120,0)"><rect stroke="none" width="21887" height="60" x="0" y="220"></rect><g transform="translate(60,759)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><g transform="translate(1023,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2C" x="1946" y="0"></use><use xlink:href="#MJMAIN-2E" x="2391" y="0"></use><use xlink:href="#MJMAIN-2E" x="2836" y="0"></use><use xlink:href="#MJMAIN-2E" x="3281" y="0"></use><use xlink:href="#MJMAIN-2C" x="3727" y="0"></use><g transform="translate(4172,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2B" x="5255" y="0"></use><use xlink:href="#MJMATHI-3F5" x="6256" y="0"></use><use xlink:href="#MJMAIN-2C" x="6662" y="0"></use><use xlink:href="#MJMAIN-2E" x="7108" y="0"></use><use xlink:href="#MJMAIN-2E" x="7553" y="0"></use><use xlink:href="#MJMAIN-2E" x="7998" y="0"></use><use xlink:href="#MJMAIN-2C" x="8443" y="0"></use><g transform="translate(8888,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="9882" y="0"></use><use xlink:href="#MJMAIN-2212" x="10494" y="0"></use><use xlink:href="#MJMATHI-4A" x="11495" y="0"></use><use xlink:href="#MJMAIN-28" x="12128" y="0"></use><g transform="translate(12518,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2C" x="13441" y="0"></use><use xlink:href="#MJMAIN-2E" x="13886" y="0"></use><use xlink:href="#MJMAIN-2E" x="14332" y="0"></use><use xlink:href="#MJMAIN-2E" x="14777" y="0"></use><use xlink:href="#MJMAIN-2C" x="15222" y="0"></use><g transform="translate(15667,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="16750" y="0"></use><use xlink:href="#MJMATHI-3F5" x="17751" y="0"></use><use xlink:href="#MJMAIN-2C" x="18158" y="0"></use><use xlink:href="#MJMAIN-2E" x="18603" y="0"></use><use xlink:href="#MJMAIN-2E" x="19048" y="0"></use><use xlink:href="#MJMAIN-2E" x="19493" y="0"></use><use xlink:href="#MJMAIN-2C" x="19938" y="0"></use><g transform="translate(20383,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="21378" y="0"></use></g><g transform="translate(10490,-686)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMATHI-3F5" x="500" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-114">{\partial\over \partial \theta_j}J(\theta) \approx {J(\theta_1,...,\theta_j+\epsilon,...,\theta_n)-J(\theta_1,...,\theta_j-\epsilon,...,\theta_n) \over 2\epsilon}</script> <br>
这招用来验算，很慢</p><div class="md-section-divider"></div><h3 data-anchor-id="0uxb" id="随机初始化">随机初始化</h3><p data-anchor-id="v1qp">如果初始权重全为零，那么所有节点的值将会是相同的。 <br>
所以需要随机初始化。 <br>
一种初始化方法是： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-115-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1602.0596853480245 30371.51189189189 4474.272362594946" style="width: 70.541ex; height: 10.425ex; vertical-align: -6.718ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9034,0)"><use xlink:href="#MJMATHI-3F5"></use><use xlink:href="#MJMAIN-3D" x="684" y="0"></use><g transform="translate(1740,0)"><g transform="translate(120,0)"><rect stroke="none" width="10322" height="60" x="0" y="220"></rect><g transform="translate(4494,676)"><use xlink:href="#MJMAIN-221A" x="0" y="44"></use><rect stroke="none" width="500" height="60" x="833" y="785"></rect><use xlink:href="#MJMAIN-36" x="833" y="0"></use></g><g transform="translate(60,-973)"><use xlink:href="#MJSZ1-221A" x="0" y="96"></use><rect stroke="none" width="9202" height="60" x="1000" y="887"></rect><g transform="translate(1000,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">输</text><g transform="translate(797,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">出</text></g><g transform="translate(1595,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">节</text></g><g transform="translate(2393,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">点</text></g><g transform="translate(3191,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g><use xlink:href="#MJMAIN-2B" x="4211" y="0"></use><g transform="translate(5212,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">输</text></g><g transform="translate(6010,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">出</text></g><g transform="translate(6808,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">节</text></g><g transform="translate(7606,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">点</text></g><g transform="translate(8404,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g></g></g></g></g></g><g transform="translate(1677,-2602)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1609" y="0"></use><use xlink:href="#MJMAIN-32" x="2665" y="0"></use><use xlink:href="#MJMATHI-3F5" x="3165" y="0"></use><use xlink:href="#MJMAIN-2217" x="3794" y="0"></use><use xlink:href="#MJMAIN-28" x="4517" y="0"></use><g transform="translate(4906,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">维</text></g><g transform="translate(5704,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">度</text></g><g transform="translate(6502,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">为</text></g><g transform="translate(7300,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">输</text></g><g transform="translate(8098,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">出</text></g><g transform="translate(8896,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">节</text></g><g transform="translate(9694,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">点</text></g><g transform="translate(10492,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g><use xlink:href="#MJMAIN-D7" x="11512" y="0"></use><use xlink:href="#MJMAIN-28" x="12513" y="0"></use><g transform="translate(12902,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">输</text></g><g transform="translate(13700,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">入</text></g><g transform="translate(14498,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">节</text></g><g transform="translate(15296,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">点</text></g><g transform="translate(16094,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">数</text></g><use xlink:href="#MJMAIN-2B" x="17114" y="0"></use><use xlink:href="#MJMAIN-31" x="18115" y="0"></use><use xlink:href="#MJMAIN-29" x="18615" y="0"></use><g transform="translate(19005,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><use xlink:href="#MJMAIN-30" x="19803" y="0"></use><use xlink:href="#MJMAIN-2212" x="20526" y="0"></use><use xlink:href="#MJMAIN-31" x="21526" y="0"></use><g transform="translate(22027,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">随</text></g><g transform="translate(22825,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">机</text></g><g transform="translate(23623,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">矩</text></g><g transform="translate(24421,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">阵</text></g><use xlink:href="#MJMAIN-29" x="25219" y="0"></use><use xlink:href="#MJMAIN-2212" x="25830" y="0"></use><use xlink:href="#MJMATHI-3F5" x="26609" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-115">\epsilon = {\sqrt{6} \over \sqrt{输出节点数+输出节点数}} \\
\theta^{(l)}=2\epsilon * (维度为输出节点数\times (输入节点数+1)的0-1随机矩阵) - \epsilon</script></p><div class="md-section-divider"></div><h3 data-anchor-id="ngxh" id="设计与训练">设计与训练</h3><p data-anchor-id="ulfg">首先选择一个网络构架</p><ul data-anchor-id="jtfu">
<li>输入节点个数 = 训练样本特征维数</li>
<li>输出节点个数 = 分类数</li>
<li>每个隐藏层的节点个数： 越多越好，但要平衡计算成本</li>
<li>隐藏层个数： 默认1个，多于1个时每层节点个数相同</li>
</ul><p data-anchor-id="mwrh">训练神经网络 <br>
1. 随机初始化权重 <br>
2. 通过forword propagation求得假设函数 <br>
3. 求损失函数 <br>
4. 通过back propagation求偏导 <br>
5. 使用梯度验证确保back propagation有效 <br>
6. 使用梯度下降或者内置优化函数通过权重最小化损失函数</p><p data-anchor-id="ci9s">forword propagation和back propagation在遍历样本的循环中进行。</p><div class="md-section-divider"></div><h3 data-anchor-id="eklr" id="back-propagation公式推导">back propagation公式推导</h3><p data-anchor-id="6wra"><img src="https://github.com/FengZiYjun/Markdown-Notes/blob/master/image/backpropagation.png" alt="" title=""> <br>
<a href="https://github.com/FengZiYjun/Markdown-Notes/blob/master/image/backpropagation.png" target="_blank">https://github.com/FengZiYjun/Markdown-Notes/blob/master/image/backpropagation.png</a></p><div class="md-section-divider"></div><h2 data-anchor-id="czf8" id="第六周">第六周</h2><p data-anchor-id="fbes">应用机器学习的建议</p><div class="md-section-divider"></div><h3 data-anchor-id="nsq1" id="排除预测误差的手段">排除预测误差的手段：</h3><ul data-anchor-id="dl18">
<li>使用更多训练样本</li>
<li>采用更小的特征集</li>
<li>增加特征</li>
<li>尝试多项式特征</li>
<li>改变正则化参数</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="1clj" id="评价假设">评价假设</h3><p data-anchor-id="yn9z">把数据集分为<strong>训练集</strong>和<strong>测试集</strong>：</p><ul data-anchor-id="zp7b">
<li>使用训练集学习参数并最小化损失函数</li>
<li>计算测试集误差，即测试集中的损失函数值</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="1jma" id="测试集误差">测试集误差</h4><ol data-anchor-id="ttnf">
<li>线性回归 <br>
误差平方求和取平均</li>
<li>分类误差 <br>
正确分类给个1，错误分类给个0，求和取平均</li>
</ol><div class="md-section-divider"></div><h3 data-anchor-id="3so6" id="模型选择">模型选择</h3><ul data-anchor-id="kgis">
<li>一个学习算法很好地拟合一个训练集，不意味这是一个好的假设</li>
<li>用来训练参数的数据集得到的误差小于其他数据集</li>
</ul><p data-anchor-id="8zhw">为了选择最好的模型，需要检查每个多项式的次数和误差结果</p><div class="md-section-divider"></div><h4 data-anchor-id="p98c" id="使用交叉验证集cross-validation-set">使用交叉验证集(cross validation set)</h4><p data-anchor-id="45i2">用来作为一个训练多项式次数的中间数据集</p><p data-anchor-id="sxpj">划分数据集的例子：</p><ul data-anchor-id="mxoe">
<li>训练集：60%</li>
<li>交叉验证集：20%</li>
<li>测试集：20%</li>
</ul><p data-anchor-id="94dc">（从不同次数的多项式中选择最合适的） <br>
1. 对每个多项式次数使用训练集优化参数 <br>
2. 使用交叉验证集找出误差最小的多项式次数 <br>
3. 使用测试集把误差最小的多项式次数代入损失函数，估计总的误差</p><div class="md-section-divider"></div><h3 data-anchor-id="w8j6" id="诊断偏差或方差bias-vs-variance">诊断偏差或方差(bias vs. variance)</h3><ul data-anchor-id="npx4">
<li>如何判别bias或者variance导致了不准确的预测？</li>
<li><p>high bias 是欠拟合，high variance 是过拟合，怎样平衡？</p>

<ol><li>随着多项式次数增加，训练误差倾向于减小，而交叉验证误差先减后增。</li>
<li>high bias(underfitting): 次数太小时，训练集和交叉验证集的误差很高，近乎相等。</li>
<li>high variance(overfitting): 次数太大时，训练集误差小，交叉验证集误差大得多。</li></ol></li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="yxwf" id="正则化和biasvariance">正则化和bias/variance</h3><p data-anchor-id="g6aa">考察正则化参数对bias/variance的影响</p><ul data-anchor-id="8o4j">
<li>很大的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-116-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 583.5 748.103370696049" style="width: 1.39ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BB"></use></g></svg></span><script type="math/tex" id="MathJax-Element-116">\lambda</script>:high bias, underfitting，训练集和交叉验证集误差大</li>
<li><p>很小的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-117-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 583.5 748.103370696049" style="width: 1.39ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BB"></use></g></svg></span><script type="math/tex" id="MathJax-Element-117">\lambda</script>:high variance, overfitting, 训练集误差小，交叉验证集误差大</p>

<ol><li>构造一组<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-118-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 583.5 748.103370696049" style="width: 1.39ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BB"></use></g></svg></span><script type="math/tex" id="MathJax-Element-118">\lambda</script></li>
<li>构造一组有变量不同的模型</li>
<li>遍历所有<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-119-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 583.5 748.103370696049" style="width: 1.39ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BB"></use></g></svg></span><script type="math/tex" id="MathJax-Element-119">\lambda</script>，每个<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-120-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 583.5 748.103370696049" style="width: 1.39ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BB"></use></g></svg></span><script type="math/tex" id="MathJax-Element-120">\lambda</script>应用在所有模型中学习<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-121-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-121">\theta</script></li>
<li>使用学到的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-122-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-122">\theta</script>计算交叉验证集误差（不考虑正则化）</li>
<li>选择交叉验证误差最小的那一组<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-123-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 583.5 748.103370696049" style="width: 1.39ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BB"></use></g></svg></span><script type="math/tex" id="MathJax-Element-123">\lambda</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-124-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-124">\theta</script></li>
<li>应用到测试集</li></ol></li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="tsl5" id="学习曲线">学习曲线</h3><ul data-anchor-id="6xsk">
<li>随着训练集增大，误差会增大</li>
<li>训练集增大到一定程度之后，误差值会趋于平滑</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="0n0z" id="high-bias">high bias</h4><p data-anchor-id="i7ip">小训练集：训练集误差小，交叉验证集误差大 <br>
大训练集：都很大，近似相等</p><p data-anchor-id="1990">增加训练样本对high bias于事无补</p><div class="md-section-divider"></div><h4 data-anchor-id="rru7" id="high-variance">high variance</h4><p data-anchor-id="c2ti">小训练集：训练集误差小，交叉验证集误差大 <br>
大训练集：训练集误差增加，交叉验证集误差减小，但差距依然显著</p><p data-anchor-id="l48n">增加训练样本对high variance可能有用</p><div class="md-section-divider"></div><h3 data-anchor-id="hq06" id="总结">总结</h3><p data-anchor-id="3c4n">修补high variance: <br>
1. 增加训练样本 <br>
2. 减少特征 <br>
3. 增大正则化参数</p><p data-anchor-id="mmek">修补high bias: <br>
1. 增加特征 <br>
2. 减小正则化参数</p><div class="md-section-divider"></div><h3 data-anchor-id="zgn3" id="诊断神经网络">诊断神经网络</h3><ul data-anchor-id="j6qp">
<li>参数少的神经网络容易欠拟合，但计算成本低</li>
<li>参数多的神经网络容易欠拟合，但计算成本高，可以增大正则化参数</li>
</ul><p data-anchor-id="3jez">用交叉验证在很多隐藏层上训练网络？</p><div class="md-section-divider"></div><h3 data-anchor-id="65uj" id="模型选择-1">模型选择</h3><p data-anchor-id="y6w9">怎样选择哪个多项式次数？</p><ul data-anchor-id="6edt">
<li>获取更多数据</li>
<li>选择拟合数据最好而且没有过拟合的模型</li>
<li>通过正则化减少过拟合的可能</li>
</ul><p data-anchor-id="fg8z">bias是估计的误差，是期望值和最优值之间的差距 <br>
variance是由于有限数据引起的估计误差</p><div class="md-section-divider"></div><h4 data-anchor-id="0fdl" id="bias-variance权衡">bias-variance权衡：</h4><ul data-anchor-id="9lmb">
<li>复杂模型: 对数据敏感，容易受X的变化影响，high variance, low bias</li>
<li>简单模型：更僵硬，X的变化影响不大，low variance, high bias</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="6nfp" id="正则化的影响">正则化的影响</h4><p data-anchor-id="wscv">正则化参数</p><ul data-anchor-id="qcb7">
<li>小，模型更容易受噪音影响，倾向于过拟合</li>
<li>大，把权重参数的重要性降低，倾向于欠拟合</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="cz8s" id="模型复杂性效应">模型复杂性效应</h4><ul data-anchor-id="gqhr">
<li>低阶多项式，有较低模型复杂度，有high bias和low variance</li>
<li>高阶多项式，有较高模型复杂度，有low bias和high variance</li>
<li>实际上我们需要一个模型，能够很好地抽象泛化也能很好地拟合数据</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="elap" id="进行诊断">进行诊断</h4><ul data-anchor-id="j99z">
<li>获取更多的训练数据能解决high variance，但不是high bias</li>
<li>减少特征能解决high variance但不是high bias</li>
<li>增加特征能解决high bias但不是high variance</li>
<li>增加多项式和特征交叉能解决high bias而不是high variance</li>
<li>使用梯度下降时，减小正则化参数能够解决high bias，增加正则化参数能够解决high variance</li>
<li>使用神经网络时，网络的大小有影响。交叉验证对网络大小的选择有帮助</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="xarc" id="机器学习系统设计">机器学习系统设计</h3><div class="md-section-divider"></div><h3 data-anchor-id="2sci" id="优先处理什么">优先处理什么？</h3><ul data-anchor-id="xav5">
<li>搜集数据</li>
<li>develop sophisticated features</li>
<li>develop算法以不同的方法来处理输入</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="8r54" id="误差分析">误差分析</h3><p data-anchor-id="my3m">解决机器学习问题的推荐方法</p><ul data-anchor-id="4udn">
<li>从一个简单的算法开始，快速实现它，尽早测试</li>
<li>画学习曲线来决定更多数据、更多特征是否有帮助</li>
<li>手动检查交叉验证集的误差</li>
</ul><p data-anchor-id="jov5">误差结果应该是一个单一数值。然而评估算法很难。</p><p data-anchor-id="o1a1">对输入数据的预处理</p><div class="md-section-divider"></div><h3 data-anchor-id="oom9" id="偏类的误差矩阵">偏类的误差矩阵</h3><p data-anchor-id="htde">有时候很难说误差的减少是否真的是算法的改进。 <br>
例如：二元分类中把所有输入都归入一类，会得到低误差，但算法没有改进</p><p data-anchor-id="98la">这就是偏类(skewed class)的情况：当某一个类在整个数据集里非常稀罕 <br>
另一种说法是，数据集中某一类的样本远多于其他类 <br>
这种情况下，我们用准确/回召(Precision/Recall)：</p><table data-anchor-id="5l49" class="table table-striped-white table-bordered">
<thead>
<tr>
 <th>-</th>
 <th>预测真</th>
 <th>预测假</th>
</tr>
</thead>
<tbody><tr>
 <td>实际真</td>
 <td>true positive</td>
 <td>false negative</td>
</tr>
<tr>
 <td>实际假</td>
 <td>false positive</td>
 <td>true negative</td>
</tr>
</tbody></table><p data-anchor-id="svpb">准确率(pricision)：预测为真的样本当中实际为真的比例 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-125-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1358.5596853480245 18359 2270.5623706960487" style="width: 42.625ex; height: 5.328ex; vertical-align: -2.201ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-50"></use><use xlink:href="#MJMATHI-72" x="751" y="0"></use><use xlink:href="#MJMATHI-65" x="1203" y="0"></use><use xlink:href="#MJMATHI-73" x="1669" y="0"></use><use xlink:href="#MJMATHI-69" x="2139" y="0"></use><use xlink:href="#MJMATHI-63" x="2484" y="0"></use><use xlink:href="#MJMATHI-69" x="2918" y="0"></use><use xlink:href="#MJMATHI-6F" x="3263" y="0"></use><use xlink:href="#MJMATHI-6E" x="3749" y="0"></use><use xlink:href="#MJMAIN-3D" x="4627" y="0"></use><g transform="translate(5683,0)"><g transform="translate(120,0)"><rect stroke="none" width="12435" height="60" x="0" y="220"></rect><g transform="translate(3560,676)"><use xlink:href="#MJMATHI-74"></use><use xlink:href="#MJMATHI-72" x="361" y="0"></use><use xlink:href="#MJMATHI-75" x="813" y="0"></use><use xlink:href="#MJMATHI-65" x="1385" y="0"></use><use xlink:href="#MJMATHI-70" x="1852" y="0"></use><use xlink:href="#MJMATHI-6F" x="2355" y="0"></use><use xlink:href="#MJMATHI-73" x="2841" y="0"></use><use xlink:href="#MJMATHI-69" x="3310" y="0"></use><use xlink:href="#MJMATHI-74" x="3656" y="0"></use><use xlink:href="#MJMATHI-69" x="4017" y="0"></use><use xlink:href="#MJMATHI-76" x="4363" y="0"></use><use xlink:href="#MJMATHI-65" x="4848" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="#MJMATHI-74"></use><use xlink:href="#MJMATHI-72" x="361" y="0"></use><use xlink:href="#MJMATHI-75" x="813" y="0"></use><use xlink:href="#MJMATHI-65" x="1385" y="0"></use><use xlink:href="#MJMATHI-70" x="1852" y="0"></use><use xlink:href="#MJMATHI-6F" x="2355" y="0"></use><use xlink:href="#MJMATHI-73" x="2841" y="0"></use><use xlink:href="#MJMATHI-69" x="3310" y="0"></use><use xlink:href="#MJMATHI-74" x="3656" y="0"></use><use xlink:href="#MJMATHI-69" x="4017" y="0"></use><use xlink:href="#MJMATHI-76" x="4363" y="0"></use><use xlink:href="#MJMATHI-65" x="4848" y="0"></use><use xlink:href="#MJMAIN-2B" x="5537" y="0"></use><use xlink:href="#MJMATHI-66" x="6537" y="0"></use><use xlink:href="#MJMATHI-61" x="7088" y="0"></use><use xlink:href="#MJMATHI-6C" x="7617" y="0"></use><use xlink:href="#MJMATHI-73" x="7916" y="0"></use><use xlink:href="#MJMATHI-65" x="8385" y="0"></use><use xlink:href="#MJMATHI-70" x="8852" y="0"></use><use xlink:href="#MJMATHI-6F" x="9355" y="0"></use><use xlink:href="#MJMATHI-73" x="9841" y="0"></use><use xlink:href="#MJMATHI-69" x="10310" y="0"></use><use xlink:href="#MJMATHI-74" x="10656" y="0"></use><use xlink:href="#MJMATHI-69" x="11017" y="0"></use><use xlink:href="#MJMATHI-76" x="11363" y="0"></use><use xlink:href="#MJMATHI-65" x="11848" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-125">Presicion = {true positive \over true positive + false positive}</script> <br>
召回率(Recall):实际为真的样本当中预测为真的比例 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-126-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1358.5596853480245 17068.5 2270.5623706960487" style="width: 39.614ex; height: 5.328ex; vertical-align: -2.201ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-52"></use><use xlink:href="#MJMATHI-65" x="759" y="0"></use><use xlink:href="#MJMATHI-63" x="1226" y="0"></use><use xlink:href="#MJMATHI-61" x="1659" y="0"></use><use xlink:href="#MJMATHI-6C" x="2189" y="0"></use><use xlink:href="#MJMATHI-6C" x="2487" y="0"></use><use xlink:href="#MJMAIN-3D" x="3063" y="0"></use><g transform="translate(4120,0)"><g transform="translate(120,0)"><rect stroke="none" width="12708" height="60" x="0" y="220"></rect><g transform="translate(3696,676)"><use xlink:href="#MJMATHI-74"></use><use xlink:href="#MJMATHI-72" x="361" y="0"></use><use xlink:href="#MJMATHI-75" x="813" y="0"></use><use xlink:href="#MJMATHI-65" x="1385" y="0"></use><use xlink:href="#MJMATHI-70" x="1852" y="0"></use><use xlink:href="#MJMATHI-6F" x="2355" y="0"></use><use xlink:href="#MJMATHI-73" x="2841" y="0"></use><use xlink:href="#MJMATHI-69" x="3310" y="0"></use><use xlink:href="#MJMATHI-74" x="3656" y="0"></use><use xlink:href="#MJMATHI-69" x="4017" y="0"></use><use xlink:href="#MJMATHI-76" x="4363" y="0"></use><use xlink:href="#MJMATHI-65" x="4848" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="#MJMATHI-74"></use><use xlink:href="#MJMATHI-72" x="361" y="0"></use><use xlink:href="#MJMATHI-75" x="813" y="0"></use><use xlink:href="#MJMATHI-65" x="1385" y="0"></use><use xlink:href="#MJMATHI-70" x="1852" y="0"></use><use xlink:href="#MJMATHI-6F" x="2355" y="0"></use><use xlink:href="#MJMATHI-73" x="2841" y="0"></use><use xlink:href="#MJMATHI-69" x="3310" y="0"></use><use xlink:href="#MJMATHI-74" x="3656" y="0"></use><use xlink:href="#MJMATHI-69" x="4017" y="0"></use><use xlink:href="#MJMATHI-76" x="4363" y="0"></use><use xlink:href="#MJMATHI-65" x="4848" y="0"></use><use xlink:href="#MJMAIN-2B" x="5537" y="0"></use><use xlink:href="#MJMATHI-66" x="6537" y="0"></use><use xlink:href="#MJMATHI-61" x="7088" y="0"></use><use xlink:href="#MJMATHI-6C" x="7617" y="0"></use><use xlink:href="#MJMATHI-73" x="7916" y="0"></use><use xlink:href="#MJMATHI-65" x="8385" y="0"></use><use xlink:href="#MJMATHI-6E" x="8852" y="0"></use><use xlink:href="#MJMATHI-65" x="9452" y="0"></use><use xlink:href="#MJMATHI-67" x="9919" y="0"></use><use xlink:href="#MJMATHI-61" x="10399" y="0"></use><use xlink:href="#MJMATHI-74" x="10929" y="0"></use><use xlink:href="#MJMATHI-69" x="11290" y="0"></use><use xlink:href="#MJMATHI-76" x="11636" y="0"></use><use xlink:href="#MJMATHI-65" x="12121" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-126">Recall = {true positive \over true positive + false negative}</script></p><p data-anchor-id="ihiv">好的分类器两者都应该很高</p><div class="md-section-divider"></div><h3 data-anchor-id="1q8y" id="权衡准确率和回召率">权衡准确率和回召率</h3><p data-anchor-id="pa1l">当我们在做逻辑斯特回归时，如果需要一个<strong>确信</strong>的结果，其中一种方法是提高预测为真的阀值 <br>
但这样就会使得准确率很高，但回召率很低 <br>
相反地，如果我们降低阀值，就会得到<strong>安全</strong>的预测，但是回召率很高而准确率很低</p><p data-anchor-id="xdxc">为了把这两种指标合起来，我们采用F值(F value) <br>
而简单地取平均不能反应我们的需求（两个都要高） <br>
所以应该取调和平均数 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-127-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1380.5596853480245 7984.499999999999 2169.5623706960487" style="width: 18.533ex; height: 5.097ex; vertical-align: -1.969ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46"></use><use xlink:href="#MJMATHI-73" x="749" y="0"></use><use xlink:href="#MJMATHI-63" x="1219" y="0"></use><use xlink:href="#MJMATHI-6F" x="1652" y="0"></use><use xlink:href="#MJMATHI-72" x="2138" y="0"></use><use xlink:href="#MJMATHI-65" x="2589" y="0"></use><use xlink:href="#MJMAIN-3D" x="3333" y="0"></use><use xlink:href="#MJMAIN-32" x="4390" y="0"></use><g transform="translate(4890,0)"><g transform="translate(120,0)"><rect stroke="none" width="2853" height="60" x="0" y="220"></rect><g transform="translate(671,676)"><use xlink:href="#MJMATHI-50"></use><use xlink:href="#MJMATHI-52" x="751" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="#MJMATHI-50"></use><use xlink:href="#MJMAIN-2B" x="973" y="0"></use><use xlink:href="#MJMATHI-52" x="1974" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-127">F score = 2{PR \over P+R}</script> <br>
只有P和R都很高时，F才高 <br>
一般利用<strong>交叉验证集</strong>来计算准确率和回召率</p><div class="md-section-divider"></div><h3 data-anchor-id="5r4b" id="机器学习的数据">机器学习的数据</h3><p data-anchor-id="bmgt">训练要用多少数据？ <br>
很多时候，有足够数据的差算法能够胜于不足数据的好算法 <br>
我们必须选择特征来确保有足够的信息（以人类专家的角度来判断？） <br>
大数原理：一个low bias的算法拥有越多数据，越不容易过拟合，在测试集上越准确</p><div class="md-section-divider"></div><h2 data-anchor-id="jjja" id="第七周">第七周</h2><p data-anchor-id="c3th">支持向量机(SVM, support vector machine) <br>
一种监督学习方法，有时更简洁更强大</p><p data-anchor-id="0sn3">在逻辑斯特回归的损失函数当中，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-128-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -895.9073646014878 5110.465564679774 1349.7974852602724" style="width: 11.815ex; height: 3.127ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-2212"></use><use xlink:href="#MJMATHI-6C" x="778" y="0"></use><use xlink:href="#MJMATHI-6F" x="1077" y="0"></use><use xlink:href="#MJMATHI-67" x="1562" y="0"></use><use xlink:href="#MJMAIN-28" x="2043" y="0"></use><g transform="translate(2432,0)"><g transform="translate(120,0)"><rect stroke="none" width="2048" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1198" y="571"></use><g transform="translate(59,-376)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="500" y="0"></use><g transform="translate(904,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-65"></use><g transform="translate(329,204)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-2212"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-7A" x="778" y="0"></use></g></g></g></g></g><use xlink:href="#MJMAIN-29" x="4720" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-128">-log({1\over {1+e^{-z}}})</script>是一条凹曲线，可以用一条折线近似，折线转折点在(1,0) <br>
对另外包含log的一项，同理也可以用折线来近似，转折点在(-1,0) <br>
折线使用分段函数表示，所以原来的损失函数中<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-129-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -716.0516853480245 2043 942.103370696049" style="width: 4.749ex; height: 2.201ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-2212"></use><use xlink:href="#MJMATHI-6C" x="778" y="0"></use><use xlink:href="#MJMATHI-6F" x="1077" y="0"></use><use xlink:href="#MJMATHI-67" x="1562" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-129">-log</script>关于z的函数被替换成分段函数关于<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-130-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -862.3620829925038 3722.7122829014784 894.4137683405282" style="width: 8.687ex; height: 2.085ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-7A"></use><use xlink:href="#MJMAIN-3D" x="746" y="0"></use><g transform="translate(1802,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="513"></use></g><use xlink:href="#MJMATHI-58" x="2870" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-130">z=\theta^TX</script>的函数，分别用<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-131-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -647.0516853480245 2203.9069439838668 833.3668266633396" style="width: 5.097ex; height: 1.969ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-63"></use><use xlink:href="#MJMATHI-6F" x="433" y="0"></use><use xlink:href="#MJMATHI-73" x="919" y="0"></use><g transform="translate(1388,0)"><use xlink:href="#MJMATHI-74"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="511" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-131">cost_0</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-132-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -647.0516853480245 2203.9069439838668 817.8104774772355" style="width: 5.097ex; height: 1.853ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-63"></use><use xlink:href="#MJMATHI-6F" x="433" y="0"></use><use xlink:href="#MJMATHI-73" x="919" y="0"></use><g transform="translate(1388,0)"><use xlink:href="#MJMATHI-74"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="511" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-132">cost_1</script>表示 <br>
由 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-133-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 33330.197444484 2939.3218947375453" style="width: 77.375ex; height: 6.834ex; vertical-align: -3.243ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><use xlink:href="#MJMAIN-2212" x="3216" y="0"></use><g transform="translate(3994,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5399,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><g transform="translate(7010,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMATHI-6C" x="8405" y="0"></use><use xlink:href="#MJMATHI-6F" x="8704" y="0"></use><use xlink:href="#MJMATHI-67" x="9189" y="0"></use><use xlink:href="#MJMAIN-28" x="9670" y="0"></use><g transform="translate(10059,0)"><g transform="translate(120,0)"><rect stroke="none" width="3925" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="1712" y="676"></use><g transform="translate(60,-834)"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-2B" x="722" y="0"></use><g transform="translate(1723,0)"><use xlink:href="#MJMATHI-65"></use><g transform="translate(466,288)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212"></use><g transform="translate(550,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-7A"></use><g transform="translate(331,204)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-29" x="735" y="0"></use></g></g></g></g></g></g></g><use xlink:href="#MJMAIN-29" x="14225" y="0"></use><use xlink:href="#MJMAIN-2B" x="14836" y="0"></use><use xlink:href="#MJMAIN-28" x="15837" y="0"></use><use xlink:href="#MJMAIN-31" x="16226" y="0"></use><use xlink:href="#MJMAIN-2212" x="16949" y="0"></use><g transform="translate(17950,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="19345" y="0"></use><use xlink:href="#MJMATHI-6C" x="19734" y="0"></use><use xlink:href="#MJMATHI-6F" x="20033" y="0"></use><use xlink:href="#MJMATHI-67" x="20518" y="0"></use><use xlink:href="#MJMAIN-28" x="20999" y="0"></use><use xlink:href="#MJMAIN-31" x="21388" y="0"></use><use xlink:href="#MJMAIN-2212" x="22111" y="0"></use><g transform="translate(23112,0)"><g transform="translate(120,0)"><rect stroke="none" width="3925" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="1712" y="676"></use><g transform="translate(60,-834)"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-2B" x="722" y="0"></use><g transform="translate(1723,0)"><use xlink:href="#MJMATHI-65"></use><g transform="translate(466,288)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212"></use><g transform="translate(550,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-7A"></use><g transform="translate(331,204)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-29" x="735" y="0"></use></g></g></g></g></g></g></g><use xlink:href="#MJMAIN-29" x="27277" y="0"></use><use xlink:href="#MJMAIN-2B" x="27889" y="0"></use><g transform="translate(28889,0)"><g transform="translate(120,0)"><rect stroke="none" width="1499" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3BB" x="457" y="676"></use><g transform="translate(60,-686)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g></g><g transform="translate(30795,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><g transform="translate(32406,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="663" y="488"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-430"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-133">J(\theta) = -{1 \over m}\sum_{i=1}^m y^{(i)}log({1\over {1+e^{-z^{(i)}}}}) + (1-y^{(i)})log(1-{1\over {1+e^{-z^{(i)}}}}) + {\lambda \over 2m}\sum_{j=1}^n \theta_j^2</script> <br>
变成 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-134-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 28090.4561439761 2939.3218947375453" style="width: 65.212ex; height: 6.834ex; vertical-align: -3.243ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><use xlink:href="#MJMATHI-43" x="3216" y="0"></use><g transform="translate(4143,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><g transform="translate(5754,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMATHI-63" x="7149" y="0"></use><use xlink:href="#MJMATHI-6F" x="7582" y="0"></use><use xlink:href="#MJMATHI-73" x="8068" y="0"></use><g transform="translate(8537,0)"><use xlink:href="#MJMATHI-74"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="511" y="-213"></use></g><use xlink:href="#MJMAIN-28" x="9353" y="0"></use><g transform="translate(9742,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="583"></use></g><g transform="translate(10810,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="12277" y="0"></use><use xlink:href="#MJMAIN-2B" x="12889" y="0"></use><use xlink:href="#MJMAIN-28" x="13890" y="0"></use><use xlink:href="#MJMAIN-31" x="14279" y="0"></use><use xlink:href="#MJMAIN-2212" x="15002" y="0"></use><g transform="translate(16003,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="17398" y="0"></use><use xlink:href="#MJMATHI-63" x="17787" y="0"></use><use xlink:href="#MJMATHI-6F" x="18221" y="0"></use><use xlink:href="#MJMATHI-73" x="18706" y="0"></use><g transform="translate(19176,0)"><use xlink:href="#MJMATHI-74"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="511" y="-213"></use></g><use xlink:href="#MJMAIN-28" x="19991" y="0"></use><g transform="translate(20380,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="583"></use></g><g transform="translate(21448,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="22916" y="0"></use><use xlink:href="#MJMAIN-2B" x="23527" y="0"></use><g transform="translate(24528,0)"><g transform="translate(120,0)"><rect stroke="none" width="620" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="60" y="-686"></use></g></g><g transform="translate(25555,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><g transform="translate(27167,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="663" y="488"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-430"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-134">J(\theta) = C\sum_{i=1}^m y^{(i)}cost_0(\theta^Tx^{(i)}) + (1-y^{(i)})cost_1(\theta^Tx^{(i)})+ {1\over 2}\sum_{j=1}^n \theta_j^2</script> <br>
C是常量，用来代换m</p><p data-anchor-id="dycc">支持向量机是一个判别函数 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-135-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 30371.51189189189 2474.657370696049" style="width: 70.541ex; height: 5.792ex; vertical-align: -4.054ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9083,0)"><use xlink:href="#MJMATHI-63"></use><use xlink:href="#MJMATHI-6F" x="433" y="0"></use><use xlink:href="#MJMATHI-73" x="919" y="0"></use><g transform="translate(1388,0)"><use xlink:href="#MJMATHI-74"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-30" x="511" y="-213"></use></g><use xlink:href="#MJMAIN-28" x="2203" y="0"></use><use xlink:href="#MJMATHI-7A" x="2593" y="0"></use><use xlink:href="#MJMAIN-29" x="3061" y="0"></use><use xlink:href="#MJMAIN-3D" x="3729" y="0"></use><use xlink:href="#MJMATHI-6D" x="4785" y="0"></use><use xlink:href="#MJMATHI-61" x="5663" y="0"></use><use xlink:href="#MJMATHI-78" x="6193" y="0"></use><use xlink:href="#MJMAIN-7B" x="6765" y="0"></use><use xlink:href="#MJMAIN-30" x="7266" y="0"></use><use xlink:href="#MJMAIN-2C" x="7766" y="0"></use><use xlink:href="#MJMATHI-6B" x="8212" y="0"></use><use xlink:href="#MJMAIN-28" x="8733" y="0"></use><use xlink:href="#MJMAIN-31" x="9123" y="0"></use><use xlink:href="#MJMAIN-2B" x="9845" y="0"></use><use xlink:href="#MJMATHI-7A" x="10846" y="0"></use><use xlink:href="#MJMAIN-29" x="11315" y="0"></use><use xlink:href="#MJMAIN-7D" x="11704" y="0"></use></g><g transform="translate(9083,-1433)"><use xlink:href="#MJMATHI-63"></use><use xlink:href="#MJMATHI-6F" x="433" y="0"></use><use xlink:href="#MJMATHI-73" x="919" y="0"></use><g transform="translate(1388,0)"><use xlink:href="#MJMATHI-74"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="511" y="-213"></use></g><use xlink:href="#MJMAIN-28" x="2203" y="0"></use><use xlink:href="#MJMATHI-7A" x="2593" y="0"></use><use xlink:href="#MJMAIN-29" x="3061" y="0"></use><use xlink:href="#MJMAIN-3D" x="3729" y="0"></use><use xlink:href="#MJMATHI-6D" x="4785" y="0"></use><use xlink:href="#MJMATHI-61" x="5663" y="0"></use><use xlink:href="#MJMATHI-78" x="6193" y="0"></use><use xlink:href="#MJMAIN-7B" x="6765" y="0"></use><use xlink:href="#MJMAIN-30" x="7266" y="0"></use><use xlink:href="#MJMAIN-2C" x="7766" y="0"></use><use xlink:href="#MJMATHI-6B" x="8212" y="0"></use><use xlink:href="#MJMAIN-28" x="8733" y="0"></use><use xlink:href="#MJMAIN-31" x="9123" y="0"></use><use xlink:href="#MJMAIN-2212" x="9845" y="0"></use><use xlink:href="#MJMATHI-7A" x="10846" y="0"></use><use xlink:href="#MJMAIN-29" x="11315" y="0"></use><use xlink:href="#MJMAIN-7D" x="11704" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-135">cost_0(z)=max\{0,k(1+z)\} \\
cost_1(z)=max\{0,k(1-z)\} </script></p><div class="md-section-divider"></div><h3 data-anchor-id="4824" id="大边缘">大边缘</h3><p data-anchor-id="dq0e">把支持向量机看作<strong>大边缘分类器</strong></p><p data-anchor-id="0j3i">若y=1，我们希望<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-136-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -862.3620829925038 3474.7122829014784 1021.4137683405282" style="width: 8.108ex; height: 2.317ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="513"></use><use xlink:href="#MJMATHI-78" x="1067" y="0"></use><use xlink:href="#MJMAIN-2265" x="1917" y="0"></use><use xlink:href="#MJMAIN-31" x="2974" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-136">\theta^Tx \geq 1</script> <br>
若y=0，我们希望<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-137-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -862.3620829925038 4253.212282901479 1021.4137683405282" style="width: 9.846ex; height: 2.317ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="513"></use><use xlink:href="#MJMATHI-78" x="1067" y="0"></use><use xlink:href="#MJMAIN-2264" x="1917" y="0"></use><use xlink:href="#MJMAIN-2212" x="2974" y="0"></use><use xlink:href="#MJMAIN-31" x="3752" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-137">\theta^Tx \leq -1</script></p><p data-anchor-id="9538">逻辑斯特回归中的决策边界是区分正负样本的一条直线 <br>
在SVM中，决策边界有一种特殊的性质——尽可能远离正负样本 <br>
决策边界到最邻近的样本的距离成为边缘(margin) <br>
SVM最大化这种边缘，故称之为大边缘分类器 <br>
SVM会通过一个大边缘区分正负样本 <br>
只有当C很大时，才能使用SVM。因为C很大，为了最小化损失函数，对<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-138-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-138">\theta</script>的要求更高 <br>
此时损失函数简化成 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-139-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 30371.51189189189 6269.094418779042" style="width: 70.541ex; height: 14.595ex; vertical-align: -11.004ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9943,0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><use xlink:href="#MJMATHI-43" x="3216" y="0"></use><use xlink:href="#MJMAIN-D7" x="4198" y="0"></use><use xlink:href="#MJMAIN-30" x="5199" y="0"></use><use xlink:href="#MJMAIN-2B" x="5922" y="0"></use><g transform="translate(6922,0)"><g transform="translate(120,0)"><rect stroke="none" width="620" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="60" y="-686"></use></g></g><g transform="translate(7950,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><g transform="translate(9561,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="663" y="488"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-430"></use></g></g><g transform="translate(12821,-3330)"><use xlink:href="#MJMAIN-3D" x="277" y="0"></use><g transform="translate(1334,0)"><g transform="translate(120,0)"><rect stroke="none" width="620" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="60" y="-686"></use></g></g><g transform="translate(2361,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><g transform="translate(3805,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="663" y="488"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-430"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-139">J(\theta) = C\times0 + {1\over 2}\sum_{j=1}^n \theta_j^2 \\
 = {1\over 2}\sum_{j=1}^n \theta_j^2 </script></p><p data-anchor-id="5i6t">当数据能被一根直线分为正负时，称数据为线性可分的</p><p data-anchor-id="hoqu">如果出现离群值，我们可以降低C值，不让它影响决策边界</p><p data-anchor-id="kwvv">C的调增与正则化参数的调整效果相反</p><div class="md-section-divider"></div><h3 data-anchor-id="3wyu" id="大边缘分类器背后的数学原理">大边缘分类器背后的数学原理</h3><div class="md-section-divider"></div><h4 data-anchor-id="sz17" id="向量内积">向量内积</h4><p data-anchor-id="uk7d">向量的长度<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-140-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -867.8607200970592 10114.996791076792 1137.9124054450838" style="width: 23.514ex; height: 2.664ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-7C"></use><use xlink:href="#MJMAIN-7C" x="278" y="0"></use><use xlink:href="#MJMATHI-76" x="557" y="0"></use><use xlink:href="#MJMAIN-7C" x="1042" y="0"></use><use xlink:href="#MJMAIN-7C" x="1321" y="0"></use><use xlink:href="#MJMAIN-3D" x="1877" y="0"></use><g transform="translate(2933,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">各</text></g><g transform="translate(3731,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">分</text></g><g transform="translate(4529,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">量</text></g><g transform="translate(5327,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">平</text></g><g transform="translate(6125,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">方</text></g><g transform="translate(6923,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">和</text></g><g transform="translate(7721,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(8519,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">开</text></g><g transform="translate(9317,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">方</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-140">||v|| = 各分量平方和的开方</script> <br>
向量的投影<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-141-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -867.8607200970592 15851.771158920355 1137.9124054450838" style="width: 36.834ex; height: 2.664ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-75"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="809" y="513"></use><use xlink:href="#MJMATHI-76" x="1170" y="0"></use><use xlink:href="#MJMAIN-3D" x="1933" y="0"></use><use xlink:href="#MJMAIN-7C" x="2990" y="0"></use><use xlink:href="#MJMAIN-7C" x="3268" y="0"></use><use xlink:href="#MJMATHI-76" x="3547" y="0"></use><use xlink:href="#MJMAIN-7C" x="4032" y="0"></use><use xlink:href="#MJMAIN-7C" x="4311" y="0"></use><use xlink:href="#MJMATHI-63" x="4589" y="0"></use><use xlink:href="#MJMATHI-6F" x="5023" y="0"></use><use xlink:href="#MJMATHI-73" x="5508" y="0"></use><use xlink:href="#MJMATHI-3B8" x="5978" y="0"></use><use xlink:href="#MJMAIN-7C" x="6447" y="0"></use><use xlink:href="#MJMAIN-7C" x="6726" y="0"></use><use xlink:href="#MJMATHI-75" x="7004" y="0"></use><use xlink:href="#MJMAIN-7C" x="7577" y="0"></use><use xlink:href="#MJMAIN-7C" x="7855" y="0"></use><use xlink:href="#MJMAIN-3D" x="8411" y="0"></use><g transform="translate(9468,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">对</text></g><g transform="translate(10266,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">应</text></g><g transform="translate(11064,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">分</text></g><g transform="translate(11862,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">量</text></g><g transform="translate(12660,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">乘</text></g><g transform="translate(13457,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">积</text></g><g transform="translate(14255,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(15053,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(49.87111969111969) matrix(1 0 0 -1 0 0)">和</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-141">u^Tv = ||v||cos\theta ||u|| = 对应分量乘积的和</script> <br>
記<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-142-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -771.0516853480245 5333.555555555556 1041.103370696049" style="width: 12.394ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><use xlink:href="#MJMAIN-3D" x="781" y="0"></use><use xlink:href="#MJMAIN-7C" x="1837" y="0"></use><use xlink:href="#MJMAIN-7C" x="2116" y="0"></use><use xlink:href="#MJMATHI-76" x="2394" y="0"></use><use xlink:href="#MJMAIN-7C" x="2880" y="0"></use><use xlink:href="#MJMAIN-7C" x="3158" y="0"></use><use xlink:href="#MJMATHI-63" x="3437" y="0"></use><use xlink:href="#MJMATHI-6F" x="3870" y="0"></use><use xlink:href="#MJMATHI-73" x="4356" y="0"></use><use xlink:href="#MJMATHI-3B8" x="4825" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-142">p = ||v||cos\theta</script>是v在u方向上的投影，则 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-143-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -912.3620829925038 5180.212282901479 1182.4137683405283" style="width: 12.046ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-75"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="809" y="583"></use><use xlink:href="#MJMATHI-76" x="1170" y="0"></use><use xlink:href="#MJMAIN-3D" x="1933" y="0"></use><use xlink:href="#MJMATHI-70" x="2990" y="0"></use><use xlink:href="#MJMAIN-7C" x="3493" y="0"></use><use xlink:href="#MJMAIN-7C" x="3772" y="0"></use><use xlink:href="#MJMATHI-75" x="4050" y="0"></use><use xlink:href="#MJMAIN-7C" x="4623" y="0"></use><use xlink:href="#MJMAIN-7C" x="4901" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-143">u^Tv = p||u|| </script></p><p data-anchor-id="29a1">把SVM的损失函数重写成 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-144-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1363.5596853480245 6113.962499539422 2070.562370696049" style="width: 14.247ex; height: 4.865ex; vertical-align: -1.737ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xlink:href="#MJMAIN-3D" x="2159" y="0"></use><g transform="translate(3216,0)"><g transform="translate(120,0)"><rect stroke="none" width="620" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="60" y="-686"></use></g></g><use xlink:href="#MJMAIN-7C" x="4076" y="0"></use><use xlink:href="#MJMAIN-7C" x="4355" y="0"></use><use xlink:href="#MJMATHI-3B8" x="4633" y="0"></use><use xlink:href="#MJMAIN-7C" x="5103" y="0"></use><g transform="translate(5381,0)"><use xlink:href="#MJMAIN-7C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="393" y="675"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-144">J(\theta) = {1\over 2}||\theta||^2</script> <br>
决策边界也重写成: <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-145-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 12078.16462435647 2802.850285968542" style="width: 28.031ex; height: 6.486ex; vertical-align: -2.896ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="583"></use><g transform="translate(1067,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-3D" x="2813" y="0"></use><g transform="translate(3869,0)"><use xlink:href="#MJMATHI-70"></use><g transform="translate(503,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="5267" y="0"></use><use xlink:href="#MJMAIN-7C" x="5546" y="0"></use><use xlink:href="#MJMATHI-3B8" x="5824" y="0"></use><use xlink:href="#MJMAIN-7C" x="6294" y="0"></use><use xlink:href="#MJMAIN-7C" x="6572" y="0"></use><use xlink:href="#MJMAIN-3D" x="7129" y="0"></use><g transform="translate(8185,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><g transform="translate(9796,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="663" y="-213"></use></g><g transform="translate(10610,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="809" y="-435"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-145">\theta^T x^{(i)} = p^{(i)}||\theta|| = \sum_{i=1}^n \theta_i x_1^{(i)}</script> <br>
这里p是样本向量往<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-146-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-146">\theta</script>方向的投影 <br>
若y=1，我们希望<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-147-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -913.9808780191219 4855.197130999828 1184.0325633671464" style="width: 11.236ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><g transform="translate(503,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use xlink:href="#MJMAIN-7C" x="1398" y="0"></use><use xlink:href="#MJMAIN-7C" x="1677" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1955" y="0"></use><use xlink:href="#MJMAIN-7C" x="2425" y="0"></use><use xlink:href="#MJMAIN-7C" x="2703" y="0"></use><use xlink:href="#MJMAIN-2265" x="3259" y="0"></use><use xlink:href="#MJMAIN-31" x="4316" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-147">p^{(i)}||\theta|| \geq 1</script> <br>
若y=0，我们希望<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-148-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -913.9808780191219 5633.697130999828 1184.0325633671464" style="width: 13.089ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><g transform="translate(503,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use xlink:href="#MJMAIN-7C" x="1398" y="0"></use><use xlink:href="#MJMAIN-7C" x="1677" y="0"></use><use xlink:href="#MJMATHI-3B8" x="1955" y="0"></use><use xlink:href="#MJMAIN-7C" x="2425" y="0"></use><use xlink:href="#MJMAIN-7C" x="2703" y="0"></use><use xlink:href="#MJMAIN-2264" x="3259" y="0"></use><use xlink:href="#MJMAIN-2212" x="4316" y="0"></use><use xlink:href="#MJMAIN-31" x="5094" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-148">p^{(i)}||\theta|| \leq -1</script></p><p data-anchor-id="ln74">这造成大边缘的原因是：向量<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-149-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-149">\theta</script>垂直于决策边界 <br>
为了实现优化目标（最小化损失函数,最小化<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-150-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-150">\theta</script>长度），我们需要投影<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-151-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -913.9808780191219 1437.1415754442728 1129.0325633671464" style="width: 3.359ex; height: 2.664ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><g transform="translate(503,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-151">p^{(i)}</script>的绝对值尽可能大 <br>
在样本向量长度一定的情况下，只能找到某个位置的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-152-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-152">\theta</script>，使得样本向量与它之间的夹角最小，而决策边界也随之确定</p><div class="md-section-divider"></div><h3 data-anchor-id="n4j9" id="核">核</h3><p data-anchor-id="tho9">核方法允许我们通过SVM构造复杂的非线性分类器</p><p data-anchor-id="khio">给定x，依据到标志<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-153-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1057.5360050538616 4170.114210586335 1273.5876904018862" style="width: 9.73ex; height: 3.012ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6C"></use><g transform="translate(298,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use xlink:href="#MJMAIN-2C" x="1303" y="0"></use><g transform="translate(1748,0)"><use xlink:href="#MJMATHI-6C"></use><g transform="translate(298,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="1279" y="0"></use><g transform="translate(1101,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6C"></use><g transform="translate(211,299)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-33" x="389" y="0"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-153">l^{(1)},l^{(2),l^{(3)}}</script>的接近度计算新特征 <br>
先定义相似度 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-154-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1684.3501225568752 19033.217709994584 2441.607830184126" style="width: 44.247ex; height: 5.676ex; vertical-align: -1.853ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="693" y="-213"></use><use xlink:href="#MJMAIN-3D" x="1112" y="0"></use><use xlink:href="#MJMATHI-73" x="2168" y="0"></use><use xlink:href="#MJMATHI-69" x="2638" y="0"></use><use xlink:href="#MJMATHI-6D" x="2983" y="0"></use><use xlink:href="#MJMATHI-69" x="3862" y="0"></use><use xlink:href="#MJMATHI-6C" x="4207" y="0"></use><use xlink:href="#MJMATHI-61" x="4506" y="0"></use><use xlink:href="#MJMATHI-72" x="5035" y="0"></use><use xlink:href="#MJMATHI-69" x="5487" y="0"></use><use xlink:href="#MJMATHI-74" x="5832" y="0"></use><use xlink:href="#MJMATHI-79" x="6194" y="0"></use><use xlink:href="#MJMAIN-28" x="6691" y="0"></use><use xlink:href="#MJMATHI-78" x="7081" y="0"></use><use xlink:href="#MJMAIN-2C" x="7653" y="0"></use><g transform="translate(8099,0)"><use xlink:href="#MJMATHI-6C"></use><g transform="translate(298,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="9292" y="0"></use><use xlink:href="#MJMAIN-3D" x="9959" y="0"></use><use xlink:href="#MJMATHI-65" x="11016" y="0"></use><use xlink:href="#MJMATHI-78" x="11482" y="0"></use><use xlink:href="#MJMATHI-70" x="12055" y="0"></use><use xlink:href="#MJMAIN-28" x="12558" y="0"></use><use xlink:href="#MJMAIN-2212" x="12948" y="0"></use><g transform="translate(13726,0)"><g transform="translate(120,0)"><rect stroke="none" width="4676" height="60" x="0" y="220"></rect><g transform="translate(60,714)"><use xlink:href="#MJMAIN-7C"></use><use xlink:href="#MJMAIN-7C" x="278" y="0"></use><use xlink:href="#MJMATHI-78" x="557" y="0"></use><use xlink:href="#MJMAIN-2212" x="1351" y="0"></use><g transform="translate(2352,0)"><use xlink:href="#MJMATHI-6C"></use><g transform="translate(298,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="3546" y="0"></use><g transform="translate(3824,0)"><use xlink:href="#MJMAIN-7C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="393" y="675"></use></g></g><g transform="translate(1574,-726)"><use xlink:href="#MJMAIN-32"></use><g transform="translate(500,0)"><use xlink:href="#MJMATHI-3C3"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="810" y="408"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="18643" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-154">f_i = similarity(x,l^{(i)}) = exp(-{||x-l^{(i)}||^2 \over 2\sigma^2})</script> <br>
这就是<strong>高斯核</strong>，核方法中的一种</p><p data-anchor-id="d8pk">相似度函数的性质：</p><ul data-anchor-id="u0ii">
<li>如果<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-155-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 3100.1971309998285 947.0325633671463" style="width: 7.181ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><use xlink:href="#MJMAIN-2248" x="850" y="0"></use><g transform="translate(1906,0)"><use xlink:href="#MJMATHI-6C"></use><g transform="translate(298,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-155">x \approx l^{(i)}</script>那么<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-156-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 2669.3609484555077 952.103370696049" style="width: 6.255ex; height: 2.201ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="693" y="-213"></use><use xlink:href="#MJMAIN-2248" x="1112" y="0"></use><use xlink:href="#MJMAIN-31" x="2168" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-156">f_i \approx 1</script></li>
<li>如果x远离<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-157-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1193.6415754442728 947.0325633671463" style="width: 2.78ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6C"></use><g transform="translate(298,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-157">l^{(i)}</script>那么<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-158-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 2669.3609484555077 952.103370696049" style="width: 6.255ex; height: 2.201ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="693" y="-213"></use><use xlink:href="#MJMAIN-2248" x="1112" y="0"></use><use xlink:href="#MJMAIN-30" x="2168" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-158">f_i \approx 0</script></li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-159-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -854.5839083994518 1026.7569439838671 886.6355937474763" style="width: 2.432ex; height: 2.085ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3C3"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="810" y="513"></use></g></svg></span><script type="math/tex" id="MathJax-Element-159">\sigma^2</script>是高斯核的参数，用来修正相似度函数下降的速率</li>
</ul><p data-anchor-id="bv5n">把每个标志代入相似度函数得到一个<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-160-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 834.8053928999522 952.103370696049" style="width: 1.969ex; height: 2.201ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-160">f_i</script>，把这些<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-161-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 834.8053928999522 952.103370696049" style="width: 1.969ex; height: 2.201ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-161">f_i</script>作为特征，与<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-162-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-162">\theta</script>的线性组合构成关于X的假设函数</p><p data-anchor-id="cmq1">得到标志的一种方法是，把所有训练样本的空间位置都当作标志，所以就有了m个标志 <br>
对于样本中的每一个向量，可以通过高斯核转化为关于自身到m个标志的相似度向量 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-163-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -3548.9021073040194 19614.990360916105 6597.804214608039" style="width: 45.521ex; height: 15.29ex; vertical-align: -7.181ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use xlink:href="#MJMAIN-2212" x="1467" y="0"></use><use xlink:href="#MJMAIN-3E" x="2523" y="0"></use><g transform="translate(3580,0)"><use xlink:href="#MJMATHI-66"></use><g transform="translate(568,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-3D" x="5321" y="0"></use><g transform="translate(6377,0)"><g transform="translate(0,3528)"><use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-4801.64173655452) scale(1,5.059107357470182)"><use xlink:href="#MJSZ4-23A2"></use></g><use xlink:href="#MJSZ4-23A3" x="0" y="-5913"></use></g><g transform="translate(834,0)"><g transform="translate(-16,0)"><g transform="translate(133,2475)"><use xlink:href="#MJMATHI-66"></use><g transform="translate(568,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="693" y="-435"></use><use xlink:href="#MJMAIN-3D" x="1741" y="0"></use><use xlink:href="#MJMATHI-73" x="2797" y="0"></use><use xlink:href="#MJMATHI-69" x="3267" y="0"></use><use xlink:href="#MJMATHI-6D" x="3612" y="0"></use><use xlink:href="#MJMATHI-69" x="4491" y="0"></use><use xlink:href="#MJMATHI-6C" x="4836" y="0"></use><use xlink:href="#MJMATHI-61" x="5135" y="0"></use><use xlink:href="#MJMATHI-72" x="5664" y="0"></use><use xlink:href="#MJMATHI-69" x="6116" y="0"></use><use xlink:href="#MJMATHI-74" x="6461" y="0"></use><use xlink:href="#MJMATHI-79" x="6823" y="0"></use><use xlink:href="#MJMAIN-28" x="7320" y="0"></use><g transform="translate(7710,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="9177" y="0"></use><g transform="translate(9623,0)"><use xlink:href="#MJMATHI-6C"></use><g transform="translate(298,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="10926" y="0"></use></g><g transform="translate(133,715)"><use xlink:href="#MJMATHI-66"></use><g transform="translate(568,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="693" y="-435"></use><use xlink:href="#MJMAIN-3D" x="1741" y="0"></use><use xlink:href="#MJMATHI-73" x="2797" y="0"></use><use xlink:href="#MJMATHI-69" x="3267" y="0"></use><use xlink:href="#MJMATHI-6D" x="3612" y="0"></use><use xlink:href="#MJMATHI-69" x="4491" y="0"></use><use xlink:href="#MJMATHI-6C" x="4836" y="0"></use><use xlink:href="#MJMATHI-61" x="5135" y="0"></use><use xlink:href="#MJMATHI-72" x="5664" y="0"></use><use xlink:href="#MJMATHI-69" x="6116" y="0"></use><use xlink:href="#MJMATHI-74" x="6461" y="0"></use><use xlink:href="#MJMATHI-79" x="6823" y="0"></use><use xlink:href="#MJMAIN-28" x="7320" y="0"></use><g transform="translate(7710,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="9177" y="0"></use><g transform="translate(9623,0)"><use xlink:href="#MJMATHI-6C"></use><g transform="translate(298,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="10926" y="0"></use></g><use xlink:href="#MJMAIN-22EE" x="5652" y="-1294"></use><g transform="translate(0,-2778)"><use xlink:href="#MJMATHI-66"></use><g transform="translate(568,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="693" y="-212"></use><use xlink:href="#MJMAIN-3D" x="1741" y="0"></use><use xlink:href="#MJMATHI-73" x="2797" y="0"></use><use xlink:href="#MJMATHI-69" x="3267" y="0"></use><use xlink:href="#MJMATHI-6D" x="3612" y="0"></use><use xlink:href="#MJMATHI-69" x="4491" y="0"></use><use xlink:href="#MJMATHI-6C" x="4836" y="0"></use><use xlink:href="#MJMATHI-61" x="5135" y="0"></use><use xlink:href="#MJMATHI-72" x="5664" y="0"></use><use xlink:href="#MJMATHI-69" x="6116" y="0"></use><use xlink:href="#MJMATHI-74" x="6461" y="0"></use><use xlink:href="#MJMATHI-79" x="6823" y="0"></use><use xlink:href="#MJMAIN-28" x="7320" y="0"></use><g transform="translate(7710,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="9177" y="0"></use><g transform="translate(9623,0)"><use xlink:href="#MJMATHI-6C"></use><g transform="translate(298,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1268" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="11193" y="0"></use></g></g></g><g transform="translate(12569,3528)"><use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-4801.64173655452) scale(1,5.059107357470182)"><use xlink:href="#MJSZ4-23A5"></use></g><use xlink:href="#MJSZ4-23A6" x="0" y="-5913"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-163">x^{(i)} -> f^{(i)} = 
\begin{bmatrix}  f_1^{(i)} = similarity(x^{(i)},l^{(1)}) \\ 
f_2^{(i)} =similarity(x^{(i)},l^{(2)}) \\ 
\vdots \\ f_m^{(i)} = similarity(x^{(i)},l^{(m)}) \\
\end{bmatrix}
</script></p><p data-anchor-id="tduq">现在<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-164-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1463.6915754442725 1140.0325633671464" style="width: 3.359ex; height: 2.664ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66"></use><g transform="translate(568,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-164">f^{(i)}</script>就代替了<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-165-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1467.6415754442728 946.0325633671463" style="width: 3.359ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-165">x^{(i)}</script>，我们可以对<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-166-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1463.6915754442725 1140.0325633671464" style="width: 3.359ex; height: 2.664ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66"></use><g transform="translate(568,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-166">f^{(i)}</script>使用SVM算法</p><p data-anchor-id="z9nz">核方法并不只能用来SVM中，但SVM与核方法结合会使得速度很快</p><div class="md-section-divider"></div><h3 data-anchor-id="lpaq" id="选择svm参数">选择SVM参数</h3><ul data-anchor-id="v87x">
<li><p>选择C(=<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-167-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -895.9073646014878 772.5968068223506 1320.0990004504374" style="width: 1.737ex; height: 3.012ex; vertical-align: -1.042ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="532" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="126" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3BB" x="84" y="-559"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-167">{1\over \lambda}</script>) <br>
C很大，high variance, low bias <br>
C很小，low variance, high bias</p></li>
<li><p>选择<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-168-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -854.5839083994518 1026.7569439838671 886.6355937474763" style="width: 2.432ex; height: 2.085ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3C3"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="810" y="513"></use></g></svg></span><script type="math/tex" id="MathJax-Element-168">\sigma^2</script> <br>
很大，f特征很光滑，high bias, low variance <br>
很小，f特征不光滑，low bias, high variance</p></li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="8old" id="使用svm">使用SVM</h3><p data-anchor-id="z3c9">用库函数，不要自己写 <br>
真正需要选择的是：</p><ul data-anchor-id="ll52">
<li>参数C</li>
<li>核（相似度函数）</li>
<li>当n很大、m很小的时候，不需要核，相当于“线性核”，就是典型的线性分类器</li>
<li>当n很小、m很大的时候，采用高斯核，要选择<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-169-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -854.5839083994518 1026.7569439838671 886.6355937474763" style="width: 2.432ex; height: 2.085ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3C3"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="810" y="513"></use></g></svg></span><script type="math/tex" id="MathJax-Element-169">\sigma^2</script></li>
</ul><p data-anchor-id="p8vc">注意： <br>
1. 在使用高斯核之前，要进行特征放缩(feature scaling) <br>
2. 不是所有相似度函数都是合理的核，必须满足Mercer's Theorem，保证优化结果不出偏差 <br>
3. 可以用训练集和交叉验证集训练C和核参数</p><div class="md-section-divider"></div><h4 data-anchor-id="fiqv" id="多元分类-1">多元分类</h4><p data-anchor-id="lupn">就像逻辑斯特回归那样，用一对多方法</p><div class="md-section-divider"></div><h4 data-anchor-id="1emp" id="逻辑斯特回归-vs-svm">逻辑斯特回归 vs. SVM</h4><ul data-anchor-id="bvmw">
<li>当n相对m很大时，用逻辑斯特回归或者无核SVM（也叫线性核）</li>
<li>当n很小、m很大时，手动增加特征，变成第一种情况</li>
<li>当n很小、m适中时，使用高斯核SVM</li>
<li>上述所有情况都可以用神经网络，但很慢</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="hz58" id="第八周">第八周</h2><p data-anchor-id="735y">聚类</p><div class="md-section-divider"></div><h3 data-anchor-id="3dr1" id="非监督学习">非监督学习</h3><p data-anchor-id="zbcx">跟监督学习相对，使用未标注的数据集 <br>
换句话说，没有y向量，只有特征数据集 <br>
聚类有助于</p><ul data-anchor-id="65ym">
<li>市场组分分隔</li>
<li>社交网络分析 </li>
<li>管理计算机群</li>
<li>天文数据分析</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="idii" id="k-means算法">K-Means算法</h3><p data-anchor-id="2dtr">最普遍最常用的自动分类算法，把数据自动分类成凝聚的子集</p><ol data-anchor-id="1qqz">
<li>在数据集中随机初始化两个点，成为<strong>聚类中心</strong>(cluster centroids)</li>
<li>聚类分配：根据靠近哪个聚类中心，把所有样本分配给两个聚类中的一个</li>
<li>移动中心：计算在每个聚类点群中所有点的中心位置，然后把聚类中心移到那个点</li>
<li>重复2和3，直到找到聚类</li>
</ol><p data-anchor-id="sfzt">我们主要的变量是：</p><ul data-anchor-id="1zqd">
<li>K——聚类的数目</li>
<li>训练集<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-170-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 7224.849076206412 1130.0325633671464" style="width: 16.795ex; height: 2.664ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use xlink:href="#MJMAIN-2C" x="1577" y="0"></use><g transform="translate(2022,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="3599" y="0"></use><use xlink:href="#MJMAIN-2E" x="4044" y="0"></use><use xlink:href="#MJMAIN-2E" x="4489" y="0"></use><use xlink:href="#MJMAIN-2E" x="4935" y="0"></use><g transform="translate(5380,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1268" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-170">x^{(1)},x^{(2)},...x^{(m)}</script>, where <span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-171-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 4084.416304186265 976.0325633671463" style="width: 9.498ex; height: 2.317ex; vertical-align: -0.232ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use xlink:href="#MJMAIN-2208" x="1855" y="0"></use><g transform="translate(2800,0)"><use xlink:href="#MJMATHI-52"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="1074" y="513"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-171">x^{(1)} \in R^n</script></li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="rzu1" id="算法">算法</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="flel" style=""><ol class="linenums"><li class="L0"><code><span class="typ">Randomly</span><span class="pln"> initialize K cluster centroids mu</span><span class="pun">(</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> mu</span><span class="pun">(</span><span class="lit">2</span><span class="pun">),</span><span class="pln"> </span><span class="pun">...,</span><span class="pln"> mu</span><span class="pun">(</span><span class="pln">K</span><span class="pun">)</span></code></li><li class="L1"><code><span class="typ">Repeat</span><span class="pun">:</span></code></li><li class="L2"><code><span class="pln">   </span><span class="kwd">for</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> to m</span><span class="pun">:</span></code></li><li class="L3"><code><span class="pln">      c</span><span class="pun">(</span><span class="pln">i</span><span class="pun">):=</span><span class="pln"> index </span><span class="pun">(</span><span class="kwd">from</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> to K</span><span class="pun">)</span><span class="pln"> of cluster centroid closest to x</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">   </span><span class="kwd">for</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> to K</span><span class="pun">:</span></code></li><li class="L5"><code><span class="pln">      mu</span><span class="pun">(</span><span class="pln">k</span><span class="pun">):=</span><span class="pln"> average </span><span class="pun">(</span><span class="pln">mean</span><span class="pun">)</span><span class="pln"> of points assigned to cluster k</span></code></li></ol></pre><p data-anchor-id="a4fe">第一个循环是聚类分配，c(i)表示x(i)被分配到第几个类 <br>
以数学形式表示为 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-172-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -969.6723233290762 11297.875519821651 1353.0946966448348" style="width: 26.293ex; height: 3.127ex; vertical-align: -0.927ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-63"></use><g transform="translate(433,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1606" y="0"></use><use xlink:href="#MJMATHI-61" x="2662" y="0"></use><use xlink:href="#MJMATHI-72" x="3192" y="0"></use><use xlink:href="#MJMATHI-67" x="3643" y="0"></use><use xlink:href="#MJMATHI-6D" x="4124" y="0"></use><use xlink:href="#MJMATHI-69" x="5002" y="0"></use><g transform="translate(5348,0)"><use xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="849" y="-213"></use></g><use xlink:href="#MJMAIN-7C" x="6417" y="0"></use><use xlink:href="#MJMAIN-7C" x="6695" y="0"></use><g transform="translate(6974,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="8664" y="0"></use><g transform="translate(9665,0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-7C" x="853" y="-264"></use></g><g transform="translate(10565,0)"><use xlink:href="#MJMAIN-7C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="393" y="675"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-172">c^{(i)} = argmin_k ||x^{(i)}-\mu_||^2</script> <br>
这样每个c(i)包含距离x(i)最近的聚类中心的编号</p><p data-anchor-id="8lf5">一般的欧拉距离是要开方的，但这里没有开方，为了计算方便而且增长快速</p><p data-anchor-id="zu35">第二个循环是移动中心。 <br>
数学形式为 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-173-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1363.5596853480245 13828.415327544064 2081.562370696049" style="width: 32.085ex; height: 4.865ex; vertical-align: -1.737ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="853" y="-213"></use><use xlink:href="#MJMAIN-3D" x="1350" y="0"></use><g transform="translate(2406,0)"><g transform="translate(120,0)"><rect stroke="none" width="720" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="110" y="676"></use><use xlink:href="#MJMATHI-6E" x="60" y="-686"></use></g></g><use xlink:href="#MJMAIN-5B" x="3366" y="0"></use><g transform="translate(3645,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><g transform="translate(275,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-31" x="737" y="-213"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1364" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="5780" y="0"></use><g transform="translate(6781,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><g transform="translate(275,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-32" x="737" y="-213"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1364" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="8694" y="0"></use><use xlink:href="#MJMAIN-2E" x="9472" y="0"></use><use xlink:href="#MJMAIN-2E" x="9918" y="0"></use><use xlink:href="#MJMAIN-2E" x="10363" y="0"></use><use xlink:href="#MJMAIN-2B" x="10808" y="0"></use><g transform="translate(11586,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><g transform="translate(275,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6E" x="737" y="-213"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1435" y="0"></use></g></g><use xlink:href="#MJMAIN-5D" x="13549" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-173">\mu_k = {1\over n}[x^{(k_1)}+x^{(k_2)}+...+x^{(k_n)}]</script> <br>
其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-174-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1963.05304705176 946.0325633671463" style="width: 4.517ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><g transform="translate(275,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6E" x="737" y="-213"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1435" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-174">x^{(k_n)}</script>是分配给聚类<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-175-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.0516853480245 1736.6996205647363 818.5455422135298" style="width: 4.054ex; height: 1.853ex; vertical-align: -0.927ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6D"></use><g transform="translate(878,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6B" x="853" y="-357"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-175">m_{\mu_k}</script>的训练样本</p><p data-anchor-id="wk57">如果有一个聚类没有分配到点，那么可以重新随机初始化到一个新的点，也可以简单地去除这个聚类。</p><p data-anchor-id="vb0t">在一定次数的迭代之后，算法会<strong>收敛</strong>，新的迭代不影响现有聚类情况</p><p data-anchor-id="ozwq">对于没有内在分隔或者自然结构的数据，K-Means算法也能均匀地把数据分隔成K份</p><div class="md-section-divider"></div><h4 data-anchor-id="k2fq" id="优化目标">优化目标</h4><p data-anchor-id="wzj1">参数如下</p><ul data-anchor-id="8ll9">
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-176-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1328.6415754442728 947.0325633671463" style="width: 3.127ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-63"></use><g transform="translate(433,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-176">c^{(i)}</script> = 样本<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-177-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1467.6415754442728 946.0325633671463" style="width: 3.359ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-177">x^{(i)}</script>分配到的聚类的编号</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-178-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 1072.2561863887845 700.103370696049" style="width: 2.548ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="853" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-178">\mu_k</script> = 聚类中心向量</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-179-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 1642.9914677630234 727.6272226548934" style="width: 3.822ex; height: 1.737ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use><g transform="translate(603,-236)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-63"></use><g transform="translate(306,204)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-29" x="735" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-179">\mu_{c^{(i)}}</script> = 样本<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-180-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1467.6415754442728 946.0325633671463" style="width: 3.359ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-180">x^{(i)}</script>分配到的聚类的中心</li>
</ul><p data-anchor-id="4b9g">定义损失函数： <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-181-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 21725.04084949145 2802.850285968542" style="width: 50.502ex; height: 6.486ex; vertical-align: -2.896ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><g transform="translate(1023,0)"><use xlink:href="#MJMATHI-63"></use><g transform="translate(433,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="2351" y="0"></use><use xlink:href="#MJMAIN-2E" x="2796" y="0"></use><use xlink:href="#MJMAIN-2E" x="3241" y="0"></use><use xlink:href="#MJMAIN-2E" x="3687" y="0"></use><use xlink:href="#MJMAIN-2C" x="4132" y="0"></use><g transform="translate(4577,0)"><use xlink:href="#MJMATHI-63"></use><g transform="translate(433,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1268" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="6283" y="0"></use><g transform="translate(6728,0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="853" y="-213"></use></g><use xlink:href="#MJMAIN-2C" x="7785" y="0"></use><use xlink:href="#MJMAIN-2E" x="8230" y="0"></use><use xlink:href="#MJMAIN-2E" x="8675" y="0"></use><use xlink:href="#MJMAIN-2E" x="9121" y="0"></use><use xlink:href="#MJMAIN-2C" x="9566" y="0"></use><g transform="translate(10011,0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="853" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="11083" y="0"></use><use xlink:href="#MJMAIN-3D" x="11750" y="0"></use><g transform="translate(12807,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(14212,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-7C" x="15823" y="0"></use><use xlink:href="#MJMAIN-7C" x="16102" y="0"></use><g transform="translate(16380,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="18070" y="0"></use><g transform="translate(19071,0)"><use xlink:href="#MJMATHI-3BC"></use><g transform="translate(603,-236)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-63"></use><g transform="translate(306,204)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-29" x="735" y="0"></use></g></g></g><use xlink:href="#MJMAIN-7C" x="20714" y="0"></use><g transform="translate(20992,0)"><use xlink:href="#MJMAIN-7C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="393" y="675"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-181">J(c^{(i)},...,c^{(m)},\mu_1,...,\mu_k) = {1\over m}\sum_{i=1}^m||x^{(i)}-\mu_{c^{(i)}}||^2</script></p><p data-anchor-id="6lqp">优化目标是 <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-182-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 5749.36563731757 1094.5455422135299" style="width: 13.32ex; height: 2.548ex; vertical-align: -0.811ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6D"></use><use xlink:href="#MJMATHI-69" x="878" y="0"></use><g transform="translate(1224,0)"><use xlink:href="#MJMATHI-6E"></use><g transform="translate(600,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="433" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3BC" x="712" y="0"></use></g></g><use xlink:href="#MJMATHI-4A" x="2854" y="0"></use><use xlink:href="#MJMAIN-28" x="3488" y="0"></use><use xlink:href="#MJMATHI-63" x="3877" y="0"></use><use xlink:href="#MJMAIN-2C" x="4311" y="0"></use><use xlink:href="#MJMATHI-3BC" x="4756" y="0"></use><use xlink:href="#MJMAIN-29" x="5359" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-182">min_{c,\mu}J(c,\mu)</script></p><p data-anchor-id="6ogy">即寻找集合c（代表所有聚类）以及<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-183-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 603.5 700.103370696049" style="width: 1.39ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use></g></svg></span><script type="math/tex" id="MathJax-Element-183">\mu</script>(代表所有中心)来最小化每个训练样本到相应聚类中心的平均距离</p><p data-anchor-id="8gkc">上述损失函数也成为训练样本的失真(distortion) <br>
在聚类分配的步骤，我们的目标是保持<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-184-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 603.5 700.103370696049" style="width: 1.39ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use></g></svg></span><script type="math/tex" id="MathJax-Element-184">\mu</script>不变，用c来最小化J <br>
在移动中心的步骤，我们的目标是用<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-185-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 603.5 700.103370696049" style="width: 1.39ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use></g></svg></span><script type="math/tex" id="MathJax-Element-185">\mu</script>来最小化J</p><p data-anchor-id="x7op">K-Means算法的损失函数不可能递增，只能递减。</p><div class="md-section-divider"></div><h4 data-anchor-id="xzk9" id="随机初始化-1">随机初始化</h4><p data-anchor-id="pb4j">一种推荐的方法</p><ol data-anchor-id="5pbz">
<li>令K
</li><li>随机选取K个样本</li>
<li>令<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-186-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 3910.3297970393182 700.103370696049" style="width: 9.035ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="853" y="-213"></use><use xlink:href="#MJMAIN-2C" x="1057" y="0"></use><use xlink:href="#MJMAIN-2E" x="1502" y="0"></use><use xlink:href="#MJMAIN-2E" x="1947" y="0"></use><use xlink:href="#MJMAIN-2E" x="2392" y="0"></use><g transform="translate(2838,0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="853" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-186">\mu_1,...\mu_k</script>等于这K个样本</li>
</ol><p data-anchor-id="tkyq">K-Means会陷入局部最优解。为了降低这种事发生的几率，你可以在多个不同的随机初始化上进行算法。当K&lt;10的情况，推荐在一个随机初始化的循环里跑一下。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="3h78" style=""><ol class="linenums"><li class="L0"><code><span class="kwd">for</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> to </span><span class="lit">100</span><span class="pun">:</span></code></li><li class="L1"><code><span class="pln">   randomly initialize k</span><span class="pun">-</span><span class="pln">means</span></code></li><li class="L2"><code><span class="pln">   run k</span><span class="pun">-</span><span class="pln">means to </span><span class="kwd">get</span><span class="pln"> </span><span class="str">'c'</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="str">'m'</span></code></li><li class="L3"><code><span class="pln">   compute the cost </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">distortion</span><span class="pun">)</span><span class="pln"> J</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln">m</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">pick the clustering that gave us the lowest cost</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="lbr6" id="选择聚类的数目">选择聚类的数目</h4><p data-anchor-id="j72l">K的选择是相当随意和模凌两可的</p><p data-anchor-id="t4nm">The elbow method： 画出损失函数J和聚类数目K。J应当随着K的增加而减小（除非陷入局部最优），然后趋于平滑。选择损失函数开始平滑的那个K值。 <br>
但是通常曲线变化很平缓(gradual)，没有一个清晰的elbow。</p><p data-anchor-id="uvwx">另一种选择K的方法是观察K-Means怎样在下游的目的(downstream purpose)中表现，即根据使用这些聚类的实际需求。</p><div class="md-section-divider"></div><h5 data-anchor-id="xy2z" id="k-means的缺陷">K-Means的缺陷</h5><p data-anchor-id="qk21"><a href="https://stats.stackexchange.com/questions/133656/how-to-understand-the-drawbacks-of-k-means" target="_blank">https://stats.stackexchange.com/questions/133656/how-to-understand-the-drawbacks-of-k-means</a></p><p data-anchor-id="581k">有三个assumption： <br>
1. k-means assumes the variance of the distribution of each attribute (variable) is spherical; <br>
2. all variables have the same variance; <br>
3. the prior probability for all k clusters is the same, i.e., each cluster has roughly equal number of observations;</p><p data-anchor-id="9rs5">失效情况： <br>
Clustering non-clustered data <br>
Sensitive to scale <br>
Even on perfect data sets, it can get stuck in a local minimum. <br>
If you want a theoretical model of what k-means does, consider it a quantization approach, not a clustering algorithm. <br>
k-means finds (sometimes) the best reduction to k values of a multidimensional data set. Where "best" is the least squared error.</p><div class="md-section-divider"></div><h3 data-anchor-id="5vfk" id="降维">降维</h3><div class="md-section-divider"></div><h4 data-anchor-id="2a3x" id="目的1数据压缩">目的1：数据压缩</h4><ul data-anchor-id="8jqr">
<li>数据冗余需要对特征的维度进行压缩 <br>
找两个高度相关的特征，画出它们，构造一条新的直线准确地表述两个特征。然后在这一条直线上放置所有的新特征。 <br>
降维可以减少储存的数据总量并加快算法 <br>
注意：降的是特征数，不是样本数</li>
</ul><div class="md-section-divider"></div><h4 data-anchor-id="ozwz" id="目的2可视化">目的2：可视化</h4><p data-anchor-id="ybjo">把数据降到3维就可以可视化了 <br>
我们要找新的三个特征来有效归纳(summarize)所有其他特征</p><div class="md-section-divider"></div><h4 data-anchor-id="m8xe" id="pca">PCA</h4><p data-anchor-id="ouzl">最常用的降维算法Principal Component Analysis (PCA)</p><div class="md-section-divider"></div><h5 data-anchor-id="zx8l" id="问题形成">问题形成</h5><p data-anchor-id="kcwu">给定两个特征，我们项找一条直线能够一次性有效描述它们，然后把旧的特征映射到这条新的线上。 <br>
三个特征也一样，映射到一个平面 <br>
PCA的目标是减小所有特征到投影直线的平均距离，这叫<strong>投影误差</strong></p><p data-anchor-id="waqk">从n维降到k维：寻找K个向量，使得数据在它们上的投影的误差最小</p><div class="md-section-divider"></div><h4 data-anchor-id="tqy3" id="pca不是线性回归">PCA不是线性回归</h4><ul data-anchor-id="0uq6">
<li>线性回归最小化的是每个点到预测直线的平方误差（squared error），是垂直距离</li>
<li><p>PCA最小化的是到数据点的<strong>最短距离</strong>，或者叫最短正交距离</p></li>
<li><p>线性回归做的是拿x来“预测”y</p></li>
<li>PCA做的是拿x来“找向量”</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="ftsa" id="pca算法">PCA算法</h3><p data-anchor-id="go41">给定训练集x(1),x(2),...,x(m) <br>
1. 预处理（特征放缩、均值正则化） <br>
2. 计算<strong>协方差矩阵</strong>(covariance matrix) <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-187-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 10107.328767123357 2802.850285968542" style="width: 23.514ex; height: 6.486ex; vertical-align: -2.896ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJSZ2-2211"></use><use xlink:href="#MJMAIN-3D" x="1722" y="0"></use><g transform="translate(2778,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(4183,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><g transform="translate(5794,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-28" x="7262" y="0"></use><g transform="translate(7652,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><g transform="translate(9119,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-187">\sum = {1\over m}\sum_{i=1}^m x^{(i)} (x^{(i)})^T</script> <br>
得到<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-188-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -512.0516853480245 2423.9444444444443 544.103370696049" style="width: 5.676ex; height: 1.274ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E"></use><use xlink:href="#MJMAIN-D7" x="822" y="0"></use><use xlink:href="#MJMATHI-6E" x="1823" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-188">n\times n</script>维矩阵 <br>
3. 计算协方差矩阵的<strong>特征向量</strong> <br>
使用执行singular value decomposition(SVD)的内置函数，得到的U矩阵是我们需要的 <br>
<code>[U,S,V] = svd(\sigma)</code> <br>
4. 取U矩阵的前k列并计算z <br>
取U矩阵的前k列，得到一个<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-189-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.0516853480245 2344.9444444444443 747.103370696049" style="width: 5.444ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E"></use><use xlink:href="#MJMAIN-D7" x="822" y="0"></use><use xlink:href="#MJMATHI-6B" x="1823" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-189">n\times k</script>的矩阵<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-190-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.0516853480245 2844.0091603775995 883.295758851474" style="width: 6.602ex; height: 2.085ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-55"></use><g transform="translate(683,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-64" x="918" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-75" x="1441" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-63" x="2013" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-65" x="2447" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-190">U_{reduce}</script>，然后计算z <br>
z值是一个实数，表示原有特征往压缩后的特征的投影 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-191-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -963.9808780191219 7010.2978668217 1320.220964447222" style="width: 16.332ex; height: 3.012ex; vertical-align: -0.927ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-7A"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1642" y="0"></use><g transform="translate(2698,0)"><use xlink:href="#MJMATHI-55"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="1121" y="488"></use><g transform="translate(683,-327)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-64" x="918" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-75" x="1441" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-63" x="2013" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-65" x="2447" y="0"></use></g></g><g transform="translate(5542,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-191"> z^{(i)} = U_{reduce}^T x^{(i)} </script></p><div class="md-section-divider"></div><h3 data-anchor-id="t76l" id="从压缩表示重建">从压缩表示重建</h3><p data-anchor-id="8yh8"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-192-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 8369.00354687165 1380.4655986231737" style="width: 19.459ex; height: 3.243ex; vertical-align: -0.811ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><g transform="translate(572,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-61"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-70" x="529" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-70" x="1033" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72" x="1536" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6F" x="1988" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-78" x="2473" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="3104" y="0"></use><g transform="translate(4160,0)"><use xlink:href="#MJMATHI-55"></use><g transform="translate(683,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-64" x="918" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-75" x="1441" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-63" x="2013" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-65" x="2447" y="0"></use></g></g><g transform="translate(7004,0)"><use xlink:href="#MJMATHI-7A"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-192">x_{approx}^{(i)} = U_{reduce} z^{(i)}</script> <br>
只能得到近似值</p><p data-anchor-id="fbw4">注意：U矩阵的特殊性质 <br>
U矩阵是一个<strong>酋矩阵</strong>(unitary matrix) <br>
其逆矩阵是自身的共轭矩阵，在实数范围内就是自身的转置</p><div class="md-section-divider"></div><h3 data-anchor-id="sed8" id="选择主成分的数目">选择主成分的数目</h3><p data-anchor-id="75fi">怎样选择k，也就是主成分的数目？k是降维到达的维度。 <br>
使用一下公式： <br>
给定平均平方投影误差: <span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-193-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 10704.561826010071 1446.3938468192084" style="width: 24.903ex; height: 3.359ex; vertical-align: -0.927ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="741" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="273" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="84" y="-488"></use></g><g transform="translate(1147,0)"><use xlink:href="#MJSZ1-2211"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="3619" y="0"></use><use xlink:href="#MJMAIN-7C" x="3898" y="0"></use><g transform="translate(4176,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="5866" y="0"></use><g transform="translate(6867,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><g transform="translate(572,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-61"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-70" x="529" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-70" x="1033" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72" x="1536" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6F" x="1988" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-78" x="2473" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="9693" y="0"></use><g transform="translate(9972,0)"><use xlink:href="#MJMAIN-7C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="393" y="675"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-193">{1\over m}\sum_{i=1}^m||x^{(i)}-x_{approx}^{(i)}||^2</script> <br>
也给定数据的总偏移(total variation): <span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-194-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -969.6723233290762 6655.270126071401 1343.0502900513393" style="width: 15.405ex; height: 3.127ex; vertical-align: -0.927ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="741" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="273" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="84" y="-488"></use></g><g transform="translate(1147,0)"><use xlink:href="#MJSZ1-2211"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="3619" y="0"></use><use xlink:href="#MJMAIN-7C" x="3898" y="0"></use><g transform="translate(4176,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="5644" y="0"></use><g transform="translate(5922,0)"><use xlink:href="#MJMAIN-7C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="393" y="675"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-194">{1\over m}\sum_{i=1}^m||x^{(i)}||^2</script> <br>
选择最小的k使得<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-195-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1891.0199606989831 14178.617381565626 3178.696364630097" style="width: 32.896ex; height: 7.413ex; vertical-align: -3.127ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="10824" height="60" x="0" y="220"></rect><g transform="translate(60,818)"><g transform="translate(120,0)"><rect stroke="none" width="741" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="273" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="84" y="-488"></use></g><g transform="translate(1147,0)"><use xlink:href="#MJSZ1-2211"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="3619" y="0"></use><use xlink:href="#MJMAIN-7C" x="3898" y="0"></use><g transform="translate(4176,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="5866" y="0"></use><g transform="translate(6867,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><g transform="translate(572,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-61"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-70" x="529" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-70" x="1033" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72" x="1536" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6F" x="1988" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-78" x="2473" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="9693" y="0"></use><g transform="translate(9972,0)"><use xlink:href="#MJMAIN-7C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="393" y="675"></use></g></g><g transform="translate(2084,-915)"><g transform="translate(120,0)"><rect stroke="none" width="741" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="273" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="84" y="-488"></use></g><g transform="translate(1147,0)"><use xlink:href="#MJSZ1-2211"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="3619" y="0"></use><use xlink:href="#MJMAIN-7C" x="3898" y="0"></use><g transform="translate(4176,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,288)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-7C" x="5644" y="0"></use><g transform="translate(5922,0)"><use xlink:href="#MJMAIN-7C"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="393" y="675"></use></g></g></g><use xlink:href="#MJMAIN-2264" x="11342" y="0"></use><g transform="translate(12398,0)"><use xlink:href="#MJMAIN-30"></use><use xlink:href="#MJMAIN-2E" x="500" y="0"></use><use xlink:href="#MJMAIN-30" x="779" y="0"></use><use xlink:href="#MJMAIN-31" x="1279" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-195">{{1\over m}\sum_{i=1}^m||x^{(i)}-x_{approx}^{(i)}||^2 \over {1\over m}\sum_{i=1}^m||x^{(i)}||^2} \leq 0.01 </script> <br>
换句话说，平方投影误差除以总偏移应该小于百分之一，即99%的variance得到保留。</p><p data-anchor-id="h2sq">选择K的算法 <br>
1. 令k=1,2...使用PCA <br>
2. 计算<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-196-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.0516853480245 4775.342493710933 920.103370696049" style="width: 11.12ex; height: 2.085ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-55"></use><g transform="translate(683,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-64" x="918" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-75" x="1441" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-63" x="2013" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-65" x="2447" y="0"></use></g><use xlink:href="#MJMAIN-2C" x="2844" y="0"></use><use xlink:href="#MJMATHI-7A" x="3289" y="0"></use><use xlink:href="#MJMAIN-2C" x="3757" y="0"></use><use xlink:href="#MJMATHI-78" x="4202" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-196">U_{reduce} ,z, x</script> <br>
3. 检查上述公式</p><p data-anchor-id="hk85">实际上有更快的方法：利用矩阵S <br>
<code>[U,S,V] = svd(\sigma)</code> <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-197-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1748.9897328636648 7148.0279740596725 2820.495663649506" style="width: 16.564ex; height: 6.602ex; vertical-align: -2.548ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="3793" height="60" x="0" y="220"></rect><g transform="translate(60,759)"><use xlink:href="#MJSZ1-2211"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><g transform="translate(2471,0)"><use xlink:href="#MJMATHI-53"></use><g transform="translate(613,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="345" y="0"></use></g></g></g><g transform="translate(60,-757)"><use xlink:href="#MJSZ1-2211"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><g transform="translate(2471,0)"><use xlink:href="#MJMATHI-53"></use><g transform="translate(613,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="345" y="0"></use></g></g></g></g><use xlink:href="#MJMAIN-2264" x="4311" y="0"></use><g transform="translate(5368,0)"><use xlink:href="#MJMAIN-30"></use><use xlink:href="#MJMAIN-2E" x="500" y="0"></use><use xlink:href="#MJMAIN-39" x="779" y="0"></use><use xlink:href="#MJMAIN-39" x="1279" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-197">{\sum_{i=1}^k S_{ii} \over \sum_{i=1}^n S_{ii}} \leq 0.99</script></p><div class="md-section-divider"></div><h3 data-anchor-id="je95" id="使用pca的建议">使用PCA的建议</h3><p data-anchor-id="olpb">常用来加速监督学习 <br>
把一万维度的特征减到一千维度</p><p data-anchor-id="1i6b">注意：</p><ul data-anchor-id="8yd2">
<li>降维只用来训练集，不用在交叉验证集和测试集，所以需要升维</li>
<li>PCA不推荐用来防止过拟合</li>
<li>PCA不是机器学习的必须步骤，而是附加手段</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="u59d" id="第九周">第九周</h2><p data-anchor-id="qtf3">异常检测</p><div class="md-section-divider"></div><h3 data-anchor-id="xggi" id="问题来源">问题来源</h3><p data-anchor-id="1q5x">给定数据集，想知道一个新的样本是否异常 <br>
构造一个模型，用来判定这个样本正常的概率 <br>
设定阀值，如果概率小于阀值，就判定为异常 <br>
如果这个异常检测器标记出<strong>太多</strong>异常样本，那么有必要减小阀值了</p><div class="md-section-divider"></div><h3 data-anchor-id="xtyq" id="高斯分布">高斯分布</h3><p data-anchor-id="nt1z">高斯分布类似于一个钟形曲线，能用函数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-198-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -854.5839083994518 3742.9236106505336 1125.6355937474764" style="width: 8.687ex; height: 2.664ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4E"></use><use xlink:href="#MJMAIN-28" x="888" y="0"></use><use xlink:href="#MJMATHI-3BC" x="1278" y="0"></use><use xlink:href="#MJMAIN-2C" x="1881" y="0"></use><g transform="translate(2326,0)"><use xlink:href="#MJMATHI-3C3"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="810" y="513"></use></g><use xlink:href="#MJMAIN-29" x="3353" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-198">N(\mu,\sigma^2)</script>表述 <br>
x是一个实数，如果x的概率分布是高斯分布 <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-199-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -854.5839083994518 5649.47916620609 1125.6355937474764" style="width: 13.089ex; height: 2.664ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><use xlink:href="#MJMAIN-2248" x="850" y="0"></use><use xlink:href="#MJMATHI-4E" x="1906" y="0"></use><use xlink:href="#MJMAIN-28" x="2795" y="0"></use><use xlink:href="#MJMATHI-3BC" x="3184" y="0"></use><use xlink:href="#MJMAIN-2C" x="3788" y="0"></use><g transform="translate(4233,0)"><use xlink:href="#MJMATHI-3C3"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="810" y="513"></use></g><use xlink:href="#MJMAIN-29" x="5259" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-199">x \approx N(\mu,\sigma^2)</script> <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-200-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><span style="display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="display: inline-block; position: relative; width: 1.853ex; height: 1.042ex; vertical-align: 0.116ex;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -504.0516853480245 778.5 524.103370696049" style="width: 1.853ex; height: 1.274ex; position: absolute; bottom: -0.116ex; left: 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-2248"></use></g></svg></span></span></span><script type="math/tex" id="MathJax-Element-200">\approx</script>: is distributed as  <br>
其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-201-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 603.5 700.103370696049" style="width: 1.39ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use></g></svg></span><script type="math/tex" id="MathJax-Element-201">\mu</script>是均值，决定曲线的中心 <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-202-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -452.0516853480245 572.5 484.10337069604896" style="width: 1.274ex; height: 1.158ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3C3"></use></g></svg></span><script type="math/tex" id="MathJax-Element-202">\sigma</script>是标准差，决定曲线的宽度</p><div class="md-section-divider"></div><p data-anchor-id="7x5g"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-203-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -1363.5596853480245 12524.425322689458 2410.289169923848" style="width: 29.073ex; height: 5.56ex; vertical-align: -2.548ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><use xlink:href="#MJMAIN-28" x="503" y="0"></use><use xlink:href="#MJMATHI-78" x="893" y="0"></use><use xlink:href="#MJMAIN-3B" x="1465" y="0"></use><use xlink:href="#MJMATHI-3BC" x="1910" y="0"></use><use xlink:href="#MJMAIN-2C" x="2514" y="0"></use><g transform="translate(2959,0)"><use xlink:href="#MJMATHI-3C3"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="810" y="583"></use></g><use xlink:href="#MJMAIN-29" x="3986" y="0"></use><use xlink:href="#MJMAIN-3D" x="4653" y="0"></use><g transform="translate(5709,0)"><g transform="translate(120,0)"><rect stroke="none" width="2600" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="1049" y="676"></use><g transform="translate(60,-876)"><use xlink:href="#MJMATHI-3C3"></use><g transform="translate(572,0)"><use xlink:href="#MJMAIN-221A" x="0" y="50"></use><rect stroke="none" width="1074" height="60" x="833" y="791"></rect><g transform="translate(833,0)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMATHI-3C0" x="500" y="0"></use></g></g></g></g></g><g transform="translate(8549,0)"><use xlink:href="#MJMATHI-65"></use><g transform="translate(466,418)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212"></use><g transform="translate(550,0)"><g transform="translate(120,0)"><rect stroke="none" width="370" height="60" x="0" y="146"></rect><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-31" x="119" y="661"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-32" x="119" y="-621"></use></g></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="1641" y="0"></use><g transform="translate(1436,0)"><g transform="translate(120,0)"><rect stroke="none" width="1097" height="60" x="0" y="146"></rect><g transform="translate(60,438)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-78"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-2212" x="572" y="0"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-3BC" x="1351" y="0"></use></g><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-3C3" x="811" y="-488"></use></g></g><g transform="translate(2773,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-32" x="550" y="675"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-203">p(x;\mu,\sigma^2) = {1\over \sigma \sqrt{2\pi}}e^{-{1\over 2}({x-\mu \over \sigma})^2}</script> <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true"><span class="MathJax_SVG" id="MathJax-Element-204-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 30371.51189189189 5996.151201241035" style="width: 70.541ex; height: 13.9ex; vertical-align: -10.309ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(11974,0)"><use xlink:href="#MJMATHI-3BC"></use><use xlink:href="#MJMAIN-3D" x="881" y="0"></use><g transform="translate(1937,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(3342,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><g transform="translate(4953,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></g><g transform="translate(10317,-3194)"><use xlink:href="#MJMATHI-3C3"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="810" y="583"></use><use xlink:href="#MJMAIN-3D" x="1304" y="0"></use><g transform="translate(2360,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(3765,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="5210" y="0"></use><g transform="translate(5599,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="7289" y="0"></use><use xlink:href="#MJMATHI-3BC" x="8290" y="0"></use><g transform="translate(8894,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-204">\mu = {1\over m}\sum_{i=1}^m x^{(i)} \\
\sigma^2 = {1\over m}\sum_{i=1}^m (x^{(i)}-\mu)^2 </script></p><div class="md-section-divider"></div><h3 data-anchor-id="rvb8" id="算法-1">算法</h3><p data-anchor-id="x90v">独立性假设：训练集样本的各个特征直接没有相关性 <br>
記 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-205-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -1585.0070961948516 9831.675594018325 2939.3218947375453" style="width: 22.819ex; height: 6.834ex; vertical-align: -3.243ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><use xlink:href="#MJMAIN-28" x="503" y="0"></use><use xlink:href="#MJMATHI-78" x="893" y="0"></use><use xlink:href="#MJMAIN-29" x="1465" y="0"></use><use xlink:href="#MJMAIN-3D" x="2132" y="0"></use><g transform="translate(3189,0)"><use xlink:href="#MJSZ2-220F"></use><g transform="translate(41,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="603" y="1627"></use></g><use xlink:href="#MJMATHI-70" x="4634" y="0"></use><use xlink:href="#MJMAIN-28" x="5137" y="0"></use><g transform="translate(5527,0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="#MJMAIN-3B" x="6491" y="0"></use><g transform="translate(6936,0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="853" y="-213"></use></g><use xlink:href="#MJMAIN-2C" x="7931" y="0"></use><g transform="translate(8376,0)"><use xlink:href="#MJMATHI-3C3"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="810" y="583"></use></g><use xlink:href="#MJMAIN-29" x="9403" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-205">p(x) = \prod_{j=1}^n p(x_j;\mu_j,\sigma^2) </script> <br>
注意：<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-206-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 964.1815472394509 778.0602608392912" style="width: 2.201ex; height: 1.853ex; vertical-align: -0.811ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="809" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-206">x_j</script>不是样本向量，而是特征分量</p><ol data-anchor-id="79mw">
<li>在各特征分量上计算均值和标准差</li>
<li>计算待检测的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-207-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -771.0516853480245 1893.5 1042.103370696049" style="width: 4.402ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><use xlink:href="#MJMAIN-28" x="503" y="0"></use><use xlink:href="#MJMATHI-78" x="893" y="0"></use><use xlink:href="#MJMAIN-29" x="1465" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-207">p(x)</script></li>
<li>与阀值比较</li>
</ol><div class="md-section-divider"></div><h3 data-anchor-id="tb64" id="开发与评价异常检测系统">开发与评价异常检测系统</h3><p data-anchor-id="2hub">为了评估我们的算法， 拿来一些标记数据，把它们分为正常和异常样本 <br>
在数据中，拿极大部分好的、非异常数据作为训练集来训练<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-208-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -771.0516853480245 1893.5 1042.103370696049" style="width: 4.402ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><use xlink:href="#MJMAIN-28" x="503" y="0"></use><use xlink:href="#MJMATHI-78" x="893" y="0"></use><use xlink:href="#MJMAIN-29" x="1465" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-208">p(x)</script> <br>
然后拿一小部分异常与非异常混合的样本（异常依然是少数）作为交叉验证集和测试集</p><ol data-anchor-id="vh8p">
<li>在训练集上拟合模型<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-209-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -771.0516853480245 1893.5 1042.103370696049" style="width: 4.402ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><use xlink:href="#MJMAIN-28" x="503" y="0"></use><use xlink:href="#MJMATHI-78" x="893" y="0"></use><use xlink:href="#MJMAIN-29" x="1465" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-209">p(x)</script></li>
<li>在交叉验证集或者测试集上，依据阀值做出预测</li>
<li>使用一些评价指标： true/false positive/negative, precision/recall, F1 score</li>
</ol><p data-anchor-id="52a4">注意：交叉验证集可以用来选择阀值</p><div class="md-section-divider"></div><h3 data-anchor-id="n4s0" id="异常检测vs-监督学习">异常检测vs. 监督学习</h3><p data-anchor-id="xd2p">使用异常检测的情况：</p><ul data-anchor-id="41n1">
<li>有非常少的正样本和非常多的负样本</li>
<li>异常种类有很多种，很难用算法从正样本中学习到异常长什么样；未来的异常可能跟以前看过的都不一样</li>
</ul><p data-anchor-id="qtpe">使用监督学习的情况：</p><ul data-anchor-id="i0q5">
<li>有大量正负样本，训练集可以大概均分</li>
<li>有足够多的正样本帮助算法学习到新的正样本长什么样，未来的正样本会跟训练集中的类似。</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="17co" id="选择使用什么特征">选择使用什么特征</h3><p data-anchor-id="2gml">通过画出数据的柱状图、检查钟形曲线来检查特征是否成高斯分布</p><p data-anchor-id="hlg1">一些有用的变换：取对数、开方等</p><p data-anchor-id="ju91">选择出现在异常中的过大或者过小的特征</p><div class="md-section-divider"></div><h3 data-anchor-id="4aa3" id="多元高斯分布">多元高斯分布</h3><p data-anchor-id="omfw">一次性为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-210-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -771.0516853480245 1893.5 1042.103370696049" style="width: 4.402ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><use xlink:href="#MJMAIN-28" x="503" y="0"></use><use xlink:href="#MJMATHI-78" x="893" y="0"></use><use xlink:href="#MJMAIN-29" x="1465" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-210">p(x)</script>建模 <br>
参数是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-211-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 8094.61327323907 1042.103370696049" style="width: 18.764ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use><use xlink:href="#MJMAIN-2208" x="881" y="0"></use><g transform="translate(1826,0)"><use xlink:href="#MJMATHI-52"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="1074" y="513"></use></g><use xlink:href="#MJMAIN-2C" x="3110" y="0"></use><use xlink:href="#MJSZ1-2211" x="3555" y="0"></use><use xlink:href="#MJMAIN-2208" x="4890" y="0"></use><g transform="translate(5835,0)"><use xlink:href="#MJMATHI-52"></use><g transform="translate(759,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-D7" x="600" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="1379" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-211">\mu \in R^n, \sum \in R^{n\times n}</script> <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-212-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -1363.5596853480245 24938.324078261296 2741.554629570959" style="width: 57.915ex; height: 6.371ex; vertical-align: -3.243ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70"></use><use xlink:href="#MJMAIN-28" x="503" y="0"></use><use xlink:href="#MJMATHI-78" x="893" y="0"></use><use xlink:href="#MJMAIN-3B" x="1465" y="0"></use><use xlink:href="#MJMATHI-3BC" x="1910" y="0"></use><use xlink:href="#MJMAIN-2C" x="2514" y="0"></use><use xlink:href="#MJSZ2-2211" x="2959" y="0"></use><use xlink:href="#MJMAIN-29" x="4403" y="0"></use><use xlink:href="#MJMAIN-3D" x="5071" y="0"></use><g transform="translate(6127,0)"><g transform="translate(120,0)"><rect stroke="none" width="5390" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="2444" y="676"></use><g transform="translate(60,-1107)"><use xlink:href="#MJMAIN-28"></use><use xlink:href="#MJMAIN-32" x="389" y="0"></use><use xlink:href="#MJMATHI-3C0" x="890" y="0"></use><g transform="translate(1463,0)"><use xlink:href="#MJMAIN-29"></use><g transform="translate(389,418)"><g transform="translate(120,0)"><rect stroke="none" width="420" height="60" x="0" y="146"></rect><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6E" x="119" y="672"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-32" x="169" y="-621"></use></g></g></g><use xlink:href="#MJMAIN-7C" x="2613" y="0"></use><use xlink:href="#MJSZ1-2211" x="3058" y="0"></use><g transform="translate(4281,0)"><use xlink:href="#MJMAIN-7C"></use><g transform="translate(278,477)"><g transform="translate(120,0)"><rect stroke="none" width="370" height="60" x="0" y="146"></rect><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-31" x="119" y="661"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-32" x="119" y="-621"></use></g></g></g></g></g></g><use xlink:href="#MJMATHI-65" x="11757" y="0"></use><use xlink:href="#MJMATHI-78" x="12224" y="0"></use><use xlink:href="#MJMATHI-70" x="12796" y="0"></use><use xlink:href="#MJMAIN-28" x="13300" y="0"></use><use xlink:href="#MJMAIN-2212" x="13689" y="0"></use><g transform="translate(14468,0)"><g transform="translate(120,0)"><rect stroke="none" width="9802" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="4650" y="676"></use><g transform="translate(60,-915)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMAIN-28" x="500" y="0"></use><use xlink:href="#MJMATHI-78" x="890" y="0"></use><use xlink:href="#MJMAIN-2212" x="1684" y="0"></use><use xlink:href="#MJMATHI-3BC" x="2685" y="0"></use><g transform="translate(3288,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="408"></use></g><g transform="translate(4443,0)"><use xlink:href="#MJSZ1-2211"></use><g transform="translate(1056,477)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2212"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="778" y="0"></use></g></g><use xlink:href="#MJMAIN-28" x="6504" y="0"></use><use xlink:href="#MJMATHI-78" x="6893" y="0"></use><use xlink:href="#MJMAIN-2212" x="7688" y="0"></use><use xlink:href="#MJMATHI-3BC" x="8689" y="0"></use><use xlink:href="#MJMAIN-29" x="9292" y="0"></use></g></g></g><use xlink:href="#MJMAIN-29" x="24510" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-212">p(x;\mu,\sum) = {1\over (2\pi)^{\frac n 2} |\sum|^{\frac 1 2}} exp(-{1\over 2(x-\mu)^T\sum^{-1}(x-\mu)})</script> <br>
这样就可以构建一个椭圆高斯轮廓，可以更好比圆形轮廓更好地拟合数据 <br>
改变<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-213-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 1056.5 1042.103370696049" style="width: 2.432ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJSZ1-2211"></use></g></svg></span><script type="math/tex" id="MathJax-Element-213">\sum</script>会改变轮廓的形状、宽度和方向 <br>
改变<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-214-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 603.5 700.103370696049" style="width: 1.39ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use></g></svg></span><script type="math/tex" id="MathJax-Element-214">\mu</script>会改变分布的中心</p><div class="md-section-divider"></div><h3 data-anchor-id="17dz" id="使用多元高斯分布检测异常">使用多元高斯分布检测异常</h3><p data-anchor-id="39n8">正常计算<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-215-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 603.5 700.103370696049" style="width: 1.39ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use></g></svg></span><script type="math/tex" id="MathJax-Element-215">\mu</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-216-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 1056.5 1042.103370696049" style="width: 2.432ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJSZ1-2211"></use></g></svg></span><script type="math/tex" id="MathJax-Element-216">\sum</script>，然后利用上述公式 <br>
多元高斯模型能够自动检测不同特征之间的相关性 <br>
但缺点是需要更多数据、计算成本高</p><div class="md-section-divider"></div><h3 data-anchor-id="o4ok" id="推荐系统">推荐系统</h3><div class="md-section-divider"></div><h4 data-anchor-id="7sno" id="问题提出">问题提出</h4><p data-anchor-id="rim9">假设要给用户推荐电影</p><ul data-anchor-id="smpj">
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-217-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.0516853480245 1105.3186322292986 642.5886520702876" style="width: 2.548ex; height: 1.506ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-75" x="849" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-217">n_u</script> = 用户数目</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-218-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.0516853480245 1321.693307272382 642.5886520702876" style="width: 3.127ex; height: 1.506ex; vertical-align: -0.463ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="849" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-218">n_m</script> = 电影数目</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-219-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 4268.222222222223 1042.103370696049" style="width: 9.961ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-72"></use><use xlink:href="#MJMAIN-28" x="451" y="0"></use><use xlink:href="#MJMATHI-69" x="841" y="0"></use><use xlink:href="#MJMAIN-2C" x="1186" y="0"></use><use xlink:href="#MJMATHI-6A" x="1631" y="0"></use><use xlink:href="#MJMAIN-29" x="2044" y="0"></use><use xlink:href="#MJMAIN-3D" x="2711" y="0"></use><use xlink:href="#MJMAIN-31" x="3767" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-219">r(i,j) = 1</script> 如果用户j评价过电影i</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-220-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 6582.722222222223 1042.103370696049" style="width: 15.29ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-79"></use><use xlink:href="#MJMAIN-28" x="497" y="0"></use><use xlink:href="#MJMATHI-69" x="887" y="0"></use><use xlink:href="#MJMAIN-2C" x="1232" y="0"></use><use xlink:href="#MJMATHI-6A" x="1677" y="0"></use><use xlink:href="#MJMAIN-29" x="2090" y="0"></use><use xlink:href="#MJMAIN-3D" x="2757" y="0"></use><use xlink:href="#MJMATHI-72" x="3813" y="0"></use><use xlink:href="#MJMATHI-61" x="4265" y="0"></use><use xlink:href="#MJMATHI-74" x="4794" y="0"></use><use xlink:href="#MJMATHI-69" x="5156" y="0"></use><use xlink:href="#MJMATHI-6E" x="5501" y="0"></use><use xlink:href="#MJMATHI-67" x="6102" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-220">y(i,j) = rating</script> 用户j对电影i的评价</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="zfnv" id="基于内容的推荐">基于内容的推荐</h3><p data-anchor-id="lud3">对每个用户评价过的电影使用线性回归</p><ul data-anchor-id="lha0">
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-221-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1412.0177297837713 945.0325633671463" style="width: 3.243ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-221">\theta^{(j)}</script> = 用户j的参数向量</li>
<li><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-222-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 1467.6415754442728 946.0325633671463" style="width: 3.359ex; height: 2.201ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-222">x^{(i)}</script> = 电影i的特征向量 <br>
对于用户j和电影i，预测评价是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-223-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 5035.816032573966 1185.0325633671464" style="width: 11.699ex; height: 2.78ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28"></use><g transform="translate(389,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g></g><g transform="translate(1801,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="513"></use></g><use xlink:href="#MJMAIN-28" x="2789" y="0"></use><g transform="translate(3178,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="4646" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-223">(\theta^{(j)})^T(x^{(i)})</script> <br>
优化目标是 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-224-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1608.1841133728337 29554.523724941377 3054.4227934697788" style="width: 68.687ex; height: 7.066ex; vertical-align: -3.475ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6D"></use><use xlink:href="#MJMATHI-69" x="878" y="0"></use><g transform="translate(1224,0)"><use xlink:href="#MJMATHI-6E"></use><g transform="translate(600,-338)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8"></use><g transform="translate(331,306)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2026" x="1474" y="0"></use><g transform="translate(1871,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8"></use><g transform="translate(331,306)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-28"></use><g transform="translate(194,0)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-75" x="600" y="-150"></use></g><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-29" x="1662" y="0"></use></g></g></g></g><use xlink:href="#MJMAIN-3D" x="5502" y="0"></use><g transform="translate(6558,0)"><g transform="translate(120,0)"><rect stroke="none" width="620" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="60" y="-686"></use></g></g><g transform="translate(7585,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><g transform="translate(331,1174)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-75" x="849" y="-213"></use></g></g><g transform="translate(9197,0)"><use xlink:href="#MJSZ2-2211" x="752" y="0"></use><g transform="translate(0,-1149)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3A" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72" x="624" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="1075" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="1465" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="1810" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="2089" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="2501" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="2891" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="3669" y="0"></use></g></g><use xlink:href="#MJMAIN-28" x="12145" y="0"></use><use xlink:href="#MJMAIN-28" x="12535" y="0"></use><g transform="translate(12924,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g></g><g transform="translate(14336,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="583"></use></g><use xlink:href="#MJMAIN-28" x="15324" y="0"></use><g transform="translate(15713,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="17181" y="0"></use><use xlink:href="#MJMAIN-2212" x="17793" y="0"></use><g transform="translate(18794,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="734" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="1013" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1426" y="0"></use></g></g><g transform="translate(20677,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="#MJMAIN-2B" x="21743" y="0"></use><g transform="translate(22743,0)"><g transform="translate(120,0)"><rect stroke="none" width="703" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3BB" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="101" y="-686"></use></g></g><g transform="translate(23853,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><g transform="translate(331,1174)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-75" x="849" y="-213"></use></g></g><g transform="translate(25465,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(85,-1110)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1300" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="26909" y="0"></use><g transform="translate(27299,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="663" y="-463"></use></g><g transform="translate(28711,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-224">min_{\theta^{(1)}\dots \theta^{(n_u)}} = {1\over 2} \sum_{j=1}^{n_u} \sum_{i:r(i,j)=1} ((\theta^{(j)})^T(x^{(i)}) - y^{(i,j)})^2 + {\lambda \over 2}\sum_{j=1}^{n_u} \sum_{k=1}^{n} (\theta_k^{(j)})^2</script></li>
</ul><p data-anchor-id="a7sl">除了消除了常数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-225-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -895.9073646014878 981.1933072723821 1269.2853313237508" style="width: 2.317ex; height: 2.896ex; vertical-align: -0.927ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="741" height="60" x="0" y="220"></rect><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="273" y="571"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="84" y="-488"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-225">\frac1 m</script>之外跟线性回归没有什么不同</p><div class="md-section-divider"></div><h3 data-anchor-id="5qsx" id="协同过滤">协同过滤</h3><p data-anchor-id="e81t">让用户告诉我们他们喜欢哪些种类的电影，通过提供他们的参数向量 <br>
从用户的参数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-226-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-226">\theta</script>推断电影参数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-227-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 572.5 495.10337069604896" style="width: 1.274ex; height: 1.158ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use></g></svg></span><script type="math/tex" id="MathJax-Element-227">x</script>，需要以下的平方误差函数 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-228-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1608.1841133728337 29956.187721865805 3054.4227934697788" style="width: 69.614ex; height: 7.066ex; vertical-align: -3.475ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6D"></use><use xlink:href="#MJMATHI-69" x="878" y="0"></use><g transform="translate(1224,0)"><use xlink:href="#MJMATHI-6E"></use><g transform="translate(600,-236)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-78"></use><g transform="translate(404,204)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2026" x="1577" y="0"></use><g transform="translate(1944,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-78"></use><g transform="translate(404,204)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-28"></use><g transform="translate(194,0)"><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6D" x="600" y="-150"></use></g><use transform="scale(0.5000000000000001)" xlink:href="#MJMAIN-29" x="1968" y="0"></use></g></g></g></g><use xlink:href="#MJMAIN-3D" x="5801" y="0"></use><g transform="translate(6857,0)"><g transform="translate(120,0)"><rect stroke="none" width="620" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="60" y="-686"></use></g></g><g transform="translate(7884,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><g transform="translate(254,1174)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6D" x="849" y="-213"></use></g></g><g transform="translate(9495,0)"><use xlink:href="#MJSZ2-2211" x="752" y="0"></use><g transform="translate(0,-1149)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3A" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72" x="624" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="1075" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="1465" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="1810" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="2089" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="2501" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="2891" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="3669" y="0"></use></g></g><use xlink:href="#MJMAIN-28" x="12444" y="0"></use><use xlink:href="#MJMAIN-28" x="12833" y="0"></use><g transform="translate(13223,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g></g><g transform="translate(14635,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="583"></use></g><use xlink:href="#MJMAIN-28" x="15623" y="0"></use><g transform="translate(16012,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="17480" y="0"></use><use xlink:href="#MJMAIN-2212" x="18091" y="0"></use><g transform="translate(19092,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="734" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="1013" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1426" y="0"></use></g></g><g transform="translate(20976,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="#MJMAIN-2B" x="22041" y="0"></use><g transform="translate(23042,0)"><g transform="translate(120,0)"><rect stroke="none" width="703" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3BB" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="101" y="-686"></use></g></g><g transform="translate(24152,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><g transform="translate(254,1174)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6D" x="849" y="-213"></use></g></g><g transform="translate(25763,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(85,-1110)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1300" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="27208" y="0"></use><g transform="translate(27597,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="809" y="-463"></use></g><g transform="translate(29112,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-228">min_{x^{(1)}\dots x^{(n_m)}} = {1\over 2} \sum_{j=1}^{n_m} \sum_{i:r(i,j)=1} ((\theta^{(j)})^T(x^{(i)}) - y^{(i,j)})^2 + {\lambda \over 2}\sum_{j=1}^{n_m} \sum_{k=1}^{n} (x_k^{(j)})^2</script> <br>
可以随机猜测<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-229-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-229">\theta</script>的值，最终都会收敛到一个好的特征集</p><div class="md-section-divider"></div><h3 data-anchor-id="x8w3" id="协同过滤算法">协同过滤算法</h3><p data-anchor-id="0gaw">为了加速，我们可以同步最小化特征和参数 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-230-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1608.1841133728337 33968.069665778814 3054.4227934697788" style="width: 78.88ex; height: 7.066ex; vertical-align: -3.475ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-78" x="1023" y="0"></use><use xlink:href="#MJMAIN-2C" x="1595" y="0"></use><use xlink:href="#MJMATHI-3B8" x="2040" y="0"></use><use xlink:href="#MJMAIN-29" x="2510" y="0"></use><use xlink:href="#MJMAIN-3D" x="3177" y="0"></use><g transform="translate(4233,0)"><g transform="translate(120,0)"><rect stroke="none" width="620" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="60" y="-686"></use></g></g><g transform="translate(5260,0)"><use xlink:href="#MJSZ2-2211" x="1271" y="0"></use><g transform="translate(0,-1149)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="734" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="1013" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1426" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3A" x="1815" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72" x="2094" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="2545" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="2935" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="3280" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="3559" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="3971" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="4361" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="5139" y="0"></use></g></g><use xlink:href="#MJMAIN-28" x="9248" y="0"></use><use xlink:href="#MJMAIN-28" x="9638" y="0"></use><g transform="translate(10027,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g></g><g transform="translate(11439,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="550" y="583"></use></g><g transform="translate(12427,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2212" x="14117" y="0"></use><g transform="translate(15118,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="734" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="1013" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1426" y="0"></use></g></g><g transform="translate(17001,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="#MJMAIN-2B" x="18067" y="0"></use><g transform="translate(19067,0)"><g transform="translate(120,0)"><rect stroke="none" width="703" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3BB" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="101" y="-686"></use></g></g><g transform="translate(20178,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><g transform="translate(254,1174)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6D" x="849" y="-213"></use></g></g><g transform="translate(21789,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(85,-1110)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1300" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="23233" y="0"></use><g transform="translate(23623,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="809" y="-463"></use></g><g transform="translate(25090,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="#MJMAIN-2B" x="26156" y="0"></use><g transform="translate(27157,0)"><g transform="translate(120,0)"><rect stroke="none" width="703" height="60" x="0" y="220"></rect><use xlink:href="#MJMATHI-3BB" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="101" y="-686"></use></g></g><g transform="translate(28267,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(124,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g><g transform="translate(254,1174)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6D" x="849" y="-213"></use></g></g><g transform="translate(29878,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(85,-1110)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1300" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use></g><use xlink:href="#MJMAIN-28" x="31323" y="0"></use><g transform="translate(31712,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="802" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B" x="663" y="-463"></use></g><g transform="translate(33124,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-230">J(x,\theta) = {1\over 2}\sum_{(i,j):r(i,j)=1} ((\theta^{(j)})^T x^{(i)} - y^{(i,j)})^2 + {\lambda \over 2}\sum_{i=1}^{n_m}\sum_{k=1}^n (x_k^{(i)})^2 + {\lambda\over 2}\sum_{j=1}^{n_m}\sum_{k=1}^n (\theta_k^{(j)})^2</script></p><ol data-anchor-id="bm9i">
<li>用一些随机小值初始化<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-231-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.9808780191219 10568.148551920705 1130.0325633671464" style="width: 24.556ex; height: 2.664ex; vertical-align: -0.579ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use xlink:href="#MJMAIN-2026" x="1743" y="0"></use><g transform="translate(3083,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><g transform="translate(275,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6D" x="849" y="-213"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1711" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="5240" y="0"></use><g transform="translate(5686,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><use xlink:href="#MJMAIN-2026" x="7327" y="0"></use><g transform="translate(8666,0)"><use xlink:href="#MJMATHI-3B8"></use><g transform="translate(469,362)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><g transform="translate(275,0)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-75" x="849" y="-213"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="1494" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-231">x^{(1)} \dots x^{(n_m)},\theta^{(1)} \dots \theta^{(n_u)}</script>，用来打破对称性并保证算法学习到的特征x是彼此不同的</li>
<li>使用梯度下降或者其他优化算法最小化<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-232-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 2899.666666666667 1042.103370696049" style="width: 6.718ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use xlink:href="#MJMAIN-28" x="633" y="0"></use><use xlink:href="#MJMATHI-78" x="1023" y="0"></use><use xlink:href="#MJMAIN-2C" x="1595" y="0"></use><use xlink:href="#MJMATHI-3B8" x="2040" y="0"></use><use xlink:href="#MJMAIN-29" x="2510" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-232">J(x,\theta)</script></li>
<li>根据用户参数和电影特征，预测评价<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-233-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -862.3620829925038 1640.1567273459227 894.4137683405282" style="width: 3.822ex; height: 2.085ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="513"></use><use xlink:href="#MJMATHI-78" x="1067" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-233">\theta^Tx</script></li>
</ol><div class="md-section-divider"></div><h3 data-anchor-id="mi5x" id="向量化低阶矩阵分解">向量化：低阶矩阵分解</h3><p data-anchor-id="8yxx">给定矩阵X（每行包含一部电影的特征）和矩阵<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-234-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-234">\theta</script>（每行包含对于一个特定用户来说那些特征的权重），那么所有用户评价所有电影的预测就是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-235-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -862.3620829925038 4017.7122829014784 893.4137683405282" style="width: 9.382ex; height: 2.085ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-59"></use><use xlink:href="#MJMAIN-3D" x="1041" y="0"></use><use xlink:href="#MJMATHI-58" x="2097" y="0"></use><g transform="translate(2950,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-54" x="663" y="513"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-235">Y = X\theta^T</script></p><p data-anchor-id="5u2b">预测两部电影如何类似可以用它们向量之间的距离（各种距离）</p><div class="md-section-divider"></div><h3 data-anchor-id="bpz7" id="实现细节均值归一化">实现细节：均值归一化</h3><p data-anchor-id="uea1">新用户没有看过电影，会把所有电影评估为0，不合理 <br>
解决这个问题要把数据归一化到平均值 <br>
首先用一个矩阵Y储存从以前的评价中得到的数据，每行对应电影，每列对应用户 <br>
然后计算一个新的向量 <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-236-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.0516853480245 6974.374133093932 1053.1693878740311" style="width: 16.216ex; height: 2.432ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use><use xlink:href="#MJMAIN-3D" x="881" y="0"></use><use xlink:href="#MJMAIN-5B" x="1937" y="0"></use><g transform="translate(2216,0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="853" y="-213"></use></g><use xlink:href="#MJMAIN-2C" x="3273" y="0"></use><use xlink:href="#MJMAIN-2026" x="3718" y="0"></use><g transform="translate(5057,0)"><use xlink:href="#MJMATHI-3BC"></use><g transform="translate(603,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.5000000000000001)" xlink:href="#MJMATHI-6D" x="849" y="-213"></use></g></g><use xlink:href="#MJMAIN-5D" x="6695" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-236">\mu = [\mu_1, \dots \mu_{n_m}]</script> <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-237-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1699.5686257129744 8375.455225709433 2866.6103394913675" style="width: 19.459ex; height: 6.602ex; vertical-align: -2.78ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="853" y="-213"></use><use xlink:href="#MJMAIN-3D" x="1225" y="0"></use><g transform="translate(2281,0)"><g transform="translate(120,0)"><rect stroke="none" width="5853" height="60" x="0" y="220"></rect><g transform="translate(60,928)"><use xlink:href="#MJSZ1-2211"></use><g transform="translate(1056,-287)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3A" x="412" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-72" x="691" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28" x="1142" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="1532" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="1877" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="2156" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="2568" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="2958" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="3736" y="0"></use></g><g transform="translate(4319,0)"><use xlink:href="#MJMATHI-59"></use><g transform="translate(581,-150)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g></g><g transform="translate(568,-716)"><use xlink:href="#MJSZ1-2211"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="1494" y="-405"></use><use xlink:href="#MJMAIN-3A" x="1725" y="0"></use><use xlink:href="#MJMATHI-72" x="2282" y="0"></use><use xlink:href="#MJMAIN-28" x="2733" y="0"></use><use xlink:href="#MJMATHI-69" x="3123" y="0"></use><use xlink:href="#MJMAIN-2C" x="3468" y="0"></use><use xlink:href="#MJMATHI-6A" x="3913" y="0"></use><use xlink:href="#MJMAIN-29" x="4326" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-237">\mu_i = {\sum_{j:r(i,j)=1} Y_{i,j} \over \sum_j:r(i,j)}</script> <br>
计算第i部电影的评分均值（只有看过电影的用户的评分才计算入内） <br>
现在可以通过把Y矩阵的每列减去<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-238-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 603.5 700.103370696049" style="width: 1.39ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use></g></svg></span><script type="math/tex" id="MathJax-Element-238">\mu</script>来归一 <br>
最后只需要在线性回归项中加上这个<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-239-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.0516853480245 947.8053928999522 700.103370696049" style="width: 2.201ex; height: 1.622ex; vertical-align: -0.695ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3BC"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="853" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-239">\mu_i</script> <br>
因此对于新用户来说，最初的预测值将会是</p><div class="md-section-divider"></div><h2 data-anchor-id="uene" id="第十周">第十周</h2><div class="md-section-divider"></div><h3 data-anchor-id="dtg2" id="大数据集机器学习">大数据集机器学习</h3><p data-anchor-id="fojk">大数据集通常有m=100,000,000 <br>
传统的梯度下降（也叫批量梯度下降batch gradient descent）每次要对很大的m求和，我们想办法避免这一点</p><div class="md-section-divider"></div><h3 data-anchor-id="6745" id="随机梯度下降stochastic-gradient-descent">随机梯度下降(stochastic gradient descent)</h3><p data-anchor-id="rf0q">是梯度下降的变种，对大数据集更加灵活 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-240-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1363.5596853480245 16830.59321286138 2070.562370696049" style="width: 39.035ex; height: 4.865ex; vertical-align: -1.737ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-63"></use><use xlink:href="#MJMATHI-6F" x="433" y="0"></use><use xlink:href="#MJMATHI-73" x="919" y="0"></use><use xlink:href="#MJMATHI-74" x="1388" y="0"></use><use xlink:href="#MJMAIN-28" x="1750" y="0"></use><use xlink:href="#MJMATHI-3B8" x="2139" y="0"></use><use xlink:href="#MJMAIN-2C" x="2609" y="0"></use><use xlink:href="#MJMAIN-28" x="3054" y="0"></use><g transform="translate(3443,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="4911" y="0"></use><g transform="translate(5356,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="6751" y="0"></use><use xlink:href="#MJMAIN-29" x="7140" y="0"></use><use xlink:href="#MJMAIN-3D" x="7808" y="0"></use><g transform="translate(8864,0)"><g transform="translate(120,0)"><rect stroke="none" width="620" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="60" y="676"></use><use xlink:href="#MJMAIN-32" x="60" y="-686"></use></g></g><use xlink:href="#MJMAIN-28" x="9724" y="0"></use><g transform="translate(10114,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="11122" y="0"></use><g transform="translate(11512,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="12979" y="0"></use><use xlink:href="#MJMAIN-2212" x="13591" y="0"></use><g transform="translate(14592,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><g transform="translate(15987,0)"><use xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-240">cost(\theta,(x^{(i)},y^{(i)})) = {1\over 2}(h_{\theta}(x^{(i)}) - y^{(i)})^2</script> <br>
损失函数消除了常数m <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-241-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1585.0070961948516 15967.274474509704 2802.850285968542" style="width: 37.066ex; height: 6.486ex; vertical-align: -2.896ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4A"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-74" x="785" y="-213"></use><use xlink:href="#MJMATHI-72" x="911" y="0"></use><use xlink:href="#MJMATHI-61" x="1362" y="0"></use><use xlink:href="#MJMATHI-69" x="1892" y="0"></use><use xlink:href="#MJMATHI-6E" x="2237" y="0"></use><use xlink:href="#MJMAIN-28" x="2838" y="0"></use><use xlink:href="#MJMATHI-3B8" x="3227" y="0"></use><use xlink:href="#MJMAIN-29" x="3697" y="0"></use><use xlink:href="#MJMAIN-3D" x="4364" y="0"></use><g transform="translate(5420,0)"><g transform="translate(120,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="249" y="676"></use><use xlink:href="#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(6825,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(147,-1090)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6D" x="582" y="1627"></use></g><use xlink:href="#MJMATHI-63" x="8437" y="0"></use><use xlink:href="#MJMATHI-6F" x="8870" y="0"></use><use xlink:href="#MJMATHI-73" x="9356" y="0"></use><use xlink:href="#MJMATHI-74" x="9825" y="0"></use><use xlink:href="#MJMAIN-28" x="10187" y="0"></use><use xlink:href="#MJMATHI-3B8" x="10576" y="0"></use><use xlink:href="#MJMAIN-2C" x="11046" y="0"></use><use xlink:href="#MJMAIN-28" x="11491" y="0"></use><g transform="translate(11880,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="13348" y="0"></use><g transform="translate(13793,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="15188" y="0"></use><use xlink:href="#MJMAIN-29" x="15577" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-241">J_train(\theta) = {1\over m}\sum_{i=1}^m cost(\theta,(x^{(i)},y^{(i)})) </script> <br>
现在J就是所有训练样本的平均损失</p><p data-anchor-id="muzs">算法如下： <br>
1. 随机捣乱数据集 <br>
2. 对于i从1到m：<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-242-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1073.0158800969452 13317.86889902325 1541.6859447337067" style="width: 30.927ex; height: 3.591ex; vertical-align: -1.158ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use><g transform="translate(1138,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(2473,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="3557" y="0"></use><use xlink:href="#MJMATHI-3B1" x="4557" y="0"></use><use xlink:href="#MJMAIN-28" x="5198" y="0"></use><g transform="translate(5587,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="6596" y="0"></use><g transform="translate(6985,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="8453" y="0"></use><use xlink:href="#MJMAIN-2212" x="9065" y="0"></use><g transform="translate(10065,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="11460" y="0"></use><g transform="translate(11850,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="809" y="-430"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-242">\theta_j := \theta_j - \alpha(h_{\theta}(x^{(i)}) - y^{(i)})x_j^{(i)}</script></p><p data-anchor-id="s3k5">算法每次只拟合一个训练样本。这样我们可以在无需扫描全部m个样本的前提下在梯度下降取得进步。 <br>
随机梯度下降不太可能会收敛到全局最小值，而是会在它旁边随机游荡，但通常会产生一个足够靠近的结果。 <br>
随机梯度下降通常会采取1-10次遍历数据集来接近全局最小值。</p><div class="md-section-divider"></div><h3 data-anchor-id="vhia" id="小批量梯度下降mini-batch-gradient-descent">小批量梯度下降(Mini-Batch Gradient Descent)</h3><p data-anchor-id="kl58">有时候比随机梯度下降更快 <br>
每次使用一定数量b的样本 <br>
b的取值可以是2-100</p><p data-anchor-id="b6ql">对i从1,1+b,1+2b...m-b+1 <br>
<span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-243-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1762.490898272675 15789.535565689917 3000.1330779195887" style="width: 36.718ex; height: 6.95ex; vertical-align: -3.012ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use><g transform="translate(1138,0)"><use xlink:href="#MJMAIN-3A"></use><use xlink:href="#MJMAIN-3D" x="278" y="0"></use></g><g transform="translate(2473,0)"><use xlink:href="#MJMATHI-3B8"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2212" x="3557" y="0"></use><use xlink:href="#MJMATHI-3B1" x="4557" y="0"></use><g transform="translate(5198,0)"><g transform="translate(120,0)"><rect stroke="none" width="620" height="60" x="0" y="220"></rect><use xlink:href="#MJMAIN-31" x="60" y="676"></use><use xlink:href="#MJMATHI-62" x="95" y="-686"></use></g></g><g transform="translate(6225,0)"><use xlink:href="#MJSZ2-2211"></use><g transform="translate(140,-1110)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="1300" y="0"></use></g><g transform="translate(173,1151)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="345" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-62" x="1124" y="0"></use></g></g><use xlink:href="#MJMAIN-28" x="7670" y="0"></use><g transform="translate(8059,0)"><use xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-3B8" x="815" y="-219"></use></g><use xlink:href="#MJMAIN-28" x="9068" y="0"></use><g transform="translate(9457,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="10925" y="0"></use><use xlink:href="#MJMAIN-2212" x="11536" y="0"></use><g transform="translate(12537,0)"><use xlink:href="#MJMATHI-79"></use><g transform="translate(499,412)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="13932" y="0"></use><g transform="translate(14321,0)"><use xlink:href="#MJMATHI-78"></use><g transform="translate(572,521)"><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMATHI-6A" x="809" y="-430"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-243">\theta_j := \theta_j - \alpha{1\over b}\sum_{k=i}^{i+b}(h_{\theta}(x^{(i)}) - y^{(i)})x_j^{(i)}</script> <br>
每次对b个样本求和 <br>
可以向量化</p><div class="md-section-divider"></div><h3 data-anchor-id="xxbk" id="随机梯度下降收敛">随机梯度下降收敛</h3><p data-anchor-id="kx3i">怎样选择学习率？ <br>
怎样确保它尽量靠近全局 </p><p data-anchor-id="btuj">一种策略是画出每1000左右个样本的假设的平均损失，我们可以在迭代中保存这些值 <br>
一个较小的学习率可能会得到一个更好的结果，因为随机梯度下降会在全局最优附近震荡跳跃，小学习率会带来小步伐的随机跳跃</p><p data-anchor-id="sicb">如果增加画图的平均样本数，曲线变得平滑。 <br>
如果取平均的样本数太小，曲线会变得聒噪并很难找到趋势 <br>
一种真正收敛到全局最优的策略是慢慢降低学习率 <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-244-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1164.1083800669644 6624.308992912993 1828.216760133929" style="width: 15.405ex; height: 4.286ex; vertical-align: -1.622ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B1"></use><use xlink:href="#MJMAIN-3D" x="918" y="0"></use><g transform="translate(1974,0)"><g transform="translate(120,0)"><rect stroke="none" width="4409" height="60" x="0" y="220"></rect><g transform="translate(1463,544)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(35.264206918956695) matrix(1 0 0 -1 0 0)">常</text><g transform="translate(564,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(35.264206918956695) matrix(1 0 0 -1 0 0)">数</text></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-31" x="1595" y="0"></use></g><g transform="translate(60,-503)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(35.264206918956695) matrix(1 0 0 -1 0 0)">迭</text><g transform="translate(564,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(35.264206918956695) matrix(1 0 0 -1 0 0)">代</text></g><g transform="translate(1128,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(35.264206918956695) matrix(1 0 0 -1 0 0)">次</text></g><g transform="translate(1692,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(35.264206918956695) matrix(1 0 0 -1 0 0)">数</text></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-2B" x="3191" y="0"></use><g transform="translate(2807,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(35.264206918956695) matrix(1 0 0 -1 0 0)">常</text></g><g transform="translate(3371,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(35.264206918956695) matrix(1 0 0 -1 0 0)">数</text></g><use transform="scale(0.7071067811865476)" xlink:href="#MJMAIN-32" x="5566" y="0"></use></g></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-244">\alpha = {常数1 \over 迭代次数 + 常数2}</script></p><p data-anchor-id="8omy">但这很少做到，因为人们不想瞎搞那么多参数了</p><div class="md-section-divider"></div><h3 data-anchor-id="1gsh" id="在线学习online-learning">在线学习(online learning)</h3><p data-anchor-id="f74u">伴随着连续的网站用户流，我们可以运行一个永不停止的循环来收集用户行为作为特征X来预测一些行为y <br>
你可以收集到的数据对每个用户修改参数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-245-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.0516853480245 469.5 757.103370696049" style="width: 1.042ex; height: 1.737ex; vertical-align: -0.116ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-245">\theta</script>，这样就可以适应新的用户群，因为你在不停地修改参数</p><div class="md-section-divider"></div><h3 data-anchor-id="24fn" id="map-reduce-和数据并行">Map Reduce 和数据并行</h3><p data-anchor-id="3qom">把批量梯度下降分开，把对一个数据子集的损失函数分配到不同的机器中，于是就可以并行训练算法了 <br>
不同机器求不同部分的和 <br>
Map Reduce会负责这些调度(map)工作并通过计算减少(reduce)它们</p><p data-anchor-id="mpyk">你的算法是可以用Map Reduce的(MapReduceable)，如果它能被表示成训练集函数的求和。 <br>
线性回归和逻辑斯特回归很容易并行处理。</p><p data-anchor-id="k7ig">对于神经网络，你可以在数据的子集上用不同机器计算forward propagation和back propagation，然后把导数回报给主机。</p></div>
</body>
</html>